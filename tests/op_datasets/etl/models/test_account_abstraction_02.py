import datetime

from op_analytics.coreutils.testutils.inputdata import InputTestData
from op_analytics.datapipeline.models.compute.testutils import ModelTestBase


class TestAccountAbstraction0002(ModelTestBase):
    model = "account_abstraction"
    inputdata = InputTestData.at(__file__)
    chains = ["base"]
    target_range = 21770458
    block_filters = [
        "{block_number} IN (21770458) OR block_number % 100 < 10",
    ]

    _enable_fetching = True

    def test_overall_totals(self):
        assert self._duckdb_context is not None

        num_logs = (
            self._duckdb_context.client.sql(
                "SELECT COUNT(*) as num_logs FROM useroperationevent_logs_v2"
            )
            .pl()
            .to_dicts()[0]["num_logs"]
        )

        num_traces = (
            self._duckdb_context.client.sql(
                "SELECT COUNT(*) as num_traces FROM enriched_entrypoint_traces_v2"
            )
            .pl()
            .to_dicts()[0]["num_traces"]
        )

        assert num_logs == 152
        assert num_traces == 994

    def test_model_schema_logs(self):
        assert self._duckdb_context is not None

        schema = (
            self._duckdb_context.client.sql("DESCRIBE useroperationevent_logs_v2")
            .pl()
            .select("column_name", "column_type")
            .to_dicts()
        )
        actual_schema = {row["column_name"]: row["column_type"] for row in schema}

        assert actual_schema == {
            "dt": "DATE",
            "chain": "VARCHAR",
            "chain_id": "INTEGER",
            "network": "VARCHAR",
            "block_timestamp": "UINTEGER",
            "block_number": "BIGINT",
            "block_hash": "VARCHAR",
            "transaction_hash": "VARCHAR",
            "transaction_index": "BIGINT",
            "log_index": "BIGINT",
            "contract_address": "VARCHAR",
            "userophash": "VARCHAR",
            "sender": "VARCHAR",
            "paymaster": "VARCHAR",
            "nonce": "VARCHAR",
            "success": "BOOLEAN",
            "actualGasCost": "VARCHAR",
            "actualGasUsed": "VARCHAR",
        }

    def test_model_schema_traces(self):
        assert self._duckdb_context is not None

        schema = (
            self._duckdb_context.client.sql("DESCRIBE enriched_entrypoint_traces_v2")
            .pl()
            .select("column_name", "column_type")
            .to_dicts()
        )
        actual_schema = {row["column_name"]: row["column_type"] for row in schema}

        assert actual_schema == {
            "dt": "DATE",
            "chain": "VARCHAR",
            "chain_id": "INTEGER",
            "network": "VARCHAR",
            "block_timestamp": "UINTEGER",
            "block_number": "BIGINT",
            "block_hash": "VARCHAR",
            "transaction_hash": "VARCHAR",
            "transaction_index": "BIGINT",
            "from_address": "VARCHAR",
            "to_address": "VARCHAR",
            "value": "VARCHAR",
            "input": "VARCHAR",
            "output": "VARCHAR",
            "trace_type": "VARCHAR",
            "call_type": "VARCHAR",
            "reward_type": "VARCHAR",
            "gas": "BIGINT",
            "gas_used": "BIGINT",
            "subtraces": "BIGINT",
            "trace_address": "VARCHAR",
            "error": "VARCHAR",
            "status": "BIGINT",
            "trace_root": "INTEGER",
            "method_id": "VARCHAR",
            "tx_from_address": "VARCHAR",
            "bundler_address": "VARCHAR",
            "entrypoint_contract_address": "VARCHAR",
            "entrypoint_contract_version": "VARCHAR",
            "is_innerhandleop": "BOOLEAN",
            "is_from_sender": "BOOLEAN",
            "userop_sender": "VARCHAR",
            "userop_paymaster": "VARCHAR",
            "userop_hash": "VARCHAR",
            "userop_calldata": "VARCHAR",
            "innerhandleop_decodeerror": "VARCHAR",
            "innerhandleop_opinfo": "VARCHAR",
            "innerhandleop_context": "VARCHAR",
            "innerhandleop_trace_address": "VARCHAR",
            "useropevent_nonce": "VARCHAR",
            "useropevent_success": "BOOLEAN",
            "useropevent_actualgascost": "VARCHAR",
            "useropevent_actualgasused": "VARCHAR",
            "userop_idx": "BIGINT",
            "useropevent_actualgascost_eth": "DOUBLE",
        }

    def test_single_log(self):
        assert self._duckdb_context is not None

        output = (
            self._duckdb_context.client.sql("""
        SELECT * FROM useroperationevent_logs_v2
        WHERE transaction_hash = '0x90d69e803dcef7e4bcdde5b19fe4f22cd10c097ec30208c1b01d0a7b43818388'
        """)
            .pl()
            .to_dicts()
        )

        assert output == [
            {
                "dt": datetime.date(2024, 10, 30),
                "chain": "base",
                "chain_id": 8453,
                "network": "mainnet",
                "block_timestamp": 1730330263,
                "block_number": 21770458,
                "block_hash": "0x56a1f34c843abfd0a99db7b9353975fc9ac7f219d4cf536bd30bcc7d2bef1a88",
                "transaction_hash": "0x90d69e803dcef7e4bcdde5b19fe4f22cd10c097ec30208c1b01d0a7b43818388",
                "transaction_index": 139,
                "log_index": 1434,
                "contract_address": "0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789",
                "userophash": "0x507bac8f0218d428311d3a9a5211232857a283099045e6457d25da617ac71671",
                "sender": "0xcf2ed5279d4f68d18ddd561772e67b700e10b063",
                "paymaster": "0xa270ef92c1e11f1c1f95753c2e56801e8125fa83",
                "nonce": "0",
                "success": True,
                "actualGasCost": "3286284749087",
                "actualGasUsed": "606973",
            },
            {
                "dt": datetime.date(2024, 10, 30),
                "chain": "base",
                "chain_id": 8453,
                "network": "mainnet",
                "block_timestamp": 1730330263,
                "block_number": 21770458,
                "block_hash": "0x56a1f34c843abfd0a99db7b9353975fc9ac7f219d4cf536bd30bcc7d2bef1a88",
                "transaction_hash": "0x90d69e803dcef7e4bcdde5b19fe4f22cd10c097ec30208c1b01d0a7b43818388",
                "transaction_index": 139,
                "log_index": 1440,
                "contract_address": "0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789",
                "userophash": "0x68cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a71341",
                "sender": "0xda88ba8c4e3259e9be2f05ec690052fc92962b37",
                "paymaster": "0x2faeb0760d4230ef2ac21496bb4f0b47d634fd4c",
                "nonce": "2546",
                "success": True,
                "actualGasCost": "2404335545082",
                "actualGasUsed": "444078",
            },
        ]

    def test_single_trace(self):
        assert self._duckdb_context is not None

        output = (
            self._duckdb_context.client.sql("""
        SELECT * FROM enriched_entrypoint_traces_v2 WHERE transaction_hash = '0x90d69e803dcef7e4bcdde5b19fe4f22cd10c097ec30208c1b01d0a7b43818388'
        AND trace_address LIKE '6%'
        ORDER BY trace_address
        """)
            .pl()
            .to_dicts()
        )

        assert output == [
            {
                "dt": datetime.date(2024, 10, 30),
                "chain": "base",
                "chain_id": 8453,
                "network": "mainnet",
                "block_timestamp": 1730330263,
                "block_number": 21770458,
                "block_hash": "0x56a1f34c843abfd0a99db7b9353975fc9ac7f219d4cf536bd30bcc7d2bef1a88",
                "transaction_hash": "0x90d69e803dcef7e4bcdde5b19fe4f22cd10c097ec30208c1b01d0a7b43818388",
                "transaction_index": 139,
                "from_address": "0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789",
                "to_address": "0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789",
                "value": "0",
                "input": "0x1d73275600000000000000000000000000000000000000000000000000000000000001c0000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b3700000000000000000000000000000000000000000000000000000000000009f20000000000000000000000000000000000000000000000000000000000022993000000000000000000000000000000000000000000000000000000000001687a0000000000000000000000000000000000000000000000000000000000038a450000000000000000000000002faeb0760d4230ef2ac21496bb4f0b47d634fd4c0000000000000000000000000000000000000000000000000000000000602d8400000000000000000000000000000000000000000000000000000000000f424068cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a71341000000000000000000000000000000000000000000000000000003babe13a6180000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000004662f00000000000000000000000000000000000000000000000000000000000003600000000000000000000000000000000000000000000000000000000000000164b61d27f600000000000000000000000080625310db240631a91f61659ccc550ea97617420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c429c911c9000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b37000000000000000000000000000000000000000000000000000000000001565e000000000000000000000000000000000000000000000000000000006722cc9a000000000000000000000000000000000000000000000000000000000000001b602a0f66f4c9e608e2172ac2023dadc8131a72bd44363d2c625c3a20e00b0eaf3e79d5fdff617c47558896859b377a175236cf00047513a83cbdfa273a6462c300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000160000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b3768cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a713410000000000000000000000000000000037233018550b44e3af73c8dc20a6213f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000697800000000000000000000000000000000000000000000000000000000000f42400000000000000000000000000000000000000000000000000000000000602d84000000000000000000000000b676f87a6e701f0de8de5ab91b56b66109766db100000000000000000000000095796e0d139d02eb0d89a79ca2938f79dd324a2e00000000000000000000000000000000000000000000012a7b51905bcd9ba000",
                "output": "0x0000000000000000000000000000000000000000000000000000022fcd90eafa",
                "trace_type": "call",
                "call_type": "call",
                "reward_type": "",
                "gas": 758293,
                "gas_used": 161503,
                "subtraces": 2,
                "trace_address": "6",
                "error": "",
                "status": 1,
                "trace_root": 6,
                "method_id": "0x1d732756",
                "tx_from_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "bundler_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "entrypoint_contract_address": "0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789",
                "entrypoint_contract_version": "v6",
                "innerhandleop_trace_address": "6",
                "is_innerhandleop": True,
                "is_from_sender": False,
                "userop_sender": "0xda88ba8c4e3259e9be2f05ec690052fc92962b37",
                "userop_paymaster": "0x2faeb0760d4230ef2ac21496bb4f0b47d634fd4c",
                "userop_hash": "0x68cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a71341",
                "userop_calldata": "0xb61d27f600000000000000000000000080625310db240631a91f61659ccc550ea97617420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c429c911c9000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b37000000000000000000000000000000000000000000000000000000000001565e000000000000000000000000000000000000000000000000000000006722cc9a000000000000000000000000000000000000000000000000000000000000001b602a0f66f4c9e608e2172ac2023dadc8131a72bd44363d2c625c3a20e00b0eaf3e79d5fdff617c47558896859b377a175236cf00047513a83cbdfa273a6462c300000000000000000000000000000000000000000000000000000000",
                "innerhandleop_decodeerror": None,
                "innerhandleop_opinfo": '{"mUserOp": {"nonce": "2546", "callGasLimit": "141715", "verificationGasLimit": "92282", "preVerificationGas": "232005", "maxFeePerGas": "6303108", "maxPriorityFeePerGas": "1000000"}, "prefund": "4100587759128", "contextOffset": "3136", "preOpGas": "288303"}',
                "innerhandleop_context": "0x000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b3768cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a713410000000000000000000000000000000037233018550b44e3af73c8dc20a6213f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000697800000000000000000000000000000000000000000000000000000000000f42400000000000000000000000000000000000000000000000000000000000602d84000000000000000000000000b676f87a6e701f0de8de5ab91b56b66109766db100000000000000000000000095796e0d139d02eb0d89a79ca2938f79dd324a2e00000000000000000000000000000000000000000000012a7b51905bcd9ba000",
                "useropevent_nonce": "2546",
                "useropevent_success": True,
                "useropevent_actualgascost": "2404335545082",
                "useropevent_actualgasused": "444078",
                "userop_idx": None,
                "useropevent_actualgascost_eth": 2.404335545082e-06,
            },
            {
                "dt": datetime.date(2024, 10, 30),
                "chain": "base",
                "chain_id": 8453,
                "network": "mainnet",
                "block_timestamp": 1730330263,
                "block_number": 21770458,
                "block_hash": "0x56a1f34c843abfd0a99db7b9353975fc9ac7f219d4cf536bd30bcc7d2bef1a88",
                "transaction_hash": "0x90d69e803dcef7e4bcdde5b19fe4f22cd10c097ec30208c1b01d0a7b43818388",
                "transaction_index": 139,
                "from_address": "0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789",
                "to_address": "0xda88ba8c4e3259e9be2f05ec690052fc92962b37",
                "value": "0",
                "input": "0xb61d27f600000000000000000000000080625310db240631a91f61659ccc550ea97617420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c429c911c9000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b37000000000000000000000000000000000000000000000000000000000001565e000000000000000000000000000000000000000000000000000000006722cc9a000000000000000000000000000000000000000000000000000000000000001b602a0f66f4c9e608e2172ac2023dadc8131a72bd44363d2c625c3a20e00b0eaf3e79d5fdff617c47558896859b377a175236cf00047513a83cbdfa273a6462c300000000000000000000000000000000000000000000000000000000",
                "output": "",
                "trace_type": "call",
                "call_type": "call",
                "reward_type": "",
                "gas": 141715,
                "gas_used": 128036,
                "subtraces": 1,
                "trace_address": "6,0",
                "error": "",
                "status": 1,
                "trace_root": 6,
                "method_id": "0xb61d27f6",
                "tx_from_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "bundler_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "entrypoint_contract_address": "0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789",
                "entrypoint_contract_version": "v6",
                "innerhandleop_trace_address": "6",
                "is_innerhandleop": False,
                "is_from_sender": False,
                "userop_sender": "0xda88ba8c4e3259e9be2f05ec690052fc92962b37",
                "userop_paymaster": "0x2faeb0760d4230ef2ac21496bb4f0b47d634fd4c",
                "userop_hash": "0x68cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a71341",
                "userop_calldata": "0xb61d27f600000000000000000000000080625310db240631a91f61659ccc550ea97617420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c429c911c9000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b37000000000000000000000000000000000000000000000000000000000001565e000000000000000000000000000000000000000000000000000000006722cc9a000000000000000000000000000000000000000000000000000000000000001b602a0f66f4c9e608e2172ac2023dadc8131a72bd44363d2c625c3a20e00b0eaf3e79d5fdff617c47558896859b377a175236cf00047513a83cbdfa273a6462c300000000000000000000000000000000000000000000000000000000",
                "innerhandleop_decodeerror": None,
                "innerhandleop_opinfo": '{"mUserOp": {"nonce": "2546", "callGasLimit": "141715", "verificationGasLimit": "92282", "preVerificationGas": "232005", "maxFeePerGas": "6303108", "maxPriorityFeePerGas": "1000000"}, "prefund": "4100587759128", "contextOffset": "3136", "preOpGas": "288303"}',
                "innerhandleop_context": "0x000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b3768cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a713410000000000000000000000000000000037233018550b44e3af73c8dc20a6213f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000697800000000000000000000000000000000000000000000000000000000000f42400000000000000000000000000000000000000000000000000000000000602d84000000000000000000000000b676f87a6e701f0de8de5ab91b56b66109766db100000000000000000000000095796e0d139d02eb0d89a79ca2938f79dd324a2e00000000000000000000000000000000000000000000012a7b51905bcd9ba000",
                "useropevent_nonce": "2546",
                "useropevent_success": True,
                "useropevent_actualgascost": "2404335545082",
                "useropevent_actualgasused": "444078",
                "userop_idx": None,
                "useropevent_actualgascost_eth": 2.404335545082e-06,
            },
            {
                "dt": datetime.date(2024, 10, 30),
                "chain": "base",
                "chain_id": 8453,
                "network": "mainnet",
                "block_timestamp": 1730330263,
                "block_number": 21770458,
                "block_hash": "0x56a1f34c843abfd0a99db7b9353975fc9ac7f219d4cf536bd30bcc7d2bef1a88",
                "transaction_hash": "0x90d69e803dcef7e4bcdde5b19fe4f22cd10c097ec30208c1b01d0a7b43818388",
                "transaction_index": 139,
                "from_address": "0xda88ba8c4e3259e9be2f05ec690052fc92962b37",
                "to_address": "0x80625310db240631a91f61659ccc550ea9761742",
                "value": "0",
                "input": "0x29c911c9000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b37000000000000000000000000000000000000000000000000000000000001565e000000000000000000000000000000000000000000000000000000006722cc9a000000000000000000000000000000000000000000000000000000000000001b602a0f66f4c9e608e2172ac2023dadc8131a72bd44363d2c625c3a20e00b0eaf3e79d5fdff617c47558896859b377a175236cf00047513a83cbdfa273a6462c3",
                "output": "",
                "trace_type": "call",
                "call_type": "call",
                "reward_type": "",
                "gas": 132780,
                "gas_used": 123267,
                "subtraces": 3,
                "trace_address": "6,0,0,0",
                "error": "",
                "status": 1,
                "trace_root": 6,
                "method_id": "0x29c911c9",
                "tx_from_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "bundler_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "entrypoint_contract_address": "0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789",
                "entrypoint_contract_version": "v6",
                "innerhandleop_trace_address": "6",
                "is_innerhandleop": False,
                "is_from_sender": True,
                "userop_sender": "0xda88ba8c4e3259e9be2f05ec690052fc92962b37",
                "userop_paymaster": "0x2faeb0760d4230ef2ac21496bb4f0b47d634fd4c",
                "userop_hash": "0x68cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a71341",
                "userop_calldata": "0xb61d27f600000000000000000000000080625310db240631a91f61659ccc550ea97617420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c429c911c9000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b37000000000000000000000000000000000000000000000000000000000001565e000000000000000000000000000000000000000000000000000000006722cc9a000000000000000000000000000000000000000000000000000000000000001b602a0f66f4c9e608e2172ac2023dadc8131a72bd44363d2c625c3a20e00b0eaf3e79d5fdff617c47558896859b377a175236cf00047513a83cbdfa273a6462c300000000000000000000000000000000000000000000000000000000",
                "innerhandleop_decodeerror": None,
                "innerhandleop_opinfo": '{"mUserOp": {"nonce": "2546", "callGasLimit": "141715", "verificationGasLimit": "92282", "preVerificationGas": "232005", "maxFeePerGas": "6303108", "maxPriorityFeePerGas": "1000000"}, "prefund": "4100587759128", "contextOffset": "3136", "preOpGas": "288303"}',
                "innerhandleop_context": "0x000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b3768cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a713410000000000000000000000000000000037233018550b44e3af73c8dc20a6213f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000697800000000000000000000000000000000000000000000000000000000000f42400000000000000000000000000000000000000000000000000000000000602d84000000000000000000000000b676f87a6e701f0de8de5ab91b56b66109766db100000000000000000000000095796e0d139d02eb0d89a79ca2938f79dd324a2e00000000000000000000000000000000000000000000012a7b51905bcd9ba000",
                "useropevent_nonce": "2546",
                "useropevent_success": True,
                "useropevent_actualgascost": "2404335545082",
                "useropevent_actualgasused": "444078",
                "userop_idx": 1,
                "useropevent_actualgascost_eth": 2.404335545082e-06,
            },
            {
                "dt": datetime.date(2024, 10, 30),
                "chain": "base",
                "chain_id": 8453,
                "network": "mainnet",
                "block_timestamp": 1730330263,
                "block_number": 21770458,
                "block_hash": "0x56a1f34c843abfd0a99db7b9353975fc9ac7f219d4cf536bd30bcc7d2bef1a88",
                "transaction_hash": "0x90d69e803dcef7e4bcdde5b19fe4f22cd10c097ec30208c1b01d0a7b43818388",
                "transaction_index": 139,
                "from_address": "0x80625310db240631a91f61659ccc550ea9761742",
                "to_address": "0x0982b3a5b24b2bd8ef74126e15fca2decfd75a28",
                "value": "0",
                "input": "0x6352211e000000000000000000000000000000000000000000000000000000000001565e",
                "output": "0x000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b37",
                "trace_type": "call",
                "call_type": "staticcall",
                "reward_type": "",
                "gas": 116779,
                "gas_used": 3028,
                "subtraces": 0,
                "trace_address": "6,0,0,0,0",
                "error": "",
                "status": 1,
                "trace_root": 6,
                "method_id": "0x6352211e",
                "tx_from_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "bundler_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "entrypoint_contract_address": "0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789",
                "entrypoint_contract_version": "v6",
                "innerhandleop_trace_address": "6",
                "is_innerhandleop": False,
                "is_from_sender": False,
                "userop_sender": "0xda88ba8c4e3259e9be2f05ec690052fc92962b37",
                "userop_paymaster": "0x2faeb0760d4230ef2ac21496bb4f0b47d634fd4c",
                "userop_hash": "0x68cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a71341",
                "userop_calldata": "0xb61d27f600000000000000000000000080625310db240631a91f61659ccc550ea97617420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c429c911c9000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b37000000000000000000000000000000000000000000000000000000000001565e000000000000000000000000000000000000000000000000000000006722cc9a000000000000000000000000000000000000000000000000000000000000001b602a0f66f4c9e608e2172ac2023dadc8131a72bd44363d2c625c3a20e00b0eaf3e79d5fdff617c47558896859b377a175236cf00047513a83cbdfa273a6462c300000000000000000000000000000000000000000000000000000000",
                "innerhandleop_decodeerror": None,
                "innerhandleop_opinfo": '{"mUserOp": {"nonce": "2546", "callGasLimit": "141715", "verificationGasLimit": "92282", "preVerificationGas": "232005", "maxFeePerGas": "6303108", "maxPriorityFeePerGas": "1000000"}, "prefund": "4100587759128", "contextOffset": "3136", "preOpGas": "288303"}',
                "innerhandleop_context": "0x000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b3768cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a713410000000000000000000000000000000037233018550b44e3af73c8dc20a6213f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000697800000000000000000000000000000000000000000000000000000000000f42400000000000000000000000000000000000000000000000000000000000602d84000000000000000000000000b676f87a6e701f0de8de5ab91b56b66109766db100000000000000000000000095796e0d139d02eb0d89a79ca2938f79dd324a2e00000000000000000000000000000000000000000000012a7b51905bcd9ba000",
                "useropevent_nonce": "2546",
                "useropevent_success": True,
                "useropevent_actualgascost": "2404335545082",
                "useropevent_actualgasused": "444078",
                "userop_idx": None,
                "useropevent_actualgascost_eth": 2.404335545082e-06,
            },
            {
                "dt": datetime.date(2024, 10, 30),
                "chain": "base",
                "chain_id": 8453,
                "network": "mainnet",
                "block_timestamp": 1730330263,
                "block_number": 21770458,
                "block_hash": "0x56a1f34c843abfd0a99db7b9353975fc9ac7f219d4cf536bd30bcc7d2bef1a88",
                "transaction_hash": "0x90d69e803dcef7e4bcdde5b19fe4f22cd10c097ec30208c1b01d0a7b43818388",
                "transaction_index": 139,
                "from_address": "0x80625310db240631a91f61659ccc550ea9761742",
                "to_address": "0x0000000000000000000000000000000000000001",
                "value": "0",
                "input": "0x07354f946da6444e3ca4861d820beab063a2f0dff882bee8b49f0961b7fe0d74000000000000000000000000000000000000000000000000000000000000001b602a0f66f4c9e608e2172ac2023dadc8131a72bd44363d2c625c3a20e00b0eaf3e79d5fdff617c47558896859b377a175236cf00047513a83cbdfa273a6462c3",
                "output": "0x000000000000000000000000f8966317b01750ff17e3a05e3c1c822866d00354",
                "trace_type": "call",
                "call_type": "staticcall",
                "reward_type": "",
                "gas": 108577,
                "gas_used": 3000,
                "subtraces": 0,
                "trace_address": "6,0,0,0,1",
                "error": "",
                "status": 1,
                "trace_root": 6,
                "method_id": "0x07354f94",
                "tx_from_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "bundler_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "entrypoint_contract_address": "0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789",
                "entrypoint_contract_version": "v6",
                "innerhandleop_trace_address": "6",
                "is_innerhandleop": False,
                "is_from_sender": False,
                "userop_sender": "0xda88ba8c4e3259e9be2f05ec690052fc92962b37",
                "userop_paymaster": "0x2faeb0760d4230ef2ac21496bb4f0b47d634fd4c",
                "userop_hash": "0x68cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a71341",
                "userop_calldata": "0xb61d27f600000000000000000000000080625310db240631a91f61659ccc550ea97617420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c429c911c9000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b37000000000000000000000000000000000000000000000000000000000001565e000000000000000000000000000000000000000000000000000000006722cc9a000000000000000000000000000000000000000000000000000000000000001b602a0f66f4c9e608e2172ac2023dadc8131a72bd44363d2c625c3a20e00b0eaf3e79d5fdff617c47558896859b377a175236cf00047513a83cbdfa273a6462c300000000000000000000000000000000000000000000000000000000",
                "innerhandleop_decodeerror": None,
                "innerhandleop_opinfo": '{"mUserOp": {"nonce": "2546", "callGasLimit": "141715", "verificationGasLimit": "92282", "preVerificationGas": "232005", "maxFeePerGas": "6303108", "maxPriorityFeePerGas": "1000000"}, "prefund": "4100587759128", "contextOffset": "3136", "preOpGas": "288303"}',
                "innerhandleop_context": "0x000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b3768cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a713410000000000000000000000000000000037233018550b44e3af73c8dc20a6213f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000697800000000000000000000000000000000000000000000000000000000000f42400000000000000000000000000000000000000000000000000000000000602d84000000000000000000000000b676f87a6e701f0de8de5ab91b56b66109766db100000000000000000000000095796e0d139d02eb0d89a79ca2938f79dd324a2e00000000000000000000000000000000000000000000012a7b51905bcd9ba000",
                "useropevent_nonce": "2546",
                "useropevent_success": True,
                "useropevent_actualgascost": "2404335545082",
                "useropevent_actualgasused": "444078",
                "userop_idx": None,
                "useropevent_actualgascost_eth": 2.404335545082e-06,
            },
            {
                "dt": datetime.date(2024, 10, 30),
                "chain": "base",
                "chain_id": 8453,
                "network": "mainnet",
                "block_timestamp": 1730330263,
                "block_number": 21770458,
                "block_hash": "0x56a1f34c843abfd0a99db7b9353975fc9ac7f219d4cf536bd30bcc7d2bef1a88",
                "transaction_hash": "0x90d69e803dcef7e4bcdde5b19fe4f22cd10c097ec30208c1b01d0a7b43818388",
                "transaction_index": 139,
                "from_address": "0x80625310db240631a91f61659ccc550ea9761742",
                "to_address": "0x0982b3a5b24b2bd8ef74126e15fca2decfd75a28",
                "value": "0",
                "input": "0x42842e0e000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b3700000000000000000000000080625310db240631a91f61659ccc550ea9761742000000000000000000000000000000000000000000000000000000000001565e",
                "output": "",
                "trace_type": "call",
                "call_type": "call",
                "reward_type": "",
                "gas": 79722,
                "gas_used": 69161,
                "subtraces": 1,
                "trace_address": "6,0,0,0,2",
                "error": "",
                "status": 1,
                "trace_root": 6,
                "method_id": "0x42842e0e",
                "tx_from_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "bundler_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "entrypoint_contract_address": "0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789",
                "entrypoint_contract_version": "v6",
                "innerhandleop_trace_address": "6",
                "is_innerhandleop": False,
                "is_from_sender": False,
                "userop_sender": "0xda88ba8c4e3259e9be2f05ec690052fc92962b37",
                "userop_paymaster": "0x2faeb0760d4230ef2ac21496bb4f0b47d634fd4c",
                "userop_hash": "0x68cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a71341",
                "userop_calldata": "0xb61d27f600000000000000000000000080625310db240631a91f61659ccc550ea97617420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c429c911c9000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b37000000000000000000000000000000000000000000000000000000000001565e000000000000000000000000000000000000000000000000000000006722cc9a000000000000000000000000000000000000000000000000000000000000001b602a0f66f4c9e608e2172ac2023dadc8131a72bd44363d2c625c3a20e00b0eaf3e79d5fdff617c47558896859b377a175236cf00047513a83cbdfa273a6462c300000000000000000000000000000000000000000000000000000000",
                "innerhandleop_decodeerror": None,
                "innerhandleop_opinfo": '{"mUserOp": {"nonce": "2546", "callGasLimit": "141715", "verificationGasLimit": "92282", "preVerificationGas": "232005", "maxFeePerGas": "6303108", "maxPriorityFeePerGas": "1000000"}, "prefund": "4100587759128", "contextOffset": "3136", "preOpGas": "288303"}',
                "innerhandleop_context": "0x000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b3768cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a713410000000000000000000000000000000037233018550b44e3af73c8dc20a6213f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000697800000000000000000000000000000000000000000000000000000000000f42400000000000000000000000000000000000000000000000000000000000602d84000000000000000000000000b676f87a6e701f0de8de5ab91b56b66109766db100000000000000000000000095796e0d139d02eb0d89a79ca2938f79dd324a2e00000000000000000000000000000000000000000000012a7b51905bcd9ba000",
                "useropevent_nonce": "2546",
                "useropevent_success": True,
                "useropevent_actualgascost": "2404335545082",
                "useropevent_actualgasused": "444078",
                "userop_idx": None,
                "useropevent_actualgascost_eth": 2.404335545082e-06,
            },
            {
                "dt": datetime.date(2024, 10, 30),
                "chain": "base",
                "chain_id": 8453,
                "network": "mainnet",
                "block_timestamp": 1730330263,
                "block_number": 21770458,
                "block_hash": "0x56a1f34c843abfd0a99db7b9353975fc9ac7f219d4cf536bd30bcc7d2bef1a88",
                "transaction_hash": "0x90d69e803dcef7e4bcdde5b19fe4f22cd10c097ec30208c1b01d0a7b43818388",
                "transaction_index": 139,
                "from_address": "0x0982b3a5b24b2bd8ef74126e15fca2decfd75a28",
                "to_address": "0x80625310db240631a91f61659ccc550ea9761742",
                "value": "0",
                "input": "0x150b7a0200000000000000000000000080625310db240631a91f61659ccc550ea9761742000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b37000000000000000000000000000000000000000000000000000000000001565e00000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000",
                "output": "0x150b7a0200000000000000000000000000000000000000000000000000000000",
                "trace_type": "call",
                "call_type": "call",
                "reward_type": "",
                "gas": 12159,
                "gas_used": 1349,
                "subtraces": 0,
                "trace_address": "6,0,0,0,2,0",
                "error": "",
                "status": 1,
                "trace_root": 6,
                "method_id": "0x150b7a02",
                "tx_from_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "bundler_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "entrypoint_contract_address": "0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789",
                "entrypoint_contract_version": "v6",
                "innerhandleop_trace_address": "6",
                "is_innerhandleop": False,
                "is_from_sender": False,
                "userop_sender": "0xda88ba8c4e3259e9be2f05ec690052fc92962b37",
                "userop_paymaster": "0x2faeb0760d4230ef2ac21496bb4f0b47d634fd4c",
                "userop_hash": "0x68cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a71341",
                "userop_calldata": "0xb61d27f600000000000000000000000080625310db240631a91f61659ccc550ea97617420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c429c911c9000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b37000000000000000000000000000000000000000000000000000000000001565e000000000000000000000000000000000000000000000000000000006722cc9a000000000000000000000000000000000000000000000000000000000000001b602a0f66f4c9e608e2172ac2023dadc8131a72bd44363d2c625c3a20e00b0eaf3e79d5fdff617c47558896859b377a175236cf00047513a83cbdfa273a6462c300000000000000000000000000000000000000000000000000000000",
                "innerhandleop_decodeerror": None,
                "innerhandleop_opinfo": '{"mUserOp": {"nonce": "2546", "callGasLimit": "141715", "verificationGasLimit": "92282", "preVerificationGas": "232005", "maxFeePerGas": "6303108", "maxPriorityFeePerGas": "1000000"}, "prefund": "4100587759128", "contextOffset": "3136", "preOpGas": "288303"}',
                "innerhandleop_context": "0x000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b3768cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a713410000000000000000000000000000000037233018550b44e3af73c8dc20a6213f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000697800000000000000000000000000000000000000000000000000000000000f42400000000000000000000000000000000000000000000000000000000000602d84000000000000000000000000b676f87a6e701f0de8de5ab91b56b66109766db100000000000000000000000095796e0d139d02eb0d89a79ca2938f79dd324a2e00000000000000000000000000000000000000000000012a7b51905bcd9ba000",
                "useropevent_nonce": "2546",
                "useropevent_success": True,
                "useropevent_actualgascost": "2404335545082",
                "useropevent_actualgasused": "444078",
                "userop_idx": None,
                "useropevent_actualgascost_eth": 2.404335545082e-06,
            },
            {
                "dt": datetime.date(2024, 10, 30),
                "chain": "base",
                "chain_id": 8453,
                "network": "mainnet",
                "block_timestamp": 1730330263,
                "block_number": 21770458,
                "block_hash": "0x56a1f34c843abfd0a99db7b9353975fc9ac7f219d4cf536bd30bcc7d2bef1a88",
                "transaction_hash": "0x90d69e803dcef7e4bcdde5b19fe4f22cd10c097ec30208c1b01d0a7b43818388",
                "transaction_index": 139,
                "from_address": "0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789",
                "to_address": "0x2faeb0760d4230ef2ac21496bb4f0b47d634fd4c",
                "value": "0",
                "input": "0xa9a23409000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000020d5a79e4ba0000000000000000000000000000000000000000000000000000000000000160000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b3768cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a713410000000000000000000000000000000037233018550b44e3af73c8dc20a6213f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000697800000000000000000000000000000000000000000000000000000000000f42400000000000000000000000000000000000000000000000000000000000602d84000000000000000000000000b676f87a6e701f0de8de5ab91b56b66109766db100000000000000000000000095796e0d139d02eb0d89a79ca2938f79dd324a2e00000000000000000000000000000000000000000000012a7b51905bcd9ba000",
                "output": "",
                "trace_type": "call",
                "call_type": "call",
                "reward_type": "",
                "gas": 92282,
                "gas_used": 25489,
                "subtraces": 1,
                "trace_address": "6,1",
                "error": "",
                "status": 1,
                "trace_root": 6,
                "method_id": "0xa9a23409",
                "tx_from_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "bundler_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "entrypoint_contract_address": "0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789",
                "entrypoint_contract_version": "v6",
                "innerhandleop_trace_address": "6",
                "is_innerhandleop": False,
                "is_from_sender": False,
                "userop_sender": "0xda88ba8c4e3259e9be2f05ec690052fc92962b37",
                "userop_paymaster": "0x2faeb0760d4230ef2ac21496bb4f0b47d634fd4c",
                "userop_hash": "0x68cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a71341",
                "userop_calldata": "0xb61d27f600000000000000000000000080625310db240631a91f61659ccc550ea97617420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c429c911c9000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b37000000000000000000000000000000000000000000000000000000000001565e000000000000000000000000000000000000000000000000000000006722cc9a000000000000000000000000000000000000000000000000000000000000001b602a0f66f4c9e608e2172ac2023dadc8131a72bd44363d2c625c3a20e00b0eaf3e79d5fdff617c47558896859b377a175236cf00047513a83cbdfa273a6462c300000000000000000000000000000000000000000000000000000000",
                "innerhandleop_decodeerror": None,
                "innerhandleop_opinfo": '{"mUserOp": {"nonce": "2546", "callGasLimit": "141715", "verificationGasLimit": "92282", "preVerificationGas": "232005", "maxFeePerGas": "6303108", "maxPriorityFeePerGas": "1000000"}, "prefund": "4100587759128", "contextOffset": "3136", "preOpGas": "288303"}',
                "innerhandleop_context": "0x000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b3768cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a713410000000000000000000000000000000037233018550b44e3af73c8dc20a6213f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000697800000000000000000000000000000000000000000000000000000000000f42400000000000000000000000000000000000000000000000000000000000602d84000000000000000000000000b676f87a6e701f0de8de5ab91b56b66109766db100000000000000000000000095796e0d139d02eb0d89a79ca2938f79dd324a2e00000000000000000000000000000000000000000000012a7b51905bcd9ba000",
                "useropevent_nonce": "2546",
                "useropevent_success": True,
                "useropevent_actualgascost": "2404335545082",
                "useropevent_actualgasused": "444078",
                "userop_idx": None,
                "useropevent_actualgascost_eth": 2.404335545082e-06,
            },
            {
                "dt": datetime.date(2024, 10, 30),
                "chain": "base",
                "chain_id": 8453,
                "network": "mainnet",
                "block_timestamp": 1730330263,
                "block_number": 21770458,
                "block_hash": "0x56a1f34c843abfd0a99db7b9353975fc9ac7f219d4cf536bd30bcc7d2bef1a88",
                "transaction_hash": "0x90d69e803dcef7e4bcdde5b19fe4f22cd10c097ec30208c1b01d0a7b43818388",
                "transaction_index": 139,
                "from_address": "0x2faeb0760d4230ef2ac21496bb4f0b47d634fd4c",
                "to_address": "0xb676f87a6e701f0de8de5ab91b56b66109766db1",
                "value": "0",
                "input": "0x23b872dd000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b3700000000000000000000000095796e0d139d02eb0d89a79ca2938f79dd324a2e000000000000000000000000000000000000000000000000002eff478173b415",
                "output": "0x0000000000000000000000000000000000000000000000000000000000000001",
                "trace_type": "call",
                "call_type": "call",
                "reward_type": "",
                "gas": 86164,
                "gas_used": 18021,
                "subtraces": 0,
                "trace_address": "6,1,0",
                "error": "",
                "status": 1,
                "trace_root": 6,
                "method_id": "0x23b872dd",
                "tx_from_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "bundler_address": "0xfbd85a0c200b286ef2d7a08306113669013c39da",
                "entrypoint_contract_address": "0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789",
                "entrypoint_contract_version": "v6",
                "innerhandleop_trace_address": "6",
                "is_innerhandleop": False,
                "is_from_sender": False,
                "userop_sender": "0xda88ba8c4e3259e9be2f05ec690052fc92962b37",
                "userop_paymaster": "0x2faeb0760d4230ef2ac21496bb4f0b47d634fd4c",
                "userop_hash": "0x68cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a71341",
                "userop_calldata": "0xb61d27f600000000000000000000000080625310db240631a91f61659ccc550ea97617420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000c429c911c9000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b37000000000000000000000000000000000000000000000000000000000001565e000000000000000000000000000000000000000000000000000000006722cc9a000000000000000000000000000000000000000000000000000000000000001b602a0f66f4c9e608e2172ac2023dadc8131a72bd44363d2c625c3a20e00b0eaf3e79d5fdff617c47558896859b377a175236cf00047513a83cbdfa273a6462c300000000000000000000000000000000000000000000000000000000",
                "innerhandleop_decodeerror": None,
                "innerhandleop_opinfo": '{"mUserOp": {"nonce": "2546", "callGasLimit": "141715", "verificationGasLimit": "92282", "preVerificationGas": "232005", "maxFeePerGas": "6303108", "maxPriorityFeePerGas": "1000000"}, "prefund": "4100587759128", "contextOffset": "3136", "preOpGas": "288303"}',
                "innerhandleop_context": "0x000000000000000000000000da88ba8c4e3259e9be2f05ec690052fc92962b3768cf0e881d29d876fd67c5b4cdcb161db1cb61089695b014aa5c47ea08a713410000000000000000000000000000000037233018550b44e3af73c8dc20a6213f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000697800000000000000000000000000000000000000000000000000000000000f42400000000000000000000000000000000000000000000000000000000000602d84000000000000000000000000b676f87a6e701f0de8de5ab91b56b66109766db100000000000000000000000095796e0d139d02eb0d89a79ca2938f79dd324a2e00000000000000000000000000000000000000000000012a7b51905bcd9ba000",
                "useropevent_nonce": "2546",
                "useropevent_success": True,
                "useropevent_actualgascost": "2404335545082",
                "useropevent_actualgasused": "444078",
                "userop_idx": None,
                "useropevent_actualgascost_eth": 2.404335545082e-06,
            },
        ]

    def test_log_counts(self):
        assert self._duckdb_context is not None

        output = (
            self._duckdb_context.client.sql("""
        SELECT transaction_hash, count(*) as num_logs FROM useroperationevent_logs_v2
        GROUP BY 1
        ORDER BY 1
        LIMIT 10
        """)
            .pl()
            .to_dicts()
        )

        assert output == [
            {
                "transaction_hash": "0x0041d59070e72cf37051fe8b22b31f47b4355dab69b21755c486964bff6e493c",
                "num_logs": 1,
            },
            {
                "transaction_hash": "0x07bc6ccb6975e7c67e189850c0b3de963b0b14586b2ee453a241a337e2946891",
                "num_logs": 1,
            },
            {
                "transaction_hash": "0x09e668fcf184b9e9aa2be0c5a7188a8c2f72d46cd2b6f7a035a55962f3f3e629",
                "num_logs": 1,
            },
            {
                "transaction_hash": "0x0a68ae942d839f47f587a3553f7774dedf6f615afb1ed2132da6a07268e8a0ec",
                "num_logs": 1,
            },
            {
                "transaction_hash": "0x0bdf8209b8d04828787cff669ae652b6b8bf9e5c5c6265c8aa30af75d5c0ee23",
                "num_logs": 1,
            },
            {
                "transaction_hash": "0x0c55b4b38f99b1dae8239bceb81190ae5beabb6db15d56974046ebd6fe3d3744",
                "num_logs": 1,
            },
            {
                "transaction_hash": "0x0f3cdcee1a9790aab458f390cfa65e9cf655ce8dd3f70db3ca974feadd24af50",
                "num_logs": 1,
            },
            {
                "transaction_hash": "0x103fd6211186efb4d74e97d3ab6492349436cbbea3a04becd47d93c1acaced13",
                "num_logs": 1,
            },
            {
                "transaction_hash": "0x13a6a84d4ef085d31f50ab74b6fbe566082d601a4c79744e70c5ff96cf8a0698",
                "num_logs": 1,
            },
            {
                "transaction_hash": "0x143b7262248d436ccf63f6a15db0fdff4a261c487aaeb6b6d180cf57b068316b",
                "num_logs": 1,
            },
        ]
