from op_analytics.datasources.chainsmeta.systemconfig.chain import _int_to_str
from op_analytics.datasources.chainsmeta.systemconfig.transform import _normalize_address
from op_analytics.datasources.chainsmeta.systemconfig.rpc import (
    SystemConfigMetadata,
    RPCManager,
    decode,
    decode_string_from_abi,
)
import pytest
from typing import Any


def test_int_to_str():
    assert _int_to_str(1) == "1"
    assert _int_to_str(None) is None


def test_normalize_address():
    assert _normalize_address(None) is None
    assert _normalize_address("0x0000AB0") == "0x0000ab0"


def test_decode_response():
    response: list[dict[Any, Any]] = [
        {
            "jsonrpc": "2.0",
            "id": "block",
            "result": {
                "baseFeePerGas": "0x5d3fb8ac",
                "blobGasUsed": "0x0",
                "difficulty": "0x0",
                "excessBlobGas": "0x100000",
                "extraData": "0x546974616e2028746974616e6275696c6465722e78797a29",
                "gasLimit": "0x2255100",
                "gasUsed": "0x1592227",
                "hash": "0x1e2b365faef9ca13b8a6dccd05e9b874f1285834690dcaa7c57a6c0346abeab4",
                "logsBloom": "0x59bf2fe76f3c1d7536605afd9e6a7dbf3fae257acef5626302af2a0fedfbfd229d47d7b5fa6eb2d6bab95feb2c93112b7f0d0daa8f532a2eb2d7effbadec6bf6e49eafeb50f3bfbe7913e3b9f9ffbdf5e9962aff3d764a6fb07c5e9adaf5952fdfcf3d1ffb7a4763f23fc3633c60ecbfefb7ccf6f45667cb977fcfdcc99bf81777dadfe9ec9df78cf17cf47efe7afebeff3fe7d5f7b89bacbb3a4a72ae9dd4febffe4f7ad7f9ebdd9abf98efdfe19d7abceff73e2c73c36b3fffd8e8fc68ab677f76dc7a8ee00f7f044d5b76f2393cceaadf537a666d9a7dcdf771dee674eee777fbec0e3fb469e5fae477b6b35709f5b56de924df79a6ee59f9fc1313de5e37",
                "miner": "0x4838b106fce9647bdf1e7877bf73ce8b0bad5f97",
                "mixHash": "0x893d188200423f514b44e2e6234b074a0dfe062fe0d66ed467d5a0607a823838",
                "nonce": "0x0000000000000000",
                "number": "0x15a5a16",
                "parentBeaconBlockRoot": "0x12287895e9214186fc82a650906849e54a1d4f73765bea367a4810d675edfa52",
                "parentHash": "0xd63a261f4021d772b5ca633ab84b2e96e95ff5c3e2e0e4e53ed3793c99c167f3",
                "receiptsRoot": "0xf1e4322c0fb489bfa4f938297a3555666002ba236c8bea68df17a4606ee92ba2",
                "requestsHash": "0xe3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855",
                "sha3Uncles": "0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",
                "size": "0x1e5ee",
                "stateRoot": "0xbc82acd558eb8eb2a3c39de329fa2cedc85ee75db061880a494a8ca8b9f7ce6f",
                "timestamp": "0x684ca13f",
                "transactions": [
                    "0x62ddd533230fcaf2c4f84eef050e7bb2ae893cdf33ffa1ef85b7fdb8f5fa960d",
                    "0xfb604c389feaa81f78c00d253f09a743ebde56d4635dd3b6c53d356255b95fd4",
                    "0xc5b79620d14427b35e011430fd448e1693373055ac5bd4448ebb749ce621c673",
                    "0x505d1b04f9fd82f63bd45dca2e558f6b3e1fe66e86631084418088b3706555bf",
                    "0x85f23dd55ab0950b4a82175030e95b262434b39732798ab48466cf9ef5d6246a",
                    "0x3d349a8c18900218c876bbc6787888d9d17c0e18c5ce6b8f32b091d5e816ee28",
                    "0x33d2a5642b53072904967b68a40de3319923b7fabfb5f105bbfb853e3e82f404",
                    "0x01b273d844ffc7248a6aae5a0c0bcd5f7ee56a5ca818420a5198253d1ab74462",
                    "0xf4d0d51b82db0ce53374727fa9d0f950f7012b1f36a52fd975e2071341ca770c",
                    "0xfd80db8701f86e72771d12545785dc45fa2c0d1855759f741c98134e2fe22834",
                    "0xda2bc884c33bf7dbea51a9645dfd8ff78f4f775b40f56abb34a5de70ae776110",
                    "0x93300de8215d2cad75bdebab1a0b8860cd0bf363b19c4971ad1249c7fbb0f5cd",
                    "0x14aebba644dba7294bb96b14db64393a3c964693657fb8e27178b54af9e5dabe",
                    "0x1966790b81ac9c3cffb247c032c37c5b9cb238f0f8670605824f5d1adfeec770",
                    "0xb3af6b75a2886bc32fc08992522b8b6a526d7c3012ea6a017b0e175b558fdf15",
                    "0xd76c3fbc8e13da7331171d26f1f327566991f874107b747bee2c24be59d82c10",
                    "0xaef5a3cc48aa8cfa5b8f65b0db0e6cd4b3c2e6417be2c73de924d035e10754ad",
                    "0xf7b03a7307900ddff1ae3b2befa9474e3a4464d56331e1a18e5cd5b8d9dbd9fd",
                    "0x49e21aff375e85cb9b4d30f2d67afa41a25cc6b8dc2aea9fd30e3403cdf80df6",
                    "0xec24ba809bd8834bdca63ebdf756cb7e0a48b731e9bb59221ddcda4d7d70e1f2",
                    "0xadf7dc119442a658c666ebcc1c7a7360a42644971d664cb032b711399241e224",
                    "0xc5eac98c8ea56a8f9dcffe74f3c9e4df8ccbdde6522989780c362f4b0fcfb10c",
                    "0xd7bb37faaf3a7a16ee15367aef5bbd8fa4a9aacb286efd194fe7538d32cd2ac1",
                    "0xdb51f4ae4b890b93074e460b782c12926e85540dbf378565d7a5a994d99d66a5",
                    "0xa1367fc244357e08b556d4e94f00064058dd388a18a4a92a474dc6ba921ff16b",
                    "0x8b5560fab8f77f5f44889c1f3ce7ee1f5a93937cd3b18a3141afc42a1066b9b7",
                    "0xa0db450683f8d7b0adcce17546344026cf51d1db15b1562ac509281d035d2ddf",
                    "0xbb5621698b0cf2d62210094fb1617eae73de0fe0fdd67b2ee6d3ee9ac6db2484",
                    "0x01f3ac7e421aa1bef1fe5724ae4f2d03724a58cc96e001ff067b625e8b89ba23",
                    "0x9ebb691e82e1df3596d717b20d5399911b37ff220fcc87eb6995bd5854577665",
                    "0x1d80a966a68c031018fe58154fd3b5bac1ea12ed1cfaede55bf6b7dcca7c3b51",
                    "0x07cd8de5c02e91ea11de262621c834ac41c4b244cd41f6d674448ab7b3c9a44e",
                    "0x2e41def7e5f85d34152bbe53e140cadb506c53ef8298fe7d52a9aa34891c7ddb",
                    "0xffcd039caed464f38f7c92ab7831fdd4eb77a400d392ddbcca1a5ec1535ce2e0",
                    "0x21cf477d79f1f60ae09d6f43f33af59496ec8bb77f0ae5df1f87f811c8d1afc9",
                    "0x5a0f12356c02a462e2815993f67044ae7e747fdf33f6bdcf97b49ffde289562e",
                    "0x3bc4525540c60d216be2af39054edf90d665a94bf3c16f0574dba964528a174e",
                    "0xf24e97871fa853585a0063a30e66289965123e8138661b53d35f0c79046184b4",
                    "0x797d838abeb7883be6a305c0914b17cfdccb62dc593f806d942f82e91cfc4608",
                    "0xab435f63d8ebf94a21e168b6fdb43b67b44e45c0f655c3a4803612a824b0a21d",
                    "0xd980c3ab8951f2c080b59b6fb7a35c9fb0df832516a5184f7d8c667e9cbe6e2e",
                    "0xc3391113f4af67c06a3d367f670258e269fff78808a7850e34e8294942ad822c",
                    "0x936a080ea748d9bb95ea10ef6d36de8262020f7cf7a44f978dc0b968722269cd",
                    "0x52e18a1e12587f539ca7e3020bdcfc3093e82604f676c4b4d272c1151dc3aad3",
                    "0x011ef32ad6c8fd3cfaad89257f7edc3c74d50789f041b895a140fed635f690c2",
                    "0x689c2f638eae5613c510a237ef844c4d5d3f7ee6cc58c065dfe74b56bd87c1cf",
                    "0xa804b01e1c5e81243bc9659909e6aad08c808fd698a4521fcb5983eaf3bc5469",
                    "0x4c22b7bddbf559aee8c2f4c5340376202692a925fc658dd445cb6da0b83b6a38",
                    "0x9f37e547696e09a45eb20c49a0353c99f60a2294fcbe90c699684a04fb8c3d0b",
                    "0x66ffdccd1e06bbbc9eaf0002be3a9dd0d8e038f2bec25c3365817b1dbd153b48",
                    "0x31d5ca83e97d38f8e81073b66ad3584cd9892173655b43e8b4e8ad27360ed181",
                    "0x30e81ecc3da85dac4144180b9824d3830734d9d883aa128627d655f3145cc861",
                    "0x0ea9985f04c08f64729a66319132fbd495024432a33b0b6257bb7c8efc1c3aa3",
                    "0xb964806119532500ae6568ef8a3e00fbf226da337f15435ed19de32257e5f724",
                    "0x9b3dc524b126a6382dfaf066057a3b877ce327837a0088545ae21ee13a005a59",
                    "0xd9053448cccb6c129f117c39fe8442b1faa7029cfa28386112ecad0a0ac2b27b",
                    "0x351988bef0fb8470f951264c514dff9a92dddd2a78c64591be5bab54879fa163",
                    "0xac4c83f450ba4e6325890e1cb06546720538433fd06507342e3384c5cf27c8fb",
                    "0xc31fe34dec19b412eece6563ad4eb00c68050a9d8db0e81da045a82b359f9f08",
                    "0x1eb88e21a2968e7a5f02a1d19fc0bca48f8a1d26496310eb2cf774c9f816552d",
                    "0xd3f9dbcb8ef7ca328baa0f0ec79086a3a3e0a52d853f1a68b9e613db4e8a3901",
                    "0xaf7b886d98d84659e9cf98d370b774e0c1aa95d58c6b5c75aed62565b772abe5",
                    "0x45411b3e9e9ef137879a5cafdec0e7e0e251d204a7f8a1e28f5c1c2441d4423e",
                    "0xf374bdbd93d14a93dcf8feed461f2a68eb7f2909c4d75a6eeff790daa54846d2",
                    "0x42d0d2494b4794da10d703541550b6e9648e3222aa796529fdc1c54926d478bc",
                    "0x383e964fa239641e9f6ed5fc9811811b378e20d44a0423a8b3d6407485b1e8c0",
                    "0xcaa09281d1ed7e7049605d881d388be47cf91548dd9d3d9c61069b932e0f6bf8",
                    "0x2a98b21cda39faf514f7e243a716eed5953c1df24c33181a89201d7511fb1bb6",
                    "0xca767579852916b940b760374af216b6acb4894f5f91ff646a650a312fedab60",
                    "0x9de80318e21887f96ea6c7ee3602d5409cdf164ae466ff215f270165c721ffcf",
                    "0x367b9ad04a74070b6ceef175a4cd72dcfeba8bbf15a84dcce3580804de241509",
                    "0x787415ba62da56b837def0ef1c02c5edc12e2f0f21c17e82264573a063e53242",
                    "0xae465b3c351b226c83c3b643fcbbf7370c574d389f2b084e014ec5ffbc5d6026",
                    "0x6324d93487b3e08dfc3769b62d3c69014f3b39b3cf9e73b37efe042322069c11",
                    "0x099b2882e851637d9f7d7863baad40dc27bfa0519b4431b2815579844755c040",
                    "0x07ded06c97e1d67a6f340e9602d1f0f235727d17fc9d88d68600651ed2238862",
                    "0x1a991bd0476d1719545ee4709fc66fc1d228514e941a4381c716553ff9b2fd0e",
                    "0x2d14a603ef8d396cdd91e9941558e489106eda3001778c11c894cee08074fa73",
                    "0xcf2968d5e02d22fdb1c0f229a6ff31d4e86a054e6efdda4321cd1f7204933a65",
                    "0x9a974df85cf3c5238afe36d742d418a6cb2d816f766aae17ecadf3ef7026a38d",
                    "0xc282022122ed4396b1d11baca17839d414b47540f019d4300da8191417defe29",
                    "0x31b4849f06af64f3752c4f0bb628a25ba2001663620c2c3cf29415d48289f283",
                    "0x94f770da376fe3fb3936a7a78737789c877ad1d7ad07e3f1c3e8a9e75a579355",
                    "0x9b04a6d6a11f743e7080c442a1bccd4c70e242bf7bbd8cf34212843121a6dc2f",
                    "0x8f95b9adc2eeee92c1c9516bceb6caa2e66ca95c5af88604dd0f36f2982dae43",
                    "0x9569423b14aac547567962dcb341ac2258fc17204f3f9706fc45c21b144e886b",
                    "0x7e149f92ace2ff3ca9ff234d9d90ee2a8ece2a5c4d1d9d482a8f0a5c737f3600",
                    "0xa2a686bc77c47c0625070bec09daedc8d3330c4a6cec33506891ef9fbd3a55c8",
                    "0x2b226a79838e34541815c8a556184ef7275470f7defbb04eb882e65c90668788",
                    "0xcda66abbedb2900901fdddbb214105a83d61b2dfcb9af8572d8257d3a9b0077b",
                    "0x4d7ba104a46b9c13392b490198721e5f06fb167dc2fa49f3275d4831c0a7105c",
                    "0x40fe6fc5144ce00afdd247d29d55b3818a2879cae5193b15d0f76c70411b32b9",
                    "0x49c02ce67cd2e6ccf50a8f6dfe17a707b6facfb3179aa0b70d22dfb1094eb8b3",
                    "0x4081a57b17b477b6fed84e610d8f76d1727adb8b09b56d0b2353df85b21b5ab4",
                    "0x00422eaf2438aede2089c2444916767af5a8c1bad52cf88a527c36ca0fb686a9",
                    "0x15cf74068929b2236b2ab321d0ee661b59ced2eaa04d1954dea50bb027323e6a",
                    "0x91b48354d1ad70ad48aae602b9a85c63675fb9bc7476ddca9ccad54dd2bcf491",
                    "0xbc762388e922ac6893e661c42fca096a627b385aa43353689bf1849b2233b017",
                    "0x736c512ebed1dfe6c91d2d59178f6a42d4232435d686bf16983927824bfbb74b",
                    "0x3e5adef8d495565ce6420dfd2d69d23c75d61963aecf992ea416e9363a797fcf",
                    "0xd2d70b368fc482a68ca548be9039f5050538219880ae7795ce129b3da23bfdc4",
                    "0x0542c3a3cc4e5eaf4978fd1ed7a8f599e22ea651920eda684bb73f66bfe21c87",
                    "0xdc430d7ca9dcc3d415dba21276d7fd9d9f9150bccbf13e3bd5b5e749cb611d52",
                    "0xa3f6694e31ef7d5c74768a70d01aeefc3194bdf210b5e6b7ea5b02059eed2ac4",
                    "0x6dd37b2609a09b05f2d525fd460d52ba8b7b1f069cf78fd3458491745b32dff6",
                    "0x06a4a0e825959efde27c3e888870645d45e906579289471cb293d7ddf21805ec",
                    "0xd96cf23a7d1294bf25208521b6e870036ffe396d298f0e02eee4cd48481653d7",
                    "0x73d38c1833391e2e1e6a18b7927a7cfa7df84f8be335fdeda94b701c5eb474eb",
                    "0x9c06a923c45c11848320f45649020c85109367c924e27133d951acbfccbd01be",
                    "0x42e3a1036a0f850700c4732cba0d96510494c78f1bb5dec30384718fb5eb0ffe",
                    "0x31eaa15ceddc2df9e583207fa5b2764693aac6f84541128fdf9689bd292686f6",
                    "0x9f11759f63dd2d6f1708a8893c6e1e6ed034fc6525352a2e3b7d5acb70c41685",
                    "0xbb4341901ed11a479e6320aff1b1056b5d3c5d599fe7ca5e6386612f0ec68476",
                    "0xa28fe60293289060cbbd3b9ea5370e16d5cb3b120cacd9df762307fc793d3b40",
                    "0xa5c5ad2d34bb5a0e1135b6e28cc201660ddac27b21ad3d052d91b8c37bbc03de",
                    "0x655e618bb567e467612992bc500265824023750ce732a68c9fa5646161e2b02f",
                    "0x34cd4b4ae7bd2ee7e5eb3eac6faf1ec77f99f5cd30bf9d5cd245a64f37a4e7f9",
                    "0xd447311b6e0793562545525fa1f1c3c81ab425d3398e0b901575a33e1beef861",
                    "0xeb01ec56c3cb71ee77712fd1a31cda3669d33e8b0847f05e25dc36c6aeea7578",
                    "0xcd808cad20d10b3884db5e3defe0a0fbea549d2e24eb0a91bc461353f8702ff1",
                    "0xc71dec7776ffba88adc40e4af84d752057c5306ebc4cbd0d68dc6f3de55e28a5",
                    "0xea425e2f5cf0cb069a4b71e7f28dd3a34a5acca745bc0ae8997a6dd3cbdbd202",
                    "0x3dd2f2715789d291dd09f651931c3634d64f69d51e515a2c144f0086ccc55c4b",
                    "0xf0a2775d168ea2af6035e3209545de1d478e784fdd63a06aa866f913df357ac1",
                    "0x3d88676c2c60b90b4a6517b31d181387ecbeaa74e402473b2ee802242ac1a1fa",
                    "0xa35fc54333af7a18d8b2837231835fbfe089a741bf545c0e0069317d40f33c99",
                    "0xbbad292882ed78b26b32ed9a78694f4e6b779c990925eb3cbfb0951317ce81c2",
                    "0xcb681034150d99e8b6ef09ca001fc97cabc5c64af8b57c0f4f0ffb5068480155",
                    "0xbf3af50da6a1047fb244ea71cebfc2a21cbaddcbb9effa0a123cd17638aa63c4",
                    "0xe2c35751f7f0c1f45d565acb0b3a3b13fd81ef41930740ae059eabf293bce705",
                    "0xeb6a82e973f57b4227caf8afab35c083b0d96c0b5a4ae95727b4606b96e20bbe",
                    "0x6c3f2d9e608e1b2623bfd351143f16cb21837d0249a1f8c6ac3ec199c4949050",
                    "0xfc3d86f68d3a40f267184651a1cd21391b2ef2d9b5a61a2bac3bd70a67cd2d10",
                    "0x57e225df35edd21897bf845e26849bd4357910e7855b33caf6dd5ab31d8ef8e1",
                    "0xbc8c71904916d46a7f1ea670a6159c619b5169f48043277ea965c2b8c718c443",
                    "0x2c041c63acbfe093d67ed09f6eefe2496df2194e1f9269802ab2d924e22dc0e9",
                    "0xcd989bdf1f550c9e97a5654dda8a8922f99316d2fcf70c22df6b39be8ba1a1d3",
                    "0x0cb329906db05de84529959caa021dfe4b8ecf0b84810d8e5f709d8b19c003c2",
                    "0x2355206bff585c5264fab30061bbd69ebc74af0a4ac0d89a052056da9a96a482",
                    "0xbd26abb8e038a058d13a7c4bc505a535771cfd87bc4cd1f7108e48c019f39110",
                    "0xb80e249bbbddb028733550fd58bbbbc985df37d416a31b3656739899f3df6a6c",
                    "0x38550ab3200291792ef05cdfa5f65ea6a64071d2b26b7482aa96df1da3ef4806",
                    "0x15a7c9b4b6a0a077f33c6dd2013fdcf743c5090dd835a67a612b30af6d96eacf",
                    "0x272325f7cb07a7a9942857188445c9de7d27bf9a0246f3d481820c7e1aebdee5",
                    "0xc9b94e280de532dd86a3c1c75dc30307ee1366d5fab6a46140566b81cb81acaa",
                    "0x846b67b063eebad73f61765890e0888ff7ffa20c4281f2a6a527498ab075ace9",
                    "0x7e28495eecb24745fb4b731ea662d755e06063331a4d645463fedb626a50fb6c",
                    "0x42f857cb369955bc439bdcff2e9db46fe6badef2e5c9f1675b50e0abeff8e054",
                    "0x4c7b0a00094c93af4f386268871fde09ca22f417dd8f1adfb0d4932074bd51da",
                    "0x34f4475151667b82b3edfbf5400274c452a8509dcc5f40c50bd2548f0a4d5ae9",
                    "0xffc8080fad1244aabd28ed9d0aaf3d05d94ca0c9148c575c077da13ea96677ec",
                    "0x7e884868cda542cbd0449e17c751b8751a773d8105240119ae3ebcd6d6a16791",
                    "0x5b251dd6b75a3b2fceaae3f8505deff9c9e73f864e599a266383b92f4014c4d8",
                    "0x63f84a46baee7c93e2bb0b1a847a6c50714b76d5dad74bbb64e7e980d3d11f8f",
                    "0xbd693f2dbe95a4d8ef933357a035e96d171c3fac5df5dbd095ada2ae0a241b47",
                    "0xee977ce20a8692c8847c460ff761de893c61ef67db69ba26cf0565ed03ad05aa",
                    "0x0520abf7a840e22fbad097ccebf1f593014d8f62cedeed5f8baa10a1a3a5a33c",
                    "0x3d2c8cea631e96cdad9765efa752f59cdf8a63dde6089d68d67ea17d7bcbe1df",
                    "0xa6732d9e07cf21f5de5ed3576410f2d70cc2f24a23992b12fb8a642533ee1ac3",
                    "0x5a02d408584b55b68da778feb732957ba884b6e62b9998648ad9058fb5f76157",
                    "0x851b62ffa55f345f80498940c012cfd8ac74d36470226d3970f156cd352ebaa4",
                    "0xd2b79ec02d53d87d55805c18ab02ae7ccdc3e61df72cb5694783565c9fdf28c7",
                    "0x2731f5deb335298f360da25f5e0d7c9c90ac2e54d544c91b00eda6c4283c85de",
                    "0xcbac2ea71205c1b723be8f0603b182aa5fa4f0f8c62fa520587ea1adcf483f44",
                    "0x81c61ffec93ed8f00631c6a0726794f99c8be307142c97a6a889b22f2b5efe10",
                    "0xde6771410c9284ec90268692731f856e08a5f0b0805bcf934770a0b9b0e4f685",
                    "0x7e46455abf2118d50bbae34f56a825da5efdeebcb3119a75d3fddaafc318e96e",
                    "0x27e58e7d91c966e71d03f91f0b416e1194202c4e95ea48b64b115d330a8c6410",
                    "0x008be99020b292741ae511cf7081cdcd444681c2979fc0aab22e6341609767f3",
                    "0x5555bedde94a92066a9c16dcd35a3e465762bbf4745f0bc1b06f3a6bb044bcaf",
                    "0x47e010519c6a2556697dcd05fa104319ba0d42b0594e81dd101f2ff5ac64709a",
                    "0x8e1ce7640d2eb65be37991eeadc1fe29fc15182a50ca0578870f69325cbcfa52",
                    "0x1c31bd809064fbb6d390f93e2d5e660d3cf3451bafbdb060f310ae4dc67f4e0e",
                    "0x17f3b041666e3982d4255fdc377155309dcad283a0efb1678533f353d76ee536",
                    "0x7ffe419f31331e0ed5a7180194ca60fc9e4088fa04277ddea1d06ae75496efd9",
                    "0x1a4554c425803d89336898fc61ac69168104e412a56da04b0ac820b30e9e451c",
                    "0xd31597b04023203cdeb6acf282f9c50cd5b7730442cdd3014852078b31082937",
                    "0xec8e0206a14c16d34f2d71aa964f426f5f1ef5733e8af82cfe63a3bac1d5d72b",
                    "0x9df008cb02cd5cf42ce0caf5528267999b0ab3f2af6c765c0b3695831077ec1c",
                    "0x05cf8786f7249f2d8360d58cd853cb5e781469417333c1433d477dbf159baabc",
                    "0x54a83437183451a7f4ede915e7484df37b6d7da265d52eac403980e459695408",
                    "0x952518798da04468a9aac19458bfef4757a5d454b9ec8d3e05774f6fa2e17b17",
                    "0x732e06a73523835fecbed5f7ea77cd310c90f51e8433493b72397ea516a211cf",
                    "0x6d66164539c35b69b7595e06976b11b7426a4dc49d015993a4832a4c4be3fb46",
                    "0x0b4150cf22faa76b95a2ef3af8c840d38aaa985e07fe189ab1a6993343f57027",
                    "0x385876925813fdbb220355cbfe7908db70012ddb7362defbb5088ea098b62179",
                    "0xedfcf2baa869a16448f36f64ea0bb5ada4edd37bc34764216ff46f1aa67107a1",
                    "0xe1111e849f9af31f44aa9147bdf7133e399beefb59b9ecb2a01e83cb8305960c",
                    "0x887ba664e54c664d38775514a3dfac53b956bfe57dec3562da61cdf2ff57f1eb",
                    "0x6c1a201897acc87f668e3b20716679f368ab398f12f639464f99222756c3a632",
                    "0xc8bdd3b8765fdf0cce09e3d2a5a91f9a0993280422f47a151ab26b8ac4076d25",
                    "0x2400d7da25b25a14362655f79568968ec9b775ca6a71d467e710886234bc0c3c",
                    "0x81ef71b94054005dd153af3c683f0686f8904045546b58580bf1236132917ad3",
                    "0x727d7538dab59a4e01ac0bc8c5b14ad4202c5b9a1188a977fe87c676c4d574d4",
                    "0x767ce88beeaa0b173e299a99f8c5ecd581c90c956853d9fa424eeb8f57afe941",
                    "0xe2b2aca334c64ab7622b86231fddd278c1507b065bef59c886fe89a671be0df2",
                    "0xbb09c08e9f0ef6075da1fadc980db9787a0783e666f887203b94544bff785511",
                    "0x423537420bad2078032d4bab5181ebb3796c590751717e5de3ec3618cb3a28b7",
                    "0xf2b8a8919222fb9388a2722bfdae05da0563cc4818f7b006ffc67ed69015d3f5",
                    "0x29080a721dc117acb956a3db54eab1a3b68faa50d3300dda2371c9bee6237fbf",
                    "0xb174e950a6e54bd11967c1f9d743727396661361f59803cd5cf36ef7e42bfc9a",
                    "0x39f5cfb175884f840a3ade24c37660d0d15752f0535b43fe4f2a61956546194a",
                    "0xe85f36364b21a224634044897940bcf5eb3ee66b787badf97a884d1a160af6f0",
                    "0x59623b51c76b9ed41b1cc37652cffbf5143f80f68b89eebfb9a1f69d45ca6602",
                    "0x54f6e85226f1935d959c49166aa48d0456a731a45ae949d3fa08b20f166bf7dd",
                    "0x833805f844116948d51bd61dd1e0b0734b3ee3a13c94e44f49b132e52a6855cc",
                    "0x05038cb898657cb8aa8ab555fb313d7a2f57bb2c8da7bba07213c09388020695",
                    "0x6bf89e579d61014c1c37c3c097c605956946569e7b06d399d65146659b5db95a",
                ],
                "transactionsRoot": "0x048591ccd0c07e9587e13894615ea6b164919107b65406a1ac657d78f720d34c",
                "uncles": [],
                "withdrawals": [
                    {
                        "index": "0x566b44b",
                        "validatorIndex": "0x1a6f3f",
                        "address": "0x12a46563ab9acfa39116b82f14fe7b8296ebbe44",
                        "amount": "0x11f433e",
                    },
                    {
                        "index": "0x566b44c",
                        "validatorIndex": "0x1a6f40",
                        "address": "0x12a46563ab9acfa39116b82f14fe7b8296ebbe44",
                        "amount": "0x120b90c",
                    },
                    {
                        "index": "0x566b44d",
                        "validatorIndex": "0x1a6f41",
                        "address": "0x12a46563ab9acfa39116b82f14fe7b8296ebbe44",
                        "amount": "0x1208fcb",
                    },
                    {
                        "index": "0x566b44e",
                        "validatorIndex": "0x1a6f42",
                        "address": "0x12a46563ab9acfa39116b82f14fe7b8296ebbe44",
                        "amount": "0x1204eb0",
                    },
                    {
                        "index": "0x566b44f",
                        "validatorIndex": "0x1a6f43",
                        "address": "0x12a46563ab9acfa39116b82f14fe7b8296ebbe44",
                        "amount": "0x120215e",
                    },
                    {
                        "index": "0x566b450",
                        "validatorIndex": "0x1a6f44",
                        "address": "0x4580a1c671834c03485ce672da1ec3b4377215b5",
                        "amount": "0x120f9a0",
                    },
                    {
                        "index": "0x566b451",
                        "validatorIndex": "0x1a6f45",
                        "address": "0x06a17b60ca636f8fd4b352875048c0b8aa57e330",
                        "amount": "0x11fb3aa",
                    },
                    {
                        "index": "0x566b452",
                        "validatorIndex": "0x1a6f47",
                        "address": "0x6be457e04092b28865e0cba84e3b2cfa0f871e67",
                        "amount": "0x1208ffa",
                    },
                    {
                        "index": "0x566b453",
                        "validatorIndex": "0x1a6f48",
                        "address": "0x6be457e04092b28865e0cba84e3b2cfa0f871e67",
                        "amount": "0x3e6b799",
                    },
                    {
                        "index": "0x566b454",
                        "validatorIndex": "0x1a6f49",
                        "address": "0x07f0d1ff18e67b699e8d11e95a1f045c7ccbca79",
                        "amount": "0x120386a",
                    },
                    {
                        "index": "0x566b455",
                        "validatorIndex": "0x1a6f4a",
                        "address": "0x16beb8782c2607fd90ca93f3119cf12c00255c6e",
                        "amount": "0x12085c8",
                    },
                    {
                        "index": "0x566b456",
                        "validatorIndex": "0x1a6f4b",
                        "address": "0x16beb8782c2607fd90ca93f3119cf12c00255c6e",
                        "amount": "0x1205504",
                    },
                    {
                        "index": "0x566b457",
                        "validatorIndex": "0x1a6f4c",
                        "address": "0x16beb8782c2607fd90ca93f3119cf12c00255c6e",
                        "amount": "0x1204e46",
                    },
                    {
                        "index": "0x566b458",
                        "validatorIndex": "0x1a6f4d",
                        "address": "0x16beb8782c2607fd90ca93f3119cf12c00255c6e",
                        "amount": "0x120d2eb",
                    },
                    {
                        "index": "0x566b459",
                        "validatorIndex": "0x1a6f4e",
                        "address": "0x16beb8782c2607fd90ca93f3119cf12c00255c6e",
                        "amount": "0x12063c2",
                    },
                    {
                        "index": "0x566b45a",
                        "validatorIndex": "0x1a6f4f",
                        "address": "0x16beb8782c2607fd90ca93f3119cf12c00255c6e",
                        "amount": "0x1207b1c",
                    },
                ],
                "withdrawalsRoot": "0x17871ad54fbc01e04f0559494a4ce066342a15531e3d481c613f918f3f35c20e",
            },
        },
        {
            "jsonrpc": "2.0",
            "id": "BATCH_INBOX_SLOT",
            "result": "0x71ac12829d66ee73d8d95bff50b3589745ce57edae70a3fb111a2342464dc597",
        },
        {
            "jsonrpc": "2.0",
            "id": "DISPUTE_GAME_FACTORY_SLOT",
            "result": "0x52322a25d9f59ea17656545543306b7aef62bc0cc53a0e65ccfa0c75b97aa906",
        },
        {
            "jsonrpc": "2.0",
            "id": "L1_CROSS_DOMAIN_MESSENGER_SLOT",
            "result": "0x383f291819e6d54073bc9a648251d97421076bdd101933c0c022219ce9580636",
        },
        {
            "jsonrpc": "2.0",
            "id": "L1_ERC_721_BRIDGE_SLOT",
            "result": "0x46adcbebc6be8ce551740c29c47c8798210f23f7f4086c41752944352568d5a7",
        },
        {
            "jsonrpc": "2.0",
            "id": "L1_STANDARD_BRIDGE_SLOT",
            "result": "0x9904ba90dde5696cda05c9e0dab5cbaa0fea005ace4d11218a02ac668dad6376",
        },
        {
            "jsonrpc": "2.0",
            "id": "OPTIMISM_MINTABLE_ERC20_FACTORY_SLOT",
            "result": "0xa04c5bb938ca6fc46d95553abf0a76345ce3e722a30bf4f74928b8e7d852320c",
        },
        {
            "jsonrpc": "2.0",
            "id": "OPTIMISM_PORTAL_SLOT",
            "result": "0x4b6c74f9e688cb39801f2112c14a8c57232a3fc5202e1444126d4bce86eb19ac",
        },
        {
            "jsonrpc": "2.0",
            "id": "START_BLOCK_SLOT",
            "result": "0xa11ee3ab75b40e88a0105e935d17cd36c8faee0138320d776c411291bdbbb19f",
        },
        {
            "jsonrpc": "2.0",
            "id": "UNSAFE_BLOCK_SIGNER_SLOT",
            "result": "0x65a7ed542fb37fe237fdfbdd70b31598523fe5b32879e307bae27a0bd9581c08",
        },
        {
            "jsonrpc": "2.0",
            "id": "VERSION",
            "result": "0x0000000000000000000000000000000000000000000000000000000000000000",
        },
        {
            "jsonrpc": "2.0",
            "id": "basefeeScalar",
            "result": "0x000000000000000000000000000000000000000000000000000000000007a120",
        },
        {
            "jsonrpc": "2.0",
            "id": "batchInbox",
            "result": "0x000000000000000000000000fff0000000000000000000000000000000000288",
        },
        {
            "jsonrpc": "2.0",
            "id": "batcherHash",
            "result": "0x000000000000000000000000e1b64045351b0b6e9821f19b39f81bc4711d2230",
        },
        {
            "jsonrpc": "2.0",
            "id": "blobbasefeeScalar",
            "result": "0x00000000000000000000000000000000000000000000000000000000000f79c5",
        },
        {
            "jsonrpc": "2.0",
            "id": "disputeGameFactory",
            "result": "0x0000000000000000000000000000000000000000000000000000000000000000",
        },
        {
            "jsonrpc": "2.0",
            "id": "eip1559Denominator",
            "result": "0x0000000000000000000000000000000000000000000000000000000000000000",
        },
        {
            "jsonrpc": "2.0",
            "id": "eip1559Elasticity",
            "result": "0x0000000000000000000000000000000000000000000000000000000000000000",
        },
        {
            "jsonrpc": "2.0",
            "id": "gasLimit",
            "result": "0x0000000000000000000000000000000000000000000000000000000001c9c380",
        },
        {
            "jsonrpc": "2.0",
            "id": "l1CrossDomainMessenger",
            "result": "0x0000000000000000000000006d4528d192db72e282265d6092f4b872f9dff69e",
        },
        {
            "jsonrpc": "2.0",
            "id": "l1ERC721Bridge",
            "result": "0x000000000000000000000000a6ad22bb0e73def40a24e510cfbc93807d8bf87e",
        },
        {
            "jsonrpc": "2.0",
            "id": "l1StandardBridge",
            "result": "0x000000000000000000000000dc1664458d2f0b6090bea60a8793a4e66c2f1c00",
        },
        {
            "jsonrpc": "2.0",
            "id": "maximumGasLimit",
            "result": "0x000000000000000000000000000000000000000000000000000000000bebc200",
        },
        {
            "jsonrpc": "2.0",
            "id": "minimumGasLimit",
            "result": "0x0000000000000000000000000000000000000000000000000000000001406f40",
        },
        {
            "jsonrpc": "2.0",
            "id": "operatorFeeConstant",
            "error": {"code": -32000, "message": "execution reverted"},
        },
        {
            "jsonrpc": "2.0",
            "id": "operatorFeeScalar",
            "error": {"code": -32000, "message": "execution reverted"},
        },
        {
            "jsonrpc": "2.0",
            "id": "optimismMintableERC20Factory",
            "result": "0x0000000000000000000000004d898f66327fa050131a17ed17a39ebecc81f0c3",
        },
        {
            "jsonrpc": "2.0",
            "id": "optimismPortal",
            "result": "0x0000000000000000000000007b02d13904d8e6e0f0efaf756ab14cb0ff21ee7e",
        },
        {
            "jsonrpc": "2.0",
            "id": "overhead",
            "result": "0x0000000000000000000000000000000000000000000000000000000000000834",
        },
        {
            "jsonrpc": "2.0",
            "id": "owner",
            "result": "0x00000000000000000000000056121a8612474c3eb65d69a3b871f284705b9bc4",
        },
        {
            "jsonrpc": "2.0",
            "id": "scalar",
            "result": "0x010000000000000000000000000000000000000000000000000f79c50007a120",
        },
        {
            "jsonrpc": "2.0",
            "id": "startBlock",
            "result": "0x00000000000000000000000000000000000000000000000000000000012c26f2",
        },
        {
            "jsonrpc": "2.0",
            "id": "unsafeBlockSigner",
            "result": "0x0000000000000000000000004ac69842680847e1135f514ee3d75172b685ecbf",
        },
        {
            "jsonrpc": "2.0",
            "id": "version",
            "result": "0x0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000c322e332e302d626574612e350000000000000000000000000000000000000000",
        },
    ]
    dummy = RPCManager(system_config_proxy="0x158Fd5715F16Ac1F2Dc959A299B383aAaf9B59EB")
    actual = SystemConfigMetadata.of(dummy, response)

    assert actual == SystemConfigMetadata(
        contract_address="0x158Fd5715F16Ac1F2Dc959A299B383aAaf9B59EB",
        block_number=22698518,
        block_timestamp=1749852479,
        batch_inbox_slot="0x71ac12829d66ee73d8d95bff50b3589745ce57edae70a3fb111a2342464dc597",
        dispute_game_factory_slot="0x52322a25d9f59ea17656545543306b7aef62bc0cc53a0e65ccfa0c75b97aa906",
        l1_cross_domain_messenger_slot="0x383f291819e6d54073bc9a648251d97421076bdd101933c0c022219ce9580636",
        l1_erc721_bridge_slot="0x46adcbebc6be8ce551740c29c47c8798210f23f7f4086c41752944352568d5a7",
        l1_standard_bridge_slot="0x9904ba90dde5696cda05c9e0dab5cbaa0fea005ace4d11218a02ac668dad6376",
        optimism_mintable_erc20_factory_slot="0xa04c5bb938ca6fc46d95553abf0a76345ce3e722a30bf4f74928b8e7d852320c",
        optimism_portal_slot="0x4b6c74f9e688cb39801f2112c14a8c57232a3fc5202e1444126d4bce86eb19ac",
        start_block_slot="0xa11ee3ab75b40e88a0105e935d17cd36c8faee0138320d776c411291bdbbb19f",
        unsafe_block_signer_slot="0x65a7ed542fb37fe237fdfbdd70b31598523fe5b32879e307bae27a0bd9581c08",
        version=0,
        basefee_scalar=500000,
        batch_inbox="0xfff0000000000000000000000000000000000288",
        batcher_hash="0x000000000000000000000000e1b64045351b0b6e9821f19b39f81bc4711d2230",
        blob_basefee_scalar=1014213,
        dispute_game_factory="0x0000000000000000000000000000000000000000",
        eip1559_denominator=0,
        eip1559_elasticity=0,
        gas_limit=30000000,
        l1_cross_domain_messenger="0x6d4528d192db72e282265d6092f4b872f9dff69e",
        l1_erc721_bridge="0xa6ad22bb0e73def40a24e510cfbc93807d8bf87e",
        l1_standard_bridge="0xdc1664458d2f0b6090bea60a8793a4e66c2f1c00",
        maximum_gas_limit=200000000,
        minimum_gas_limit=21000000,
        operator_fee_constant=None,
        operator_fee_scalar=None,
        optimism_mintable_erc20_factory="0x4d898f66327fa050131a17ed17a39ebecc81f0c3",
        optimism_portal="0x7b02d13904d8e6e0f0efaf756ab14cb0ff21ee7e",
        overhead=2100,
        owner="0x56121a8612474c3eb65d69a3b871f284705b9bc4",
        scalar=452312848583266388373324160190187140051835877600158453279135543542577340704,
        start_block="0x00000000000000000000000000000000012c26f2",
        unsafe_block_signer="0x4ac69842680847e1135f514ee3d75172b685ecbf",
        version_hex="2.3.0-beta.5",
    )


def test_decode():
    assert (
        decode("uint256", "0x0000000000000000000000000000000000000000000000000000000000000834")
        == 2100
    )
    # Test with different types
    assert (
        decode("uint32", "0x0000000000000000000000000000000000000000000000000000000000000001") == 1
    )
    assert (
        decode("uint64", "0x0000000000000000000000000000000000000000000000000000000000000002") == 2
    )
    # Test with invalid input
    with pytest.raises(Exception):
        decode("invalid_type", "0x00")


def test_decode_string_from_abi():
    assert (
        decode_string_from_abi(
            "0x00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000005322e352e30000000000000000000000000000000000000000000000000000000"
        )
        == "2.5.0"
    )
    # Test with invalid input
    with pytest.raises(Exception):
        decode_string_from_abi("invalid_hex")
