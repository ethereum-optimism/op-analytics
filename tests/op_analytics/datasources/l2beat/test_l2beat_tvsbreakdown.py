from op_analytics.datasources.l2beat.tvsbreakdown import parse_tvs, clean_dataframe
from op_analytics.datasources.l2beat.utils import L2BeatProject


def test_parse_tvs_empty():
    response_data = {
        "success": True,
        "data": {
            "dataTimestamp": 1744124400,
            "breakdown": {"canonical": [], "native": [], "external": []},
        },
    }
    actual = parse_tvs(response_data, L2BeatProject(id="funki", slug="funki"))
    assert actual == []


def test_parse_tvs_funki():
    # https://l2beat.com/api/scaling/tvs/funki/breakdown
    response_data = {
        "success": True,
        "data": {
            "dataTimestamp": 1744124400,
            "breakdown": {
                "canonical": [
                    {
                        "assetId": "ethereum-0x9F52c8ecbEe10e00D9faaAc5Ee9Ba0fF6550F511",
                        "chain": {"name": "ethereum", "id": 1},
                        "amount": 9419186.975963663,
                        "usdValue": 416047.46675758,
                        "usdPrice": "0.04417021",
                        "isGasToken": False,
                        "tokenAddress": "0x9F52c8ecbEe10e00D9faaAc5Ee9Ba0fF6550F511",
                        "escrows": [
                            {
                                "amount": 9419186.975963663,
                                "usdValue": 416047.46675758,
                                "escrowAddress": "0xA2C1C1A473250094a6244F2bcf6Cb51F670Ad3aC",
                                "name": "L1StandardBridge",
                                "isSharedEscrow": False,
                                "url": "https://etherscan.io/address/0xA2C1C1A473250094a6244F2bcf6Cb51F670Ad3aC",
                            }
                        ],
                        "iconUrl": "https://coin-images.coingecko.com/coins/images/21070/large/SipherToken.png?1696520453",
                        "symbol": "SIPHER",
                        "name": "Sipher Token",
                        "url": "https://etherscan.io/address/0x9F52c8ecbEe10e00D9faaAc5Ee9Ba0fF6550F511",
                        "supply": "zero",
                    },
                    {
                        "assetId": "ethereum-native",
                        "chain": {"name": "ethereum", "id": 1},
                        "amount": 72.52974917119296,
                        "usdValue": 111459.32322348957,
                        "usdPrice": "1536.7394",
                        "isGasToken": True,
                        "escrows": [
                            {
                                "amount": 72.52974917119296,
                                "usdValue": 111459.32322348957,
                                "escrowAddress": "0x5C9C7f98eD153a2deAA981eB5C97B31744AccF22",
                                "name": "OptimismPortal",
                                "isSharedEscrow": False,
                                "url": "https://etherscan.io/address/0x5C9C7f98eD153a2deAA981eB5C97B31744AccF22",
                            }
                        ],
                        "iconUrl": "https://assets.coingecko.com/coins/images/279/large/ethereum.png?1595348880",
                        "symbol": "ETH",
                        "name": "Ether",
                        "supply": "zero",
                    },
                    {
                        "assetId": "ethereum-0xdAC17F958D2ee523a2206206994597C13D831ec7",
                        "chain": {"name": "ethereum", "id": 1},
                        "amount": 47.307409,
                        "usdValue": 47.2901843723831,
                        "usdPrice": "0.9996359",
                        "isGasToken": False,
                        "tokenAddress": "0xdAC17F958D2ee523a2206206994597C13D831ec7",
                        "escrows": [
                            {
                                "amount": 47.307409,
                                "usdValue": 47.2901843723831,
                                "escrowAddress": "0xA2C1C1A473250094a6244F2bcf6Cb51F670Ad3aC",
                                "name": "L1StandardBridge",
                                "isSharedEscrow": False,
                                "url": "https://etherscan.io/address/0xA2C1C1A473250094a6244F2bcf6Cb51F670Ad3aC",
                            }
                        ],
                        "iconUrl": "https://assets.coingecko.com/coins/images/325/large/Tether.png?1696501661",
                        "symbol": "USDT",
                        "name": "Tether USD",
                        "url": "https://etherscan.io/address/0xdAC17F958D2ee523a2206206994597C13D831ec7",
                        "supply": "zero",
                    },
                    {
                        "assetId": "ethereum-0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
                        "chain": {"name": "ethereum", "id": 1},
                        "amount": 19.1,
                        "usdValue": 19.098713615,
                        "usdPrice": "0.99993265",
                        "isGasToken": False,
                        "tokenAddress": "0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
                        "escrows": [
                            {
                                "amount": 19.1,
                                "usdValue": 19.098713615,
                                "escrowAddress": "0xA2C1C1A473250094a6244F2bcf6Cb51F670Ad3aC",
                                "name": "L1StandardBridge",
                                "isSharedEscrow": False,
                                "url": "https://etherscan.io/address/0xA2C1C1A473250094a6244F2bcf6Cb51F670Ad3aC",
                            }
                        ],
                        "iconUrl": "https://assets.coingecko.com/coins/images/6319/large/usdc.png?1696506694",
                        "symbol": "USDC",
                        "name": "USD Coin",
                        "url": "https://etherscan.io/address/0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
                        "supply": "zero",
                    },
                ],
                "native": [],
                "external": [],
            },
        },
    }

    actual = clean_dataframe(
        parse_tvs(response_data, L2BeatProject(id="funki", slug="funki"))
    ).to_dicts()
    assert actual == [
        {
            "dt": "2025-04-08",
            "project_id": "funki",
            "project_slug": "funki",
            "timestamp": 1744124400,
            "asset_id": "ethereum-0x9F52c8ecbEe10e00D9faaAc5Ee9Ba0fF6550F511",
            "chain_name": "ethereum",
            "chain_id": 1,
            "amount": 9419186.975963663,
            "usd_value": 416047.46675758,
            "usd_price": 0.04417021,
            "is_gas_token": False,
            "token_address": "0x9f52c8ecbee10e00d9faaac5ee9ba0ff6550f511",
            "escrow_address": "0xa2c1c1a473250094a6244f2bcf6cb51f670ad3ac",
            "escrow_name": "L1StandardBridge",
            "is_shared_escrow": False,
            "escrow_url": "https://etherscan.io/address/0xA2C1C1A473250094a6244F2bcf6Cb51F670Ad3aC",
            "asset_url": "https://etherscan.io/address/0x9F52c8ecbEe10e00D9faaAc5Ee9Ba0fF6550F511",
            "icon_url": "https://coin-images.coingecko.com/coins/images/21070/large/SipherToken.png?1696520453",
            "symbol": "SIPHER",
            "name": "Sipher Token",
            "supply": "zero",
            "category": "canonical",
        },
        {
            "dt": "2025-04-08",
            "project_id": "funki",
            "project_slug": "funki",
            "timestamp": 1744124400,
            "asset_id": "ethereum-native",
            "chain_name": "ethereum",
            "chain_id": 1,
            "amount": 72.52974917119296,
            "usd_value": 111459.32322348957,
            "usd_price": 1536.7394,
            "is_gas_token": True,
            "token_address": None,
            "escrow_address": "0x5c9c7f98ed153a2deaa981eb5c97b31744accf22",
            "escrow_name": "OptimismPortal",
            "is_shared_escrow": False,
            "escrow_url": "https://etherscan.io/address/0x5C9C7f98eD153a2deAA981eB5C97B31744AccF22",
            "asset_url": None,
            "icon_url": "https://assets.coingecko.com/coins/images/279/large/ethereum.png?1595348880",
            "symbol": "ETH",
            "name": "Ether",
            "supply": "zero",
            "category": "canonical",
        },
        {
            "dt": "2025-04-08",
            "project_id": "funki",
            "project_slug": "funki",
            "timestamp": 1744124400,
            "asset_id": "ethereum-0xdAC17F958D2ee523a2206206994597C13D831ec7",
            "chain_name": "ethereum",
            "chain_id": 1,
            "amount": 47.307409,
            "usd_value": 47.2901843723831,
            "usd_price": 0.9996359,
            "is_gas_token": False,
            "token_address": "0xdac17f958d2ee523a2206206994597c13d831ec7",
            "escrow_address": "0xa2c1c1a473250094a6244f2bcf6cb51f670ad3ac",
            "escrow_name": "L1StandardBridge",
            "is_shared_escrow": False,
            "escrow_url": "https://etherscan.io/address/0xA2C1C1A473250094a6244F2bcf6Cb51F670Ad3aC",
            "asset_url": "https://etherscan.io/address/0xdAC17F958D2ee523a2206206994597C13D831ec7",
            "icon_url": "https://assets.coingecko.com/coins/images/325/large/Tether.png?1696501661",
            "symbol": "USDT",
            "name": "Tether USD",
            "supply": "zero",
            "category": "canonical",
        },
        {
            "dt": "2025-04-08",
            "project_id": "funki",
            "project_slug": "funki",
            "timestamp": 1744124400,
            "asset_id": "ethereum-0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
            "chain_name": "ethereum",
            "chain_id": 1,
            "amount": 19.1,
            "usd_value": 19.098713615,
            "usd_price": 0.99993265,
            "is_gas_token": False,
            "token_address": "0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48",
            "escrow_address": "0xa2c1c1a473250094a6244f2bcf6cb51f670ad3ac",
            "escrow_name": "L1StandardBridge",
            "is_shared_escrow": False,
            "escrow_url": "https://etherscan.io/address/0xA2C1C1A473250094a6244F2bcf6Cb51F670Ad3aC",
            "asset_url": "https://etherscan.io/address/0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",
            "icon_url": "https://assets.coingecko.com/coins/images/6319/large/usdc.png?1696506694",
            "symbol": "USDC",
            "name": "USD Coin",
            "supply": "zero",
            "category": "canonical",
        },
    ]


def test_parse_tvs_zkfair():
    # https://l2beat.com/api/scaling/tvs/zkfair/breakdown
    response_data = {
        "success": True,
        "data": {
            "dataTimestamp": 1744124400,
            "breakdown": {
                "canonical": [
                    {
                        "assetId": "ethereum-0xe4815AE53B124e7263F08dcDBBB757d41Ed658c6",
                        "chain": {"name": "ethereum", "id": 1},
                        "amount": 11547.4375,
                        "usdValue": 29.096637164725003,
                        "usdPrice": "0.0025197484",
                        "tokenAddress": "0xe4815AE53B124e7263F08dcDBBB757d41Ed658c6",
                        "escrows": [
                            {
                                "amount": 11547.4375,
                                "usdValue": 29.096637164725003,
                                "escrowAddress": "0x9cb4706e20A18E59a48ffa7616d700A3891e1861",
                                "name": "Bridge",
                                "isSharedEscrow": False,
                                "url": "https://etherscan.io/address/0x9cb4706e20A18E59a48ffa7616d700A3891e1861",
                            }
                        ],
                        "iconUrl": "https://assets.coingecko.com/coins/images/13585/large/image_2024-01-16_172847810.png?1705397359",
                        "symbol": "ZKS",
                        "name": "Zks",
                        "url": "https://etherscan.io/address/0xe4815AE53B124e7263F08dcDBBB757d41Ed658c6",
                        "supply": "zero",
                    }
                ],
                "native": [
                    {
                        "assetId": "zkfair-0x1cD3E2A23C45A690a18Ed93FD1412543f464158F",
                        "chain": {"name": "zkfair", "id": 42766},
                        "amount": 9886400000,
                        "usdValue": 832179.2176959999,
                        "usdPrice": "0.00008417414",
                        "tokenAddress": "0x1cD3E2A23C45A690a18Ed93FD1412543f464158F",
                        "iconUrl": "https://assets.coingecko.com/coins/images/34288/large/r8A3J3kf_400x400.jpg?1704455147",
                        "symbol": "ZKF",
                        "name": "ZKF",
                        "url": "https://scan.zkfair.io/address/0x1cD3E2A23C45A690a18Ed93FD1412543f464158F",
                        "supply": "circulatingSupply",
                    }
                ],
                "external": [],
            },
        },
    }

    actual = clean_dataframe(
        parse_tvs(response_data, L2BeatProject(id="funki", slug="funki"))
    ).to_dicts()
    assert actual == [
        {
            "dt": "2025-04-08",
            "project_id": "funki",
            "project_slug": "funki",
            "timestamp": 1744124400,
            "asset_id": "ethereum-0xe4815AE53B124e7263F08dcDBBB757d41Ed658c6",
            "chain_name": "ethereum",
            "chain_id": 1,
            "amount": 11547.4375,
            "usd_value": 29.096637164725003,
            "usd_price": 0.0025197484,
            "is_gas_token": None,
            "token_address": "0xe4815ae53b124e7263f08dcdbbb757d41ed658c6",
            "escrow_address": "0x9cb4706e20a18e59a48ffa7616d700a3891e1861",
            "escrow_name": "Bridge",
            "is_shared_escrow": False,
            "escrow_url": "https://etherscan.io/address/0x9cb4706e20A18E59a48ffa7616d700A3891e1861",
            "asset_url": "https://etherscan.io/address/0xe4815AE53B124e7263F08dcDBBB757d41Ed658c6",
            "icon_url": "https://assets.coingecko.com/coins/images/13585/large/image_2024-01-16_172847810.png?1705397359",
            "symbol": "ZKS",
            "name": "Zks",
            "supply": "zero",
            "category": "canonical",
        },
        {
            "dt": "2025-04-08",
            "project_id": "funki",
            "project_slug": "funki",
            "timestamp": 1744124400,
            "asset_id": "zkfair-0x1cD3E2A23C45A690a18Ed93FD1412543f464158F",
            "chain_name": "zkfair",
            "chain_id": 42766,
            "amount": 9886400000.0,
            "usd_value": 832179.2176959999,
            "usd_price": 8.417414e-05,
            "is_gas_token": None,
            "token_address": "0x1cd3e2a23c45a690a18ed93fd1412543f464158f",
            "escrow_address": None,
            "escrow_name": None,
            "is_shared_escrow": None,
            "escrow_url": None,
            "asset_url": "https://scan.zkfair.io/address/0x1cD3E2A23C45A690a18Ed93FD1412543f464158F",
            "icon_url": "https://assets.coingecko.com/coins/images/34288/large/r8A3J3kf_400x400.jpg?1704455147",
            "symbol": "ZKF",
            "name": "ZKF",
            "supply": "circulatingSupply",
            "category": "native",
        },
    ]


def test_parse_tvs_zkfair_with_updated_l2beat_json():
    # https://l2beat.com/api/scaling/tvs/zkfair/breakdown
    response_data = {
        "success": True,
        "data": {
            "dataTimestamp": 1745323200,
            "breakdown": {
                "canonical": [
                    {
                        "mode": "auto",
                        "id": "zkfair-ZKS",
                        "priceId": "zkspace",
                        "symbol": "ZKS",
                        "name": "Zks",
                        "iconUrl": "https://assets.coingecko.com/coins/images/13585/large/image_2024-01-16_172847810.png?1705397359",
                        "amount": 11547.44,
                        "category": "other",
                        "source": "canonical",
                        "isAssociated": False,
                        "address": {
                            "address": "0xe4815AE53B124e7263F08dcDBBB757d41Ed658c6",
                            "url": "https://etherscan.io/address/0xe4815AE53B124e7263F08dcDBBB757d41Ed658c6",
                        },
                        "formula": {
                            "type": "balanceOfEscrow",
                            "chain": "ethereum",
                            "sinceTimestamp": 1702879283,
                            "address": "0xe4815AE53B124e7263F08dcDBBB757d41Ed658c6",
                            "decimals": 18,
                            "escrowAddress": "0x9cb4706e20A18E59a48ffa7616d700A3891e1861",
                        },
                        "usdValue": 18.08,
                        "escrow": {
                            "address": "0x9cb4706e20A18E59a48ffa7616d700A3891e1861",
                            "url": "https://etherscan.io/address/0x9cb4706e20A18E59a48ffa7616d700A3891e1861",
                            "name": "OldBridge",
                        },
                    }
                ],
                "external": [],
                "native": [
                    {
                        "mode": "auto",
                        "id": "zkfair-ZKF",
                        "priceId": "zkfair",
                        "symbol": "ZKF",
                        "name": "ZKF",
                        "iconUrl": "https://assets.coingecko.com/coins/images/34288/large/r8A3J3kf_400x400.jpg?1704455147",
                        "amount": 9923400000,
                        "category": "other",
                        "source": "native",
                        "isAssociated": True,
                        "address": {
                            "address": "0x1cD3E2A23C45A690a18Ed93FD1412543f464158F",
                            "url": "https://scan.zkfair.io/address/0x1cD3E2A23C45A690a18Ed93FD1412543f464158F",
                        },
                        "formula": {
                            "type": "circulatingSupply",
                            "sinceTimestamp": 1704412800,
                            "apiId": "zkfair",
                            "decimals": 18,
                            "address": "0x1cD3E2A23C45A690a18Ed93FD1412543f464158F",
                            "chain": "zkfair",
                        },
                        "usdValue": 538376.7,
                    }
                ],
            },
        },
    }

    actual = clean_dataframe(
        parse_tvs(response_data, L2BeatProject(id="funki", slug="funki"))
    ).to_dicts()
    assert actual == [
        {
            "dt": "2025-04-22",
            "project_id": "funki",
            "project_slug": "funki",
            "timestamp": 1745323200,
            "asset_id": "zkfair-ZKS",
            "chain_name": "ethereum",
            "chain_id": None,
            "amount": 11547.44,
            "usd_value": 18.08,
            "usd_price": None,
            "is_gas_token": None,
            "token_address": "0xe4815ae53b124e7263f08dcdbbb757d41ed658c6",
            "escrow_address": "0x9cb4706e20a18e59a48ffa7616d700a3891e1861",
            "escrow_name": "OldBridge",
            "is_shared_escrow": None,
            "escrow_url": "https://etherscan.io/address/0x9cb4706e20A18E59a48ffa7616d700A3891e1861",
            "asset_url": "https://etherscan.io/address/0xe4815AE53B124e7263F08dcDBBB757d41Ed658c6",
            "icon_url": "https://assets.coingecko.com/coins/images/13585/large/image_2024-01-16_172847810.png?1705397359",
            "symbol": "ZKS",
            "name": "Zks",
            "supply": None,
            "category": "canonical",
        },
        {
            "dt": "2025-04-22",
            "project_id": "funki",
            "project_slug": "funki",
            "timestamp": 1745323200,
            "asset_id": "zkfair-ZKF",
            "chain_name": "zkfair",
            "chain_id": None,
            "amount": 9923400000.0,
            "usd_value": 538376.7,
            "usd_price": None,
            "is_gas_token": None,
            "token_address": "0x1cd3e2a23c45a690a18ed93fd1412543f464158f",
            "escrow_address": None,
            "escrow_name": None,
            "is_shared_escrow": None,
            "escrow_url": None,
            "asset_url": "https://scan.zkfair.io/address/0x1cD3E2A23C45A690a18Ed93FD1412543f464158F",
            "icon_url": "https://assets.coingecko.com/coins/images/34288/large/r8A3J3kf_400x400.jpg?1704455147",
            "symbol": "ZKF",
            "name": "ZKF",
            "supply": None,
            "category": "native",
        },
    ]


def test_parse_tvs_unichain_with_updated_l2beat_json():
    # https://l2beat.com/api/scaling/tvs/unichain/breakdown
    response_data = {
        "success": True,
        "data": {
            "dataTimestamp": 1745578800,
            "breakdown": {
                "canonical": [
                    {
                        "mode": "auto",
                        "id": "unichain-ETH",
                        "priceId": "ethereum",
                        "symbol": "ETH",
                        "name": "Ether",
                        "iconUrl": "https://assets.coingecko.com/coins/images/279/large/ethereum.png?1595348880",
                        "amount": 113967.52,
                        "category": "ether",
                        "source": "canonical",
                        "isAssociated": False,
                        "formula": {
                            "type": "calculation",
                            "operator": "sum",
                            "arguments": [
                                {
                                    "type": "balanceOfEscrow",
                                    "chain": "ethereum",
                                    "sinceTimestamp": 1730748203,
                                    "address": "native",
                                    "decimals": 18,
                                    "escrowAddress": "0x0bd48f6B86a26D3a217d0Fa6FfE2B491B956A7a2",
                                },
                                {
                                    "type": "balanceOfEscrow",
                                    "chain": "ethereum",
                                    "sinceTimestamp": 1730748227,
                                    "address": "native",
                                    "decimals": 18,
                                    "escrowAddress": "0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                                },
                            ],
                        },
                        "usdValue": 202157200,
                        "isGasToken": True,
                        "escrow": "multiple",
                    },
                    {
                        "mode": "auto",
                        "id": "unichain-WBTC",
                        "priceId": "wrapped-bitcoin",
                        "symbol": "WBTC",
                        "name": "Wrapped BTC",
                        "iconUrl": "https://assets.coingecko.com/coins/images/7598/large/wrapped_bitcoin_wbtc.png?1696507857",
                        "amount": 352.62,
                        "category": "other",
                        "source": "canonical",
                        "isAssociated": False,
                        "address": {
                            "address": "0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599",
                            "url": "https://etherscan.io/address/0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599",
                        },
                        "formula": {
                            "type": "balanceOfEscrow",
                            "chain": "ethereum",
                            "sinceTimestamp": 1730748227,
                            "address": "0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599",
                            "decimals": 8,
                            "escrowAddress": "0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                        },
                        "usdValue": 33032418,
                        "isGasToken": False,
                        "escrow": {
                            "address": "0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                            "url": "https://etherscan.io/address/0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                            "name": "L1StandardBridge",
                        },
                    },
                    {
                        "mode": "auto",
                        "id": "unichain-UNI",
                        "priceId": "uniswap",
                        "symbol": "UNI",
                        "name": "Uniswap",
                        "iconUrl": "https://assets.coingecko.com/coins/images/12504/large/uni.jpg?1696512319",
                        "amount": 1339715.1,
                        "category": "other",
                        "source": "canonical",
                        "isAssociated": True,
                        "address": {
                            "address": "0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984",
                            "url": "https://etherscan.io/address/0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984",
                        },
                        "formula": {
                            "type": "balanceOfEscrow",
                            "chain": "ethereum",
                            "sinceTimestamp": 1730748227,
                            "address": "0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984",
                            "decimals": 18,
                            "escrowAddress": "0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                        },
                        "usdValue": 7810013,
                        "isGasToken": False,
                        "escrow": {
                            "address": "0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                            "url": "https://etherscan.io/address/0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                            "name": "L1StandardBridge",
                        },
                    },
                    {
                        "mode": "auto",
                        "id": "unichain-COMP",
                        "priceId": "compound-governance-token",
                        "symbol": "COMP",
                        "name": "Compound",
                        "iconUrl": "https://assets.coingecko.com/coins/images/10775/large/COMP.png?1696510737",
                        "amount": 99093.86,
                        "category": "other",
                        "source": "canonical",
                        "isAssociated": False,
                        "address": {
                            "address": "0xc00e94Cb662C3520282E6f5717214004A7f26888",
                            "url": "https://etherscan.io/address/0xc00e94Cb662C3520282E6f5717214004A7f26888",
                        },
                        "formula": {
                            "type": "balanceOfEscrow",
                            "chain": "ethereum",
                            "sinceTimestamp": 1730748227,
                            "address": "0xc00e94Cb662C3520282E6f5717214004A7f26888",
                            "decimals": 18,
                            "escrowAddress": "0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                        },
                        "usdValue": 4359694.5,
                        "isGasToken": False,
                        "escrow": {
                            "address": "0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                            "url": "https://etherscan.io/address/0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                            "name": "L1StandardBridge",
                        },
                    },
                    {
                        "mode": "auto",
                        "id": "unichain-USDT",
                        "priceId": "tether",
                        "symbol": "USDT",
                        "name": "Tether USD",
                        "iconUrl": "https://assets.coingecko.com/coins/images/325/large/Tether.png?1696501661",
                        "amount": 2827899.2,
                        "category": "stablecoin",
                        "source": "canonical",
                        "isAssociated": False,
                        "address": {
                            "address": "0xdAC17F958D2ee523a2206206994597C13D831ec7",
                            "url": "https://etherscan.io/address/0xdAC17F958D2ee523a2206206994597C13D831ec7",
                        },
                        "formula": {
                            "type": "balanceOfEscrow",
                            "chain": "ethereum",
                            "sinceTimestamp": 1730748227,
                            "address": "0xdAC17F958D2ee523a2206206994597C13D831ec7",
                            "decimals": 6,
                            "escrowAddress": "0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                        },
                        "usdValue": 2828759.5,
                        "isGasToken": False,
                        "escrow": {
                            "address": "0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                            "url": "https://etherscan.io/address/0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                            "name": "L1StandardBridge",
                        },
                    },
                    {
                        "mode": "auto",
                        "id": "unichain-LINK",
                        "priceId": "chainlink",
                        "symbol": "LINK",
                        "name": "ChainLink Token",
                        "iconUrl": "https://assets.coingecko.com/coins/images/877/large/chainlink-new-logo.png?1696502009",
                        "amount": 3015.38,
                        "category": "other",
                        "source": "canonical",
                        "isAssociated": False,
                        "address": {
                            "address": "0x514910771AF9Ca656af840dff83E8264EcF986CA",
                            "url": "https://etherscan.io/address/0x514910771AF9Ca656af840dff83E8264EcF986CA",
                        },
                        "formula": {
                            "type": "balanceOfEscrow",
                            "chain": "ethereum",
                            "sinceTimestamp": 1730748227,
                            "address": "0x514910771AF9Ca656af840dff83E8264EcF986CA",
                            "decimals": 18,
                            "escrowAddress": "0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                        },
                        "usdValue": 45384.84,
                        "isGasToken": False,
                        "escrow": {
                            "address": "0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                            "url": "https://etherscan.io/address/0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                            "name": "L1StandardBridge",
                        },
                    },
                    {
                        "mode": "auto",
                        "id": "unichain-DAI",
                        "priceId": "dai",
                        "symbol": "DAI",
                        "name": "Dai Stablecoin",
                        "iconUrl": "https://assets.coingecko.com/coins/images/9956/large/Badge_Dai.png?1696509996",
                        "amount": 32400.75,
                        "category": "stablecoin",
                        "source": "canonical",
                        "isAssociated": False,
                        "address": {
                            "address": "0x6B175474E89094C44Da98b954EedeAC495271d0F",
                            "url": "https://etherscan.io/address/0x6B175474E89094C44Da98b954EedeAC495271d0F",
                        },
                        "formula": {
                            "type": "balanceOfEscrow",
                            "chain": "ethereum",
                            "sinceTimestamp": 1730748227,
                            "address": "0x6B175474E89094C44Da98b954EedeAC495271d0F",
                            "decimals": 18,
                            "escrowAddress": "0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                        },
                        "usdValue": 32391.03,
                        "isGasToken": False,
                        "escrow": {
                            "address": "0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                            "url": "https://etherscan.io/address/0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                            "name": "L1StandardBridge",
                        },
                    },
                    {
                        "mode": "auto",
                        "id": "unichain-WETH",
                        "priceId": "weth",
                        "symbol": "WETH",
                        "name": "Wrapped Ether",
                        "iconUrl": "https://assets.coingecko.com/coins/images/2518/large/weth.png?1696503332",
                        "amount": 0.12,
                        "category": "ether",
                        "source": "canonical",
                        "isAssociated": False,
                        "address": {
                            "address": "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
                            "url": "https://etherscan.io/address/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
                        },
                        "formula": {
                            "type": "balanceOfEscrow",
                            "chain": "ethereum",
                            "sinceTimestamp": 1730748227,
                            "address": "0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
                            "decimals": 18,
                            "escrowAddress": "0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                        },
                        "usdValue": 214.89,
                        "isGasToken": False,
                        "escrow": {
                            "address": "0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                            "url": "https://etherscan.io/address/0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                            "name": "L1StandardBridge",
                        },
                    },
                    {
                        "mode": "auto",
                        "id": "unichain-ENS",
                        "priceId": "ethereum-name-service",
                        "symbol": "ENS",
                        "name": "Ethereum Name Service",
                        "iconUrl": "https://assets.coingecko.com/coins/images/19785/large/acatxTm8_400x400.jpg?1696519207",
                        "amount": 0.05,
                        "category": "other",
                        "source": "canonical",
                        "isAssociated": False,
                        "address": {
                            "address": "0xC18360217D8F7Ab5e7c516566761Ea12Ce7F9D72",
                            "url": "https://etherscan.io/address/0xC18360217D8F7Ab5e7c516566761Ea12Ce7F9D72",
                        },
                        "formula": {
                            "type": "balanceOfEscrow",
                            "chain": "ethereum",
                            "sinceTimestamp": 1730748227,
                            "address": "0xC18360217D8F7Ab5e7c516566761Ea12Ce7F9D72",
                            "decimals": 18,
                            "escrowAddress": "0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                        },
                        "usdValue": 0.86,
                        "isGasToken": False,
                        "escrow": {
                            "address": "0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                            "url": "https://etherscan.io/address/0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
                            "name": "L1StandardBridge",
                        },
                    },
                ],
                "external": [
                    {
                        "mode": "auto",
                        "id": "unichain-wstETH-2",
                        "priceId": "wrapped-steth",
                        "symbol": "wstETH",
                        "name": "Wrapped liquid staked Ether 2.0",
                        "iconUrl": "https://assets.coingecko.com/coins/images/18834/large/wstETH.png?1696518295",
                        "amount": 33828.32,
                        "category": "ether",
                        "source": "external",
                        "isAssociated": False,
                        "address": {
                            "address": "0x7f39C581F595B53c5cb19bD0b3f8dA6c935E2Ca0",
                            "url": "https://etherscan.io/address/0x7f39C581F595B53c5cb19bD0b3f8dA6c935E2Ca0",
                        },
                        "formula": {
                            "type": "balanceOfEscrow",
                            "chain": "ethereum",
                            "sinceTimestamp": 1739519603,
                            "address": "0x7f39C581F595B53c5cb19bD0b3f8dA6c935E2Ca0",
                            "decimals": 18,
                            "escrowAddress": "0x755610f5Be536Ad7afBAa7c10F3E938Ea3aa1877",
                        },
                        "usdValue": 72045040,
                        "isGasToken": False,
                    },
                    {
                        "mode": "auto",
                        "id": "unichain-USD₮0",
                        "priceId": "usdt0",
                        "symbol": "USD₮0",
                        "name": "USD₮0",
                        "iconUrl": "https://coin-images.coingecko.com/coins/images/53705/large/usdt0.jpg?1737086183",
                        "amount": 40949572,
                        "category": "stablecoin",
                        "source": "external",
                        "isAssociated": False,
                        "address": {
                            "address": "0x9151434b16b9763660705744891fA906F660EcC5",
                            "url": "https://uniscan.xyz/address/0x9151434b16b9763660705744891fA906F660EcC5",
                        },
                        "formula": {
                            "type": "totalSupply",
                            "chain": "unichain",
                            "sinceTimestamp": 1741984932,
                            "address": "0x9151434b16b9763660705744891fA906F660EcC5",
                            "decimals": 6,
                        },
                        "usdValue": 40958648,
                        "isGasToken": False,
                    },
                    {
                        "mode": "auto",
                        "id": "unichain-weETH-1",
                        "priceId": "wrapped-eeth",
                        "symbol": "weETH",
                        "name": "Wrapped eETH",
                        "iconUrl": "https://coin-images.coingecko.com/coins/images/33033/large/weETH.png?1701438396",
                        "amount": 15269.02,
                        "category": "ether",
                        "source": "external",
                        "isAssociated": False,
                        "address": {
                            "address": "0x7DCC39B4d1C53CB31e1aBc0e358b43987FEF80f7",
                            "url": "https://uniscan.xyz/address/0x7DCC39B4d1C53CB31e1aBc0e358b43987FEF80f7",
                        },
                        "formula": {
                            "type": "totalSupply",
                            "chain": "unichain",
                            "sinceTimestamp": 1739290250,
                            "address": "0x7DCC39B4d1C53CB31e1aBc0e358b43987FEF80f7",
                            "decimals": 18,
                        },
                        "usdValue": 28887326,
                        "isGasToken": False,
                    },
                    {
                        "mode": "auto",
                        "id": "unichain-rsETH-1",
                        "priceId": "kelp-dao-restaked-eth",
                        "symbol": "rsETH",
                        "name": "KelpDao Restaked ETH",
                        "iconUrl": "https://coin-images.coingecko.com/coins/images/33800/large/Icon___Dark.png?1702991855",
                        "amount": 9154.05,
                        "category": "ether",
                        "source": "external",
                        "isAssociated": False,
                        "address": {
                            "address": "0xc3eACf0612346366Db554C991D7858716db09f58",
                            "url": "https://uniscan.xyz/address/0xc3eACf0612346366Db554C991D7858716db09f58",
                        },
                        "formula": {
                            "type": "totalSupply",
                            "chain": "unichain",
                            "sinceTimestamp": 1743532853,
                            "address": "0xc3eACf0612346366Db554C991D7858716db09f58",
                            "decimals": 18,
                        },
                        "usdValue": 16919968,
                        "isGasToken": False,
                    },
                    {
                        "mode": "auto",
                        "id": "unichain-ezETH-1",
                        "priceId": "renzo-restaked-eth",
                        "symbol": "ezETH",
                        "name": "Renzo Restaked ETH",
                        "iconUrl": "https://coin-images.coingecko.com/coins/images/34753/large/Ezeth_logo_circle.png?1713496404",
                        "amount": 8107.08,
                        "category": "ether",
                        "source": "external",
                        "isAssociated": False,
                        "address": {
                            "address": "0x2416092f143378750bb29b79eD961ab195CcEea5",
                            "url": "https://uniscan.xyz/address/0x2416092f143378750bb29b79eD961ab195CcEea5",
                        },
                        "formula": {
                            "type": "totalSupply",
                            "chain": "unichain",
                            "sinceTimestamp": 1738851274,
                            "address": "0x2416092f143378750bb29b79eD961ab195CcEea5",
                            "decimals": 18,
                        },
                        "usdValue": 15048706,
                        "isGasToken": False,
                    },
                ],
                "native": [
                    {
                        "mode": "auto",
                        "id": "unichain-USDC",
                        "priceId": "usd-coin",
                        "symbol": "USDC",
                        "name": "USDC",
                        "iconUrl": "https://coin-images.coingecko.com/coins/images/6319/large/usdc.png?1696506694",
                        "amount": 127459750,
                        "category": "stablecoin",
                        "source": "native",
                        "isAssociated": False,
                        "address": {
                            "address": "0x078D782b760474a361dDA0AF3839290b0EF57AD6",
                            "url": "https://uniscan.xyz/address/0x078D782b760474a361dDA0AF3839290b0EF57AD6",
                        },
                        "formula": {
                            "type": "totalSupply",
                            "chain": "unichain",
                            "sinceTimestamp": 1730847151,
                            "address": "0x078D782b760474a361dDA0AF3839290b0EF57AD6",
                            "decimals": 6,
                        },
                        "usdValue": 127459496,
                        "isGasToken": False,
                    }
                ],
            },
        },
    }

    actual = clean_dataframe(
        parse_tvs(response_data, L2BeatProject(id="unichain", slug="unichain"))
    ).to_dicts()
    assert actual == [
        {
            "dt": "2025-04-25",
            "project_id": "unichain",
            "project_slug": "unichain",
            "timestamp": 1745578800,
            "asset_id": "unichain-ETH",
            "chain_name": "ethereum",
            "chain_id": None,
            "amount": 113967.52,
            "usd_value": 202157200.0,
            "usd_price": None,
            "is_gas_token": True,
            "token_address": None,
            "escrow_address": "native",
            "escrow_name": None,
            "is_shared_escrow": None,
            "escrow_url": None,
            "asset_url": None,
            "icon_url": "https://assets.coingecko.com/coins/images/279/large/ethereum.png?1595348880",
            "symbol": "ETH",
            "name": "Ether",
            "supply": None,
            "category": "canonical",
        },
        {
            "dt": "2025-04-25",
            "project_id": "unichain",
            "project_slug": "unichain",
            "timestamp": 1745578800,
            "asset_id": "unichain-ETH",
            "chain_name": "ethereum",
            "chain_id": None,
            "amount": 113967.52,
            "usd_value": 202157200.0,
            "usd_price": None,
            "is_gas_token": True,
            "token_address": None,
            "escrow_address": "native",
            "escrow_name": None,
            "is_shared_escrow": None,
            "escrow_url": None,
            "asset_url": None,
            "icon_url": "https://assets.coingecko.com/coins/images/279/large/ethereum.png?1595348880",
            "symbol": "ETH",
            "name": "Ether",
            "supply": None,
            "category": "canonical",
        },
        {
            "dt": "2025-04-25",
            "project_id": "unichain",
            "project_slug": "unichain",
            "timestamp": 1745578800,
            "asset_id": "unichain-WBTC",
            "chain_name": "ethereum",
            "chain_id": None,
            "amount": 352.62,
            "usd_value": 33032418.0,
            "usd_price": None,
            "is_gas_token": False,
            "token_address": "0x2260fac5e5542a773aa44fbcfedf7c193bc2c599",
            "escrow_address": "0x81014f44b0a345033bb2b3b21c7a1a308b35feea",
            "escrow_name": "L1StandardBridge",
            "is_shared_escrow": None,
            "escrow_url": "https://etherscan.io/address/0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
            "asset_url": "https://etherscan.io/address/0x2260FAC5E5542a773Aa44fBCfeDf7C193bc2C599",
            "icon_url": "https://assets.coingecko.com/coins/images/7598/large/wrapped_bitcoin_wbtc.png?1696507857",
            "symbol": "WBTC",
            "name": "Wrapped BTC",
            "supply": None,
            "category": "canonical",
        },
        {
            "dt": "2025-04-25",
            "project_id": "unichain",
            "project_slug": "unichain",
            "timestamp": 1745578800,
            "asset_id": "unichain-UNI",
            "chain_name": "ethereum",
            "chain_id": None,
            "amount": 1339715.1,
            "usd_value": 7810013.0,
            "usd_price": None,
            "is_gas_token": False,
            "token_address": "0x1f9840a85d5af5bf1d1762f925bdaddc4201f984",
            "escrow_address": "0x81014f44b0a345033bb2b3b21c7a1a308b35feea",
            "escrow_name": "L1StandardBridge",
            "is_shared_escrow": None,
            "escrow_url": "https://etherscan.io/address/0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
            "asset_url": "https://etherscan.io/address/0x1f9840a85d5aF5bf1D1762F925BDADdC4201F984",
            "icon_url": "https://assets.coingecko.com/coins/images/12504/large/uni.jpg?1696512319",
            "symbol": "UNI",
            "name": "Uniswap",
            "supply": None,
            "category": "canonical",
        },
        {
            "dt": "2025-04-25",
            "project_id": "unichain",
            "project_slug": "unichain",
            "timestamp": 1745578800,
            "asset_id": "unichain-COMP",
            "chain_name": "ethereum",
            "chain_id": None,
            "amount": 99093.86,
            "usd_value": 4359694.5,
            "usd_price": None,
            "is_gas_token": False,
            "token_address": "0xc00e94cb662c3520282e6f5717214004a7f26888",
            "escrow_address": "0x81014f44b0a345033bb2b3b21c7a1a308b35feea",
            "escrow_name": "L1StandardBridge",
            "is_shared_escrow": None,
            "escrow_url": "https://etherscan.io/address/0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
            "asset_url": "https://etherscan.io/address/0xc00e94Cb662C3520282E6f5717214004A7f26888",
            "icon_url": "https://assets.coingecko.com/coins/images/10775/large/COMP.png?1696510737",
            "symbol": "COMP",
            "name": "Compound",
            "supply": None,
            "category": "canonical",
        },
        {
            "dt": "2025-04-25",
            "project_id": "unichain",
            "project_slug": "unichain",
            "timestamp": 1745578800,
            "asset_id": "unichain-USDT",
            "chain_name": "ethereum",
            "chain_id": None,
            "amount": 2827899.2,
            "usd_value": 2828759.5,
            "usd_price": None,
            "is_gas_token": False,
            "token_address": "0xdac17f958d2ee523a2206206994597c13d831ec7",
            "escrow_address": "0x81014f44b0a345033bb2b3b21c7a1a308b35feea",
            "escrow_name": "L1StandardBridge",
            "is_shared_escrow": None,
            "escrow_url": "https://etherscan.io/address/0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
            "asset_url": "https://etherscan.io/address/0xdAC17F958D2ee523a2206206994597C13D831ec7",
            "icon_url": "https://assets.coingecko.com/coins/images/325/large/Tether.png?1696501661",
            "symbol": "USDT",
            "name": "Tether USD",
            "supply": None,
            "category": "canonical",
        },
        {
            "dt": "2025-04-25",
            "project_id": "unichain",
            "project_slug": "unichain",
            "timestamp": 1745578800,
            "asset_id": "unichain-LINK",
            "chain_name": "ethereum",
            "chain_id": None,
            "amount": 3015.38,
            "usd_value": 45384.84,
            "usd_price": None,
            "is_gas_token": False,
            "token_address": "0x514910771af9ca656af840dff83e8264ecf986ca",
            "escrow_address": "0x81014f44b0a345033bb2b3b21c7a1a308b35feea",
            "escrow_name": "L1StandardBridge",
            "is_shared_escrow": None,
            "escrow_url": "https://etherscan.io/address/0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
            "asset_url": "https://etherscan.io/address/0x514910771AF9Ca656af840dff83E8264EcF986CA",
            "icon_url": "https://assets.coingecko.com/coins/images/877/large/chainlink-new-logo.png?1696502009",
            "symbol": "LINK",
            "name": "ChainLink Token",
            "supply": None,
            "category": "canonical",
        },
        {
            "dt": "2025-04-25",
            "project_id": "unichain",
            "project_slug": "unichain",
            "timestamp": 1745578800,
            "asset_id": "unichain-DAI",
            "chain_name": "ethereum",
            "chain_id": None,
            "amount": 32400.75,
            "usd_value": 32391.03,
            "usd_price": None,
            "is_gas_token": False,
            "token_address": "0x6b175474e89094c44da98b954eedeac495271d0f",
            "escrow_address": "0x81014f44b0a345033bb2b3b21c7a1a308b35feea",
            "escrow_name": "L1StandardBridge",
            "is_shared_escrow": None,
            "escrow_url": "https://etherscan.io/address/0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
            "asset_url": "https://etherscan.io/address/0x6B175474E89094C44Da98b954EedeAC495271d0F",
            "icon_url": "https://assets.coingecko.com/coins/images/9956/large/Badge_Dai.png?1696509996",
            "symbol": "DAI",
            "name": "Dai Stablecoin",
            "supply": None,
            "category": "canonical",
        },
        {
            "dt": "2025-04-25",
            "project_id": "unichain",
            "project_slug": "unichain",
            "timestamp": 1745578800,
            "asset_id": "unichain-WETH",
            "chain_name": "ethereum",
            "chain_id": None,
            "amount": 0.12,
            "usd_value": 214.89,
            "usd_price": None,
            "is_gas_token": False,
            "token_address": "0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2",
            "escrow_address": "0x81014f44b0a345033bb2b3b21c7a1a308b35feea",
            "escrow_name": "L1StandardBridge",
            "is_shared_escrow": None,
            "escrow_url": "https://etherscan.io/address/0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
            "asset_url": "https://etherscan.io/address/0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2",
            "icon_url": "https://assets.coingecko.com/coins/images/2518/large/weth.png?1696503332",
            "symbol": "WETH",
            "name": "Wrapped Ether",
            "supply": None,
            "category": "canonical",
        },
        {
            "dt": "2025-04-25",
            "project_id": "unichain",
            "project_slug": "unichain",
            "timestamp": 1745578800,
            "asset_id": "unichain-ENS",
            "chain_name": "ethereum",
            "chain_id": None,
            "amount": 0.05,
            "usd_value": 0.86,
            "usd_price": None,
            "is_gas_token": False,
            "token_address": "0xc18360217d8f7ab5e7c516566761ea12ce7f9d72",
            "escrow_address": "0x81014f44b0a345033bb2b3b21c7a1a308b35feea",
            "escrow_name": "L1StandardBridge",
            "is_shared_escrow": None,
            "escrow_url": "https://etherscan.io/address/0x81014F44b0a345033bB2b3B21C7a1A308B35fEeA",
            "asset_url": "https://etherscan.io/address/0xC18360217D8F7Ab5e7c516566761Ea12Ce7F9D72",
            "icon_url": "https://assets.coingecko.com/coins/images/19785/large/acatxTm8_400x400.jpg?1696519207",
            "symbol": "ENS",
            "name": "Ethereum Name Service",
            "supply": None,
            "category": "canonical",
        },
        {
            "dt": "2025-04-25",
            "project_id": "unichain",
            "project_slug": "unichain",
            "timestamp": 1745578800,
            "asset_id": "unichain-wstETH-2",
            "chain_name": "ethereum",
            "chain_id": None,
            "amount": 33828.32,
            "usd_value": 72045040.0,
            "usd_price": None,
            "is_gas_token": False,
            "token_address": "0x7f39c581f595b53c5cb19bd0b3f8da6c935e2ca0",
            "escrow_address": None,
            "escrow_name": None,
            "is_shared_escrow": None,
            "escrow_url": None,
            "asset_url": "https://etherscan.io/address/0x7f39C581F595B53c5cb19bD0b3f8dA6c935E2Ca0",
            "icon_url": "https://assets.coingecko.com/coins/images/18834/large/wstETH.png?1696518295",
            "symbol": "wstETH",
            "name": "Wrapped liquid staked Ether 2.0",
            "supply": None,
            "category": "external",
        },
        {
            "dt": "2025-04-25",
            "project_id": "unichain",
            "project_slug": "unichain",
            "timestamp": 1745578800,
            "asset_id": "unichain-USD₮0",
            "chain_name": "unichain",
            "chain_id": None,
            "amount": 40949572.0,
            "usd_value": 40958648.0,
            "usd_price": None,
            "is_gas_token": False,
            "token_address": "0x9151434b16b9763660705744891fa906f660ecc5",
            "escrow_address": None,
            "escrow_name": None,
            "is_shared_escrow": None,
            "escrow_url": None,
            "asset_url": "https://uniscan.xyz/address/0x9151434b16b9763660705744891fA906F660EcC5",
            "icon_url": "https://coin-images.coingecko.com/coins/images/53705/large/usdt0.jpg?1737086183",
            "symbol": "USD₮0",
            "name": "USD₮0",
            "supply": None,
            "category": "external",
        },
        {
            "dt": "2025-04-25",
            "project_id": "unichain",
            "project_slug": "unichain",
            "timestamp": 1745578800,
            "asset_id": "unichain-weETH-1",
            "chain_name": "unichain",
            "chain_id": None,
            "amount": 15269.02,
            "usd_value": 28887326.0,
            "usd_price": None,
            "is_gas_token": False,
            "token_address": "0x7dcc39b4d1c53cb31e1abc0e358b43987fef80f7",
            "escrow_address": None,
            "escrow_name": None,
            "is_shared_escrow": None,
            "escrow_url": None,
            "asset_url": "https://uniscan.xyz/address/0x7DCC39B4d1C53CB31e1aBc0e358b43987FEF80f7",
            "icon_url": "https://coin-images.coingecko.com/coins/images/33033/large/weETH.png?1701438396",
            "symbol": "weETH",
            "name": "Wrapped eETH",
            "supply": None,
            "category": "external",
        },
        {
            "dt": "2025-04-25",
            "project_id": "unichain",
            "project_slug": "unichain",
            "timestamp": 1745578800,
            "asset_id": "unichain-rsETH-1",
            "chain_name": "unichain",
            "chain_id": None,
            "amount": 9154.05,
            "usd_value": 16919968.0,
            "usd_price": None,
            "is_gas_token": False,
            "token_address": "0xc3eacf0612346366db554c991d7858716db09f58",
            "escrow_address": None,
            "escrow_name": None,
            "is_shared_escrow": None,
            "escrow_url": None,
            "asset_url": "https://uniscan.xyz/address/0xc3eACf0612346366Db554C991D7858716db09f58",
            "icon_url": "https://coin-images.coingecko.com/coins/images/33800/large/Icon___Dark.png?1702991855",
            "symbol": "rsETH",
            "name": "KelpDao Restaked ETH",
            "supply": None,
            "category": "external",
        },
        {
            "dt": "2025-04-25",
            "project_id": "unichain",
            "project_slug": "unichain",
            "timestamp": 1745578800,
            "asset_id": "unichain-ezETH-1",
            "chain_name": "unichain",
            "chain_id": None,
            "amount": 8107.08,
            "usd_value": 15048706.0,
            "usd_price": None,
            "is_gas_token": False,
            "token_address": "0x2416092f143378750bb29b79ed961ab195cceea5",
            "escrow_address": None,
            "escrow_name": None,
            "is_shared_escrow": None,
            "escrow_url": None,
            "asset_url": "https://uniscan.xyz/address/0x2416092f143378750bb29b79eD961ab195CcEea5",
            "icon_url": "https://coin-images.coingecko.com/coins/images/34753/large/Ezeth_logo_circle.png?1713496404",
            "symbol": "ezETH",
            "name": "Renzo Restaked ETH",
            "supply": None,
            "category": "external",
        },
        {
            "dt": "2025-04-25",
            "project_id": "unichain",
            "project_slug": "unichain",
            "timestamp": 1745578800,
            "asset_id": "unichain-USDC",
            "chain_name": "unichain",
            "chain_id": None,
            "amount": 127459750.0,
            "usd_value": 127459496.0,
            "usd_price": None,
            "is_gas_token": False,
            "token_address": "0x078d782b760474a361dda0af3839290b0ef57ad6",
            "escrow_address": None,
            "escrow_name": None,
            "is_shared_escrow": None,
            "escrow_url": None,
            "asset_url": "https://uniscan.xyz/address/0x078D782b760474a361dDA0AF3839290b0EF57AD6",
            "icon_url": "https://coin-images.coingecko.com/coins/images/6319/large/usdc.png?1696506694",
            "symbol": "USDC",
            "name": "USDC",
            "supply": None,
            "category": "native",
        },
    ]
