import json

import polars as pl
from op_analytics.coreutils.testutils.inputdata import InputTestData
from op_analytics.datasources.l2beat.projects import parse_summary, L2BeatProject
from op_analytics.datasources.l2beat.utils import apply_schema
from op_analytics.datasources.l2beat.tvl import TVL_SCHEMA


TESTDATA = InputTestData.at(__file__)


def test_parse_summary():
    with open(TESTDATA.path("mockdata/l2beat_scaling_summary_v3.json")) as fobj:
        data = json.load(fobj)

    df = parse_summary(data)

    assert len(df) == 157

    actual = df.sort(by="tvl_total", descending=True).to_dicts()[:5]

    assert actual == [
        {
            "id": "base",
            "name": "Base",
            "slug": "base",
            "type": "layer2",
            "hostChain": "Ethereum",
            "category": "Optimistic Rollup",
            "providers": ["OP Stack"],
            "purposes": ["Universal"],
            "isArchived": False,
            "isUpcoming": False,
            "isUnderReview": False,
            "stage": "Stage 1",
            "shortName": None,
            "da_badge": "Ethereum with blobs",
            "vm_badge": "EVM",
            "tvl_total": 15509347000.0,
            "tvl_ether": 5449878000.0,
            "tvl_stablecoin": 5350739000.0,
            "tvl_associated": 0.0,
            "tvl_associated_tokens": [],
        },
        {
            "id": "arbitrum",
            "name": "Arbitrum One",
            "slug": "arbitrum",
            "type": "layer2",
            "hostChain": "Ethereum",
            "category": "Optimistic Rollup",
            "providers": ["Arbitrum"],
            "purposes": ["Universal"],
            "isArchived": False,
            "isUpcoming": False,
            "isUnderReview": False,
            "stage": "Stage 1",
            "shortName": None,
            "da_badge": "Ethereum with blobs",
            "vm_badge": "EVM",
            "tvl_total": 14562563000.0,
            "tvl_ether": 3260466000.0,
            "tvl_stablecoin": 6531057000.0,
            "tvl_associated": 2016908900.0,
            "tvl_associated_tokens": ["ARB"],
        },
        {
            "id": "optimism",
            "name": "OP Mainnet",
            "slug": "op-mainnet",
            "type": "layer2",
            "hostChain": "Ethereum",
            "category": "Optimistic Rollup",
            "providers": ["OP Stack"],
            "purposes": ["Universal"],
            "isArchived": False,
            "isUpcoming": False,
            "isUnderReview": False,
            "stage": "Stage 1",
            "shortName": None,
            "da_badge": "Ethereum with blobs",
            "vm_badge": "EVM",
            "tvl_total": 3466063400.0,
            "tvl_ether": 782466300.0,
            "tvl_stablecoin": 538379140.0,
            "tvl_associated": 1320651000.0,
            "tvl_associated_tokens": ["OP"],
        },
        {
            "id": "polygon-pos",
            "name": "Polygon PoS",
            "slug": "polygon-pos",
            "type": "layer2",
            "hostChain": "Ethereum",
            "category": "Other",
            "providers": None,
            "purposes": ["Universal"],
            "isArchived": False,
            "isUpcoming": False,
            "isUnderReview": False,
            "stage": "Not applicable",
            "shortName": None,
            "da_badge": "Custom DA solution",
            "vm_badge": "EVM",
            "tvl_total": 3323611000.0,
            "tvl_ether": 421662370.0,
            "tvl_stablecoin": 1557074800.0,
            "tvl_associated": 553139100.0,
            "tvl_associated_tokens": ["POL", "MATIC"],
        },
        {
            "id": "mantle",
            "name": "Mantle",
            "slug": "mantle",
            "type": "layer2",
            "hostChain": "Ethereum",
            "category": "Optimium",
            "providers": ["OP Stack"],
            "purposes": ["Universal"],
            "isArchived": False,
            "isUpcoming": False,
            "isUnderReview": False,
            "stage": "Not applicable",
            "shortName": None,
            "da_badge": "EigenDA",
            "vm_badge": "EVM",
            "tvl_total": 1506660700.0,
            "tvl_ether": 612751600.0,
            "tvl_stablecoin": 518960770.0,
            "tvl_associated": 226492530.0,
            "tvl_associated_tokens": ["MNT"],
        },
    ]


def test_apply_schema():
    raw_data = {
        L2BeatProject(id="polygon-pos", slug="polygon-pos"): {
            "success": True,
            "data": {
                "usdValue": 3423248049.47,
                "ethValue": 1579754.273700954,
                "chart": {
                    "types": ["timestamp", "native", "canonical", "external", "ethPrice"],
                    "data": [
                        [1738454400, 0, 3783307691.51, 0, 3118.4321],
                        [1738476000, 0, 3776290310.88, 0, 3119.7048],
                        [1738497600, 0, 3727362097.4, 0, 3065.666],
                        [1738519200, 0, 3636651087.59, 0, 2970.0256],
                        [1738540800, 0, 3575419768.78, 0, 2866.2536999999998],
                        [1738562400, 0, 3357691211.41, 0, 2492.9434],
                        [1738584000, 0, 3465526850.02, 0, 2585.8862],
                        [1738605600, 0, 3640483829.01, 0, 2713.4197],
                        [1738627200, 0, 3735772001.34, 0, 2880.2817],
                        [1738648800, 0, 3601379460.8, 0, 2709.165],
                        [1738670400, 0, 3627683622.59, 0, 2764.453],
                        [1738692000, 0, 3634143797.97, 0, 2817.343],
                        [1738713600, 0, 3595859608.59, 0, 2734.7632],
                        [1738735200, 0, 3624976895.44, 0, 2766.9778],
                        [1738756800, 0, 3642143027.61, 0, 2803.2717],
                        [1738778400, 0, 3598997052.25, 0, 2748.9966],
                        [1738800000, 0, 3605283869.09, 0, 2789.6216],
                        [1738821600, 0, 3635497575.25, 0, 2828.8013],
                        [1738843200, 0, 3636468627.4, 0, 2807.2258],
                        [1738864800, 0, 3527138156.82, 0, 2699.1633],
                        [1738886400, 0, 3531049580.97, 0, 2687.8135],
                        [1738908000, 0, 3556341186.6, 0, 2713.2769],
                        [1738929600, 0, 3603947291.87, 0, 2762.386],
                        [1738951200, 0, 3559204340.27, 0, 2679.5737],
                        [1738972800, 0, 3514488676.6, 0, 2623.4507],
                        [1738994400, 0, 3510704215.9, 0, 2620.003],
                        [1739016000, 0, 3511288982.93, 0, 2609.2285],
                        [1739037600, 0, 3544880334.54, 0, 2629.5073],
                        [1739059200, 0, 3557709987.34, 0, 2632.8062],
                        [1739080800, 0, 3581042918.19, 0, 2661.5818],
                        [1739102400, 0, 3579105062.47, 0, 2656.8438],
                        [1739124000, 0, 3545734362.09, 0, 2640.5596],
                        [1739145600, 0, 3553334206.06, 0, 2630.4372999999996],
                        [1739167200, 0, 3565286236.79, 0, 2638.8823],
                        [1739188800, 0, 3585185919.69, 0, 2655.4084],
                        [1739210400, 0, 3591957590.09, 0, 2679.592],
                        [1739232000, 0, 3592145647.14, 0, 2661.987],
                        [1739253600, 0, 3645438465.08, 0, 2714.1672],
                        [1739275200, 0, 3637166051.25, 0, 2707.8936],
                        [1739296800, 0, 3580498120.5, 0, 2637.9993],
                        [1739318400, 0, 3565053060.71, 0, 2602.923],
                        [1739340000, 0, 3560457073.18, 0, 2608.2039],
                        [1739361600, 0, 3574028449.43, 0, 2626.992],
                        [1739383200, 0, 3625245459.25, 0, 2672.5457],
                        [1739404800, 0, 3666753757.14, 0, 2737.199],
                        [1739426400, 0, 3658130830.24, 0, 2721.6362],
                        [1739448000, 0, 3644090742.81, 0, 2657.1575],
                        [1739469600, 0, 3621766414.05, 0, 2633.2253],
                        [1739491200, 0, 3667771096.1, 0, 2676.7212],
                        [1739512800, 0, 3675548016.23, 0, 2695.3032000000003],
                        [1739534400, 0, 3701202922.88, 0, 2685.2341],
                        [1739556000, 0, 3737354521.42, 0, 2776.0864],
                        [1739577600, 0, 3775067956.31, 0, 2725.8914],
                        [1739599200, 0, 3841148820.77, 0, 2721.512],
                        [1739620800, 0, 3859701040.27, 0, 2707.8481],
                        [1739642400, 0, 3842431859, 0, 2684.9438],
                        [1739664000, 0, 3841809829.02, 0, 2693.5044],
                        [1739685600, 0, 3855438674.17, 0, 2710.086],
                        [1739707200, 0, 3867267144.34, 0, 2712.0425],
                        [1739728800, 0, 3859259415.4, 0, 2690.2163],
                        [1739750400, 0, 3847662000.51, 0, 2661.1506],
                        [1739772000, 0, 3835778903.36, 0, 2668.0051000000003],
                        [1739793600, 0, 3864705194.67, 0, 2754.67],
                        [1739815200, 0, 3808985987.29, 0, 2735.929],
                        [1739836800, 0, 3797004631.05, 0, 2743.3503],
                        [1739858400, 0, 3730603053.98, 0, 2677.798],
                        [1739880000, 0, 3728983010.38, 0, 2681.1284],
                        [1739901600, 0, 3669703968.16, 0, 2614.5854],
                        [1739923200, 0, 3733137219.42, 0, 2671.6887],
                        [1739944800, 0, 3712498729.81, 0, 2685.5208],
                        [1739966400, 0, 3771401491.95, 0, 2727.3718],
                        [1739988000, 0, 3779151327.55, 0, 2711.4072],
                        [1740009600, 0, 3782938468.64, 0, 2716.0693],
                        [1740031200, 0, 3780027292.96, 0, 2730.3580000000006],
                        [1740052800, 0, 3789039170.21, 0, 2741.6080000000006],
                        [1740074400, 0, 3777216065.81, 0, 2735.8459999999995],
                        [1740096000, 0, 3825366021.35, 0, 2739.7255999999998],
                        [1740117600, 0, 3789185273.93, 0, 2755.1274],
                        [1740139200, 0, 3801376777.92, 0, 2791.834],
                        [1740160800, 0, 3721418793.61, 0, 2677.5234],
                        [1740182400, 0, 3701199468.65, 0, 2658.3472],
                        [1740204000, 0, 3767997333.56, 0, 2690.5872],
                        [1740225600, 0, 3757997954.7, 0, 2734.749],
                        [1740247200, 0, 3781210832.25, 0, 2789.4692],
                        [1740268800, 0, 3816755986.86, 0, 2762.9668],
                        [1740290400, 0, 3832375439.99, 0, 2781.5559999999996],
                        [1740312000, 0, 3830894426.06, 0, 2797.2339999999995],
                        [1740333600, 0, 3823473183.11, 0, 2818.87],
                        [1740355200, 0, 3839192834.66, 0, 2825.034],
                        [1740376800, 0, 3791683309.54, 0, 2730.762],
                        [1740398400, 0, 3770601400.01, 0, 2688.2075],
                        [1740420000, 0, 3723737856.57, 0, 2663.492],
                        [1740441600, 0, 3609932119.96, 0, 2514.864],
                        [1740463200, 0, 3601855281.75, 0, 2501.29],
                        [1740484800, 0, 3553253612.47, 0, 2433.876],
                        [1740506400, 0, 3535696222.07, 0, 2426.3574],
                        [1740528000, 0, 3597931433.44, 0, 2491.0957],
                        [1740549600, 0, 3592711428.28, 0, 2474.935],
                        [1740571200, 0, 3608936920.7, 0, 2463.9045],
                        [1740592800, 0, 3518632891.16, 0, 2363.211],
                        [1740614400, 0, 3513116897.97, 0, 2333.4392],
                        [1740636000, 0, 3561516937.94, 0, 2339.9895],
                        [1740657600, 0, 3575026846.97, 0, 2352.1033],
                        [1740679200, 0, 3537266267.79, 0, 2319.485],
                        [1740700800, 0, 3532943287.17, 0, 2305.0334],
                        [1740722400, 0, 3407611812.76, 0, 2123.0913],
                        [1740744000, 0, 3412941405.47, 0, 2126.6357],
                        [1740765600, 0, 3490274585.87, 0, 2210.4333],
                        [1740787200, 0, 3515519633.57, 0, 2234.7104],
                        [1740808800, 0, 3538315141.55, 0, 2253.2021],
                        [1740830400, 0, 3500679375.91, 0, 2182.7004],
                        [1740852000, 0, 3504629373.52, 0, 2196.198],
                        [1740873600, 0, 3546539086.22, 0, 2214.4846],
                        [1740895200, 0, 3536846230.8, 0, 2229.6592],
                        [1740916800, 0, 3539373521.46, 0, 2235.9514],
                        [1740938400, 0, 3741780628.15, 0, 2481.2893],
                        [1740960000, 0, 3730867455.51, 0, 2517.3381],
                        [1740981600, 0, 3682529839.13, 0, 2450.0854],
                        [1741003200, 0, 3603830773.66, 0, 2355.636],
                        [1741024800, 0, 3540922705.79, 0, 2280.2205],
                        [1741046400, 0, 3431035501.1, 0, 2144.9468],
                        [1741068000, 0, 3372621236.79, 0, 2105.8694],
                        [1741089600, 0, 3350612557.19, 0, 2099.9663],
                        [1741111200, 0, 3374667583.91, 0, 2120.4314],
                        [1741118400, 0, 3423248049.47, 0, 2166.9497],
                    ],
                },
            },
        },
        L2BeatProject(id="hyperliquid", slug="hyperliquid"): {
            "success": True,
            "data": {
                "usdValue": 2517051639.44,
                "ethValue": 1161564.405228234,
                "chart": {
                    "types": ["timestamp", "native", "canonical", "external", "ethPrice"],
                    "data": [
                        [1738454400, 0, 2414574070.34, 0, 3118.4321],
                        [1738476000, 0, 2397252984.83, 0, 3119.7048],
                        [1738497600, 0, 2395796846.75, 0, 3065.666],
                        [1738519200, 0, 2396244302.98, 0, 2970.0256],
                        [1738540800, 0, 2396213089.02, 0, 2866.2536999999998],
                        [1738562400, 0, 2343971503.59, 0, 2492.9434],
                        [1738584000, 0, 2372232723.14, 0, 2585.8862],
                        [1738605600, 0, 2409574046.02, 0, 2713.4197],
                        [1738627200, 0, 2436936218.53, 0, 2880.2817],
                        [1738648800, 0, 2433767840.83, 0, 2709.165],
                        [1738670400, 0, 2434124662.9, 0, 2764.453],
                        [1738692000, 0, 2460065750.44, 0, 2817.343],
                        [1738713600, 0, 2459186615.09, 0, 2734.7632],
                        [1738735200, 0, 2462570565.18, 0, 2766.9778],
                        [1738756800, 0, 2468075862.35, 0, 2803.2717],
                        [1738778400, 0, 2494206122.09, 0, 2748.9966],
                        [1738800000, 0, 2494291590.28, 0, 2789.6216],
                        [1738821600, 0, 2495322435.35, 0, 2828.8013],
                        [1738843200, 0, 2495576703.76, 0, 2807.2258],
                        [1738864800, 0, 2474964032.9, 0, 2699.1633],
                        [1738886400, 0, 2479873672.46, 0, 2687.8135],
                        [1738908000, 0, 2480171746.73, 0, 2713.2769],
                        [1738929600, 0, 2480902613.88, 0, 2762.386],
                        [1738951200, 0, 2462044688.57, 0, 2679.5737],
                        [1738972800, 0, 2469913387.21, 0, 2623.4507],
                        [1738994400, 0, 2469642416, 0, 2620.003],
                        [1739016000, 0, 2463646778.53, 0, 2609.2285],
                        [1739037600, 0, 2463032934.73, 0, 2629.5073],
                        [1739059200, 0, 2476072867.1, 0, 2632.8062],
                        [1739080800, 0, 2479320976.59, 0, 2661.5818],
                        [1739102400, 0, 2478389654.63, 0, 2656.8438],
                        [1739124000, 0, 2474666779.42, 0, 2640.5596],
                        [1739145600, 0, 2474400473.47, 0, 2630.4372999999996],
                        [1739167200, 0, 2473276434.76, 0, 2638.8823],
                        [1739188800, 0, 2479808834.66, 0, 2655.4084],
                        [1739210400, 0, 2484425681.39, 0, 2679.592],
                        [1739232000, 0, 2462519682.09, 0, 2661.987],
                        [1739253600, 0, 2463860202.48, 0, 2714.1672],
                        [1739275200, 0, 2464687359.82, 0, 2707.8936],
                        [1739296800, 0, 2465885688.69, 0, 2637.9993],
                        [1739318400, 0, 2454152858.51, 0, 2602.923],
                        [1739340000, 0, 2456282243.16, 0, 2608.2039],
                        [1739361600, 0, 2458506812.37, 0, 2626.992],
                        [1739383200, 0, 2463797653.99, 0, 2672.5457],
                        [1739404800, 0, 2475345339.91, 0, 2737.199],
                        [1739426400, 0, 2478512445.65, 0, 2721.6362],
                        [1739448000, 0, 2478478664.48, 0, 2657.1575],
                        [1739469600, 0, 2471597713.42, 0, 2633.2253],
                        [1739491200, 0, 2483979187.44, 0, 2676.7212],
                        [1739512800, 0, 2496734266.64, 0, 2695.3032000000003],
                        [1739534400, 0, 2510216576.3, 0, 2685.2341],
                        [1739556000, 0, 2524274725.61, 0, 2776.0864],
                        [1739577600, 0, 2531278151.04, 0, 2725.8914],
                        [1739599200, 0, 2534252089.94, 0, 2721.512],
                        [1739620800, 0, 2526609715.61, 0, 2707.8481],
                        [1739642400, 0, 2531120296.37, 0, 2684.9438],
                        [1739664000, 0, 2532041575.81, 0, 2693.5044],
                        [1739685600, 0, 2533408401.41, 0, 2710.086],
                        [1739707200, 0, 2530856224.97, 0, 2712.0425],
                        [1739728800, 0, 2528640840.58, 0, 2690.2163],
                        [1739750400, 0, 2528441031.54, 0, 2661.1506],
                        [1739772000, 0, 2524558828.32, 0, 2668.0051000000003],
                        [1739793600, 0, 2519498931.16, 0, 2754.67],
                        [1739815200, 0, 2527111157.19, 0, 2735.929],
                        [1739836800, 0, 2522177742.13, 0, 2743.3503],
                        [1739858400, 0, 2519131733.73, 0, 2677.798],
                        [1739880000, 0, 2524753039.37, 0, 2681.1284],
                        [1739901600, 0, 2518002356.86, 0, 2614.5854],
                        [1739923200, 0, 2528490442.2, 0, 2671.6887],
                        [1739944800, 0, 2528762004.92, 0, 2685.5208],
                        [1739966400, 0, 2523545957.46, 0, 2727.3718],
                        [1739988000, 0, 2517441934.89, 0, 2711.4072],
                        [1740009600, 0, 2512786504.36, 0, 2716.0693],
                        [1740031200, 0, 2525685119.48, 0, 2730.3580000000006],
                        [1740052800, 0, 2530333954.35, 0, 2741.6080000000006],
                        [1740074400, 0, 2525034103.64, 0, 2735.8459999999995],
                        [1740096000, 0, 2528749995.89, 0, 2739.7255999999998],
                        [1740117600, 0, 2546950913, 0, 2755.1274],
                        [1740139200, 0, 2552192750.62, 0, 2791.834],
                        [1740160800, 0, 2552148744.17, 0, 2677.5234],
                        [1740182400, 0, 2528208047.83, 0, 2658.3472],
                        [1740204000, 0, 2545737616.48, 0, 2690.5872],
                        [1740225600, 0, 2550265764.93, 0, 2734.749],
                        [1740247200, 0, 2539391433.4, 0, 2789.4692],
                        [1740268800, 0, 2536195235.43, 0, 2762.9668],
                        [1740290400, 0, 2516079203.36, 0, 2781.5559999999996],
                        [1740312000, 0, 2522030009.97, 0, 2797.2339999999995],
                        [1740333600, 0, 2523312768.04, 0, 2818.87],
                        [1740355200, 0, 2518138135.71, 0, 2825.034],
                        [1740376800, 0, 2516305442.29, 0, 2730.762],
                        [1740398400, 0, 2523915989.73, 0, 2688.2075],
                        [1740420000, 0, 2518622598.39, 0, 2663.492],
                        [1740441600, 0, 2513786126.78, 0, 2514.864],
                        [1740463200, 0, 2513726125.19, 0, 2501.29],
                        [1740484800, 0, 2527246151.39, 0, 2433.876],
                        [1740506400, 0, 2515221967.75, 0, 2426.3574],
                        [1740528000, 0, 2527794816.29, 0, 2491.0957],
                        [1740549600, 0, 2520345649.03, 0, 2474.935],
                        [1740571200, 0, 2514527268.44, 0, 2463.9045],
                        [1740592800, 0, 2509920633.09, 0, 2363.211],
                        [1740614400, 0, 2527315449.4, 0, 2333.4392],
                        [1740636000, 0, 2516250661.79, 0, 2339.9895],
                        [1740657600, 0, 2517015695.79, 0, 2352.1033],
                        [1740679200, 0, 2505567817.05, 0, 2319.485],
                        [1740700800, 0, 2502272354.28, 0, 2305.0334],
                        [1740722400, 0, 2494403440.89, 0, 2123.0913],
                        [1740744000, 0, 2496170577.94, 0, 2126.6357],
                        [1740765600, 0, 2505526083.99, 0, 2210.4333],
                        [1740787200, 0, 2515765182.85, 0, 2234.7104],
                        [1740808800, 0, 2528855144.83, 0, 2253.2021],
                        [1740830400, 0, 2501670188.98, 0, 2182.7004],
                        [1740852000, 0, 2506799471.57, 0, 2196.198],
                        [1740873600, 0, 2516569149.73, 0, 2214.4846],
                        [1740895200, 0, 2516240367.89, 0, 2229.6592],
                        [1740916800, 0, 2523004809.69, 0, 2235.9514],
                        [1740938400, 0, 2570524093.76, 0, 2481.2893],
                        [1740960000, 0, 2579953394.57, 0, 2517.3381],
                        [1740981600, 0, 2569724084.37, 0, 2450.0854],
                        [1741003200, 0, 2568798110.45, 0, 2355.636],
                        [1741024800, 0, 2550750115.78, 0, 2280.2205],
                        [1741046400, 0, 2531038505.84, 0, 2144.9468],
                        [1741068000, 0, 2516536766, 0, 2105.8694],
                        [1741089600, 0, 2513352027.78, 0, 2099.9663],
                        [1741111200, 0, 2499330011.91, 0, 2120.4314],
                        [1741118400, 0, 2517051639.44, 0, 2166.9497],
                    ],
                },
            },
        },
        L2BeatProject(id="optimism", slug="op-mainnet"): {
            "success": True,
            "data": {
                "usdValue": 4337164897.51,
                "ethValue": 2001506.9558421222,
                "chart": {
                    "types": ["timestamp", "native", "canonical", "external", "ethPrice"],
                    "data": [
                        [1738454400, 2221456896.43, 3488603702.17, 347525268.23, 3118.4321],
                        [1738476000, 2212030786.53, 3475617128.92, 346496610.51, 3119.7048],
                        [1738497600, 2133279233.24, 3433390368.61, 339527648.97, 3065.666],
                        [1738519200, 1986903098.93, 3341981851.99, 325067271.97, 2970.0256],
                        [
                            1738540800,
                            1901144729.09,
                            3258381668.63,
                            313215140.57,
                            2866.2536999999998,
                        ],
                        [1738562400, 1723741575.36, 2960881500.06, 275296420.88, 2492.9434],
                        [1738584000, 1879460042.27, 3047249629.46, 287115599.82, 2585.8862],
                        [1738605600, 1959106004.88, 3155915685.94, 302404531.01, 2713.4197],
                        [1738627200, 2005819225.39, 3221208159.78, 316587106.44, 2880.2817],
                        [1738648800, 1871229288.68, 3070407904.19, 291898507.18, 2709.165],
                        [1738670400, 1853543933.11, 3111190353.84, 290700708.93, 2764.453],
                        [1738692000, 1911376158.27, 3149757123.94, 294248321.76, 2817.343],
                        [1738713600, 1908832441.32, 3091807301.01, 291326923.9, 2734.7632],
                        [1738735200, 1927910656.96, 3126209861.34, 293199749.88, 2766.9778],
                        [1738756800, 1950531453.1, 3150231765.42, 295529803.66, 2803.2717],
                        [1738778400, 1870635498.35, 3102958335.75, 287067472.1, 2748.9966],
                        [1738800000, 1878794457.75, 3018382688.52, 285038841.27, 2789.6216],
                        [1738821600, 1933295786.17, 3058649375.44, 287000185.29, 2828.8013],
                        [1738843200, 1918000434.71, 3047148741.17, 285463968.82, 2807.2258],
                        [1738864800, 1834774430.5, 2954384977.76, 274108373.05, 2699.1633],
                        [1738886400, 1817284989.54, 2943314663.58, 271262024.82, 2687.8135],
                        [1738908000, 1843381704.04, 2967812045.06, 275245065.09, 2713.2769],
                        [1738929600, 1877127519.25, 3012819722.87, 277765550.2, 2762.386],
                        [1738951200, 1837561139.81, 2950905658.63, 273011596, 2679.5737],
                        [1738972800, 1785919747.67, 2915106039.33, 266264356.26, 2623.4507],
                        [1738994400, 1775710749.35, 2915125160.75, 265528039.72, 2620.003],
                        [1739016000, 1780008197.48, 2910331461.9, 265323719.81, 2609.2285],
                        [1739037600, 1825238236.79, 2943406192.47, 268155445.85, 2629.5073],
                        [1739059200, 1857896972.61, 2945179936.4, 268186501.24, 2632.8062],
                        [1739080800, 1863044192.55, 2966374340.88, 270673406, 2661.5818],
                        [1739102400, 1881343549.8, 2962904120.06, 267772258.91, 2656.8438],
                        [1739124000, 1865988013.32, 2944150643.81, 266460471.24, 2640.5596],
                        [
                            1739145600,
                            1877094903.53,
                            2941583675.44,
                            265696801.91,
                            2630.4372999999996,
                        ],
                        [1739167200, 1895778122.66, 2953203595.47, 266094108.68, 2638.8823],
                        [1739188800, 1898313234.44, 2974013507.01, 266212841.31, 2655.4084],
                        [1739210400, 1916944289.22, 2994661544.17, 270501544.72, 2679.592],
                        [1739232000, 1901800687.04, 2975981087.9, 270939117.39, 2661.987],
                        [1739253600, 1965811219.62, 3029431937.03, 277148946.64, 2714.1672],
                        [1739275200, 1938592837.67, 3017207450.04, 273914250.2, 2707.8936],
                        [1739296800, 1888995017.18, 2958803225.85, 266227276.58, 2637.9993],
                        [1739318400, 1872126071.84, 2931947719.39, 262452495.78, 2602.923],
                        [1739340000, 1865338153.82, 2930627299.28, 263028380.12, 2608.2039],
                        [1739361600, 1872811222.12, 2943589578.66, 263619851.42, 2626.992],
                        [1739383200, 1915012689.12, 2987532534.65, 271849336.94, 2672.5457],
                        [1739404800, 1947130022.61, 3036705691.8, 277765749.37, 2737.199],
                        [1739426400, 1966458554.31, 3024605289.94, 274957673.62, 2721.6362],
                        [1739448000, 1916510084.85, 2973097149.04, 268759383.72, 2657.1575],
                        [1739469600, 1920718289.99, 2851964025.11, 267775271.05, 2633.2253],
                        [1739491200, 1940350738.04, 2878448349.9, 273491263.64, 2676.7212],
                        [
                            1739512800,
                            1949514604.45,
                            2890773760.13,
                            274548497.32,
                            2695.3032000000003,
                        ],
                        [1739534400, 1991135556.86, 2895566294.31, 270150570.83, 2685.2341],
                        [1739556000, 2037305982.53, 2873141442.46, 280015327.89, 2776.0864],
                        [1739577600, 1983547574.63, 2834911973.37, 275417461.97, 2725.8914],
                        [1739599200, 1984464324.18, 2829581766.18, 275305011.12, 2721.512],
                        [1739620800, 1959448058.93, 2813574167.98, 272547818.89, 2707.8481],
                        [1739642400, 1944000162.07, 2791806576.16, 268244879.44, 2684.9438],
                        [1739664000, 1941920488.64, 2800063099.18, 269296338.19, 2693.5044],
                        [1739685600, 1943632620.45, 2816651575.74, 269891010.41, 2710.086],
                        [1739707200, 1963637496.58, 2821589246.92, 274154276.87, 2712.0425],
                        [1739728800, 1941338601.75, 2799860774.52, 269725844.85, 2690.2163],
                        [1739750400, 1923259160.68, 2779957916.61, 266652620.5, 2661.1506],
                        [
                            1739772000,
                            1923803142.95,
                            2784792185.15,
                            267452215.51,
                            2668.0051000000003,
                        ],
                        [1739793600, 1985189867.6, 2845786984.09, 274111228.9, 2754.67],
                        [1739815200, 2009925214.39, 2821815175.13, 272305288.9, 2735.929],
                        [1739836800, 2374863073.18, 2830317726.68, 273391650.5, 2743.3503],
                        [1739858400, 2255737958.91, 2780902509.81, 266645848.16, 2677.798],
                        [1739880000, 2186244648.89, 2756176318.12, 265751015.08, 2681.1284],
                        [1739901600, 2109107315.65, 2597735874.76, 258085075.41, 2614.5854],
                        [1739923200, 2157321881.26, 2647697017.71, 261508705.49, 2671.6887],
                        [1739944800, 2172973934.1, 2654730628.04, 260925041.13, 2685.5208],
                        [1739966400, 2256726904.71, 2694522954.55, 265270554.36, 2727.3718],
                        [1739988000, 2247613045.36, 2677645471.05, 263629522.52, 2711.4072],
                        [1740009600, 2226339310.49, 2677973924.07, 261814307.73, 2716.0693],
                        [
                            1740031200,
                            2275727001.08,
                            2694943768.49,
                            264033102.54,
                            2730.3580000000006,
                        ],
                        [
                            1740052800,
                            2271606527.29,
                            2706134459.51,
                            264255168.87,
                            2741.6080000000006,
                        ],
                        [1740074400, 2262768650.3, 2702143887.18, 265794069.38, 2735.8459999999995],
                        [
                            1740096000,
                            2290356184.88,
                            2714981631.85,
                            268361504.28,
                            2739.7255999999998,
                        ],
                        [1740117600, 2292439550.67, 2727217615.81, 268295502.43, 2755.1274],
                        [1740139200, 2317210839.15, 2769806376.75, 276121990.9, 2791.834],
                        [1740160800, 2235449015.62, 2581348650.15, 265939320.18, 2677.5234],
                        [1740182400, 2168306159.63, 2566827779.97, 260532140.76, 2658.3472],
                        [1740204000, 2167021689.37, 2639564614.83, 264078081.46, 2690.5872],
                        [1740225600, 2213058539.6, 2712406250.45, 267960834.33, 2734.749],
                        [1740247200, 2262516458.38, 2757330619.35, 272331668.77, 2789.4692],
                        [1740268800, 2260123091.01, 2739468751.15, 273550351.24, 2762.9668],
                        [
                            1740290400,
                            2268397851.12,
                            2746342422.38,
                            272007541.05,
                            2781.5559999999996,
                        ],
                        [
                            1740312000,
                            2294534028.16,
                            2755080853.36,
                            273314516.48,
                            2797.2339999999995,
                        ],
                        [1740333600, 2326913950.5, 2765120983.13, 273940608.62, 2818.87],
                        [1740355200, 2323571273.96, 2773550574.03, 274110413.53, 2825.034],
                        [1740376800, 2231252284.74, 2700783564.39, 266386369.26, 2730.762],
                        [1740398400, 2197177601.81, 2667536006.91, 263267186.17, 2688.2075],
                        [1740420000, 2132135631.84, 2571911484.36, 260399196.66, 2663.492],
                        [1740441600, 2011026616.1, 2447797934.32, 244842215.31, 2514.864],
                        [1740463200, 2024860106.49, 2442866443.13, 245996376.15, 2501.29],
                        [1740484800, 1993827144.79, 2404079166.1, 237988743.04, 2433.876],
                        [1740506400, 2081061096.01, 2410297834.08, 238209742.16, 2426.3574],
                        [1740528000, 2132190341.35, 2463854126.06, 244438120.53, 2491.0957],
                        [1740549600, 2131148081.46, 2455404995.9, 244054990.88, 2474.935],
                        [1740571200, 2122625625.07, 2449221459.72, 242927019.17, 2463.9045],
                        [1740592800, 2141996062.48, 2378092519.35, 234272188, 2363.211],
                        [1740614400, 2235611823.1, 2362855641.8, 233424899.02, 2333.4392],
                        [1740636000, 2295739702.01, 2376833682.66, 236212965.55, 2339.9895],
                        [1740657600, 2265569853.63, 2361213951.19, 239490684.1, 2352.1033],
                        [1740679200, 2182577207.48, 2342566675.73, 236010005.73, 2319.485],
                        [1740700800, 2161491188.86, 2334698384.14, 236399893.65, 2305.0334],
                        [1740722400, 2054793409.24, 2188836088.3, 220388113.9, 2123.0913],
                        [1740744000, 2020149122.9, 2190705039.69, 222212640.92, 2126.6357],
                        [1740765600, 2106001750.98, 2275433267.29, 232862332.37, 2210.4333],
                        [1740787200, 2107438763.73, 2294105156.79, 233872113.31, 2234.7104],
                        [1740808800, 2112623101.84, 2307516281.47, 233614710.01, 2253.2021],
                        [1740830400, 2026898173.96, 2253713169.97, 227143777.32, 2182.7004],
                        [1740852000, 2030565495.38, 2261978031.21, 228511511.07, 2196.198],
                        [1740873600, 2044787624.83, 2282911804.52, 230752174.04, 2214.4846],
                        [1740895200, 2071948266.88, 2292174671.61, 233115104.96, 2229.6592],
                        [1740916800, 2087884864.17, 2297580294.55, 234821519.11, 2235.9514],
                        [1740938400, 2265701222.8, 2485721577.41, 255785517.52, 2481.2893],
                        [1740960000, 2260202026.04, 2516581376.59, 258098417.38, 2517.3381],
                        [1740981600, 2213073092.78, 2488092444.78, 251107373.17, 2450.0854],
                        [1741003200, 2123411559.61, 2416870223.27, 243274031.27, 2355.636],
                        [1741024800, 2079524008.28, 2348702319.68, 239928112.49, 2280.2205],
                        [1741046400, 1942504238.95, 2220655176.25, 228495702.11, 2144.9468],
                        [1741068000, 1906417243.25, 2178285578.29, 221910060.19, 2105.8694],
                        [1741089600, 1859000954.24, 2166074107.59, 224534851.34, 2099.9663],
                        [1741111200, 1854792487.09, 2171892613.83, 228069276.36, 2120.4314],
                        [1741118400, 1894340079.49, 2209608789.96, 233216028.06, 2166.9497],
                    ],
                },
            },
        },
        L2BeatProject(id="mantle", slug="mantle"): {
            "success": True,
            "data": {
                "usdValue": 1388992234.34,
                "ethValue": 640989.6059608583,
                "chart": {
                    "types": ["timestamp", "native", "canonical", "external", "ethPrice"],
                    "data": [
                        [1738454400, 50047101.8, 1225325332.53, 589035622.37, 3118.4321],
                        [1738476000, 51073762.05, 1221521406.85, 588114600.59, 3119.7048],
                        [1738497600, 50266338.59, 1205404953.48, 579866811.07, 3065.666],
                        [1738519200, 46442120.38, 1174123174.69, 563597105.09, 2970.0256],
                        [1738540800, 42479632.08, 1154159981.87, 548435996.88, 2866.2536999999998],
                        [1738562400, 35564963.29, 1072026214.06, 494834578.92, 2492.9434],
                        [1738584000, 39410992.63, 1126677365.66, 505901005.82, 2585.8862],
                        [1738605600, 42669322.21, 1195190233.43, 526252001.52, 2713.4197],
                        [1738627200, 44873362.04, 1215696544.79, 550957071.25, 2880.2817],
                        [1738648800, 40550089.05, 1156887007.86, 497743164.16, 2709.165],
                        [1738670400, 41308083.9, 1171128463.41, 504705651.01, 2764.453],
                        [1738692000, 42174344.67, 1182627376.28, 512038332.5, 2817.343],
                        [1738713600, 41995982.16, 1167512567.43, 499886962.05, 2734.7632],
                        [1738735200, 42293670.96, 1173221569.86, 501715129.47, 2766.9778],
                        [1738756800, 41984303.14, 1180200549.81, 504646163.15, 2803.2717],
                        [1738778400, 40717002.03, 1169111419.67, 492884177.03, 2748.9966],
                        [1738800000, 40608098.11, 1179348250.87, 497687628.69, 2789.6216],
                        [1738821600, 40702261.06, 1189093428.69, 503354198.68, 2828.8013],
                        [1738843200, 39885999.69, 1178413557.37, 524568161.03, 2807.2258],
                        [1738864800, 37939987.51, 1151935664.17, 509270612.14, 2699.1633],
                        [1738886400, 37798246.78, 1149601725.45, 506952874.22, 2687.8135],
                        [1738908000, 38111072.44, 1149991890.4, 511245618.61, 2713.2769],
                        [1738929600, 38857852.12, 1161309991.35, 518677954.77, 2762.386],
                        [1738951200, 38450452.69, 1141909639.69, 507644009.86, 2679.5737],
                        [1738972800, 37272830.26, 1128998104.72, 499400078.74, 2623.4507],
                        [1738994400, 37459206.49, 1127441184.61, 496903767.86, 2620.003],
                        [1739016000, 37621084.32, 1124348486.6, 495414375.47, 2609.2285],
                        [1739037600, 40090873.11, 1123255057.98, 498252899.44, 2629.5073],
                        [1739059200, 40503143.11, 1124067969.24, 498878082.36, 2632.8062],
                        [1739080800, 40702489.26, 1125977064.75, 502948622.36, 2661.5818],
                        [1739102400, 41076637.4, 1126824532.3, 501682109.99, 2656.8438],
                        [1739124000, 39833910.75, 1118590905.58, 498603099.66, 2640.5596],
                        [1739145600, 40504324.65, 1121098940.89, 497268497.93, 2630.4372999999996],
                        [1739167200, 40813833.3, 1123163414.38, 499081086.52, 2638.8823],
                        [1739188800, 40581803.26, 1125116035.53, 501109098.37, 2655.4084],
                        [1739210400, 41267414, 1129023499.29, 506625147.26, 2679.592],
                        [1739232000, 41803734.59, 1126550056.19, 504841381.88, 2661.987],
                        [1739253600, 43922765.14, 1147115990.75, 516372915.88, 2714.1672],
                        [1739275200, 43527844.22, 1146135765.44, 513606490.35, 2707.8936],
                        [1739296800, 42305555.45, 1124820219.26, 503368476.55, 2637.9993],
                        [1739318400, 42006640.27, 1117616303.87, 498032213.6, 2602.923],
                        [1739340000, 42055512.7, 1119573257.39, 499371545.22, 2608.2039],
                        [1739361600, 41638751.64, 1121567453.28, 505211757.43, 2626.992],
                        [1739383200, 43307630.66, 1136254564.11, 511647184.51, 2672.5457],
                        [1739404800, 43278690.64, 1149538363.45, 521677470.62, 2737.199],
                        [1739426400, 43077525.58, 1145466862.17, 516816465.49, 2721.6362],
                        [1739448000, 42063042.05, 1130821960.65, 506367529.76, 2657.1575],
                        [1739469600, 41633739.8, 1125726004.65, 501691116.37, 2633.2253],
                        [1739491200, 41729254.45, 1134696574.97, 506373061.49, 2676.7212],
                        [1739512800, 41531133.76, 1138870636.68, 509552047.77, 2695.3032000000003],
                        [1739534400, 42349210.1, 1134102145.79, 507547714.08, 2685.2341],
                        [1739556000, 44682542.74, 1152583383.69, 520163414.7, 2776.0864],
                        [1739577600, 43833220.8, 1145981926.54, 513041832.59, 2725.8914],
                        [1739599200, 43815235.94, 1146598064.91, 512888926.52, 2721.512],
                        [1739620800, 42198667.46, 1144201635.46, 505121098.54, 2707.8481],
                        [1739642400, 40986981.21, 1138005455.23, 501654200.84, 2684.9438],
                        [1739664000, 41356839.32, 1138929707.34, 502762981.39, 2693.5044],
                        [1739685600, 41463048.68, 1140940579.98, 506488554.09, 2710.086],
                        [1739707200, 42792427.68, 1142172518.53, 506642700.11, 2712.0425],
                        [1739728800, 41344619.71, 1132983260.51, 502260913.97, 2690.2163],
                        [1739750400, 40973333.98, 1127916414.74, 498268201.97, 2661.1506],
                        [1739772000, 41446825, 1127287654.05, 499238673.24, 2668.0051000000003],
                        [1739793600, 42203086.02, 1146065852.98, 512643806.94, 2754.67],
                        [1739815200, 41372242.59, 1145640827.92, 509508215.41, 2735.929],
                        [1739836800, 41709197.06, 1156864484.03, 510509523.74, 2743.3503],
                        [1739858400, 40383215.58, 1142441976.72, 501430514.68, 2677.798],
                        [1739880000, 39598297.77, 1155819040.17, 500626594.94, 2681.1284],
                        [1739901600, 37779503.73, 1145154941.47, 492026431.44, 2614.5854],
                        [1739923200, 38618034.22, 1137598113.59, 498811636.99, 2671.6887],
                        [1739944800, 38447171.96, 1134888584.38, 501473486.96, 2685.5208],
                        [1739966400, 41066207.28, 1147540954.42, 506857641.7, 2727.3718],
                        [1739988000, 41354482.46, 1140794016.87, 503394096.61, 2711.4072],
                        [1740009600, 41120771.65, 1140263417.32, 504830173.23, 2716.0693],
                        [1740031200, 41815355.48, 1145120660.55, 506904844.11, 2730.3580000000006],
                        [1740052800, 42302589.88, 1146324826.42, 506767767.89, 2741.6080000000006],
                        [1740074400, 41820351.2, 1146796480.72, 505908233.46, 2735.8459999999995],
                        [1740096000, 43042920.19, 1148102452.38, 506160618.77, 2739.7255999999998],
                        [1740117600, 43350696.1, 1150938499.14, 507473936.36, 2755.1274],
                        [1740139200, 45972119.78, 1165023956.31, 510832704.36, 2791.834],
                        [1740160800, 41406889.22, 1103145189.71, 484477286.71, 2677.5234],
                        [1740182400, 41469344.79, 1114857523.99, 462940981.42, 2658.3472],
                        [1740204000, 42662457.12, 1134136117.56, 463075906.05, 2690.5872],
                        [1740225600, 43790821.89, 1143299037.86, 467189003.85, 2734.749],
                        [1740247200, 43899447.75, 1150748988.54, 487971402.83, 2789.4692],
                        [1740268800, 44392171.09, 1139746763.25, 484903831.81, 2762.9668],
                        [1740290400, 43336433.17, 1146826364.57, 485046465.93, 2781.5559999999996],
                        [1740312000, 42923486.74, 1151402658.35, 486358403.03, 2797.2339999999995],
                        [1740333600, 42845653.65, 1152785462.58, 488995587.94, 2818.87],
                        [1740355200, 43092169.68, 1153959783.01, 489320122.38, 2825.034],
                        [1740376800, 44135990.99, 1133830095.36, 481907333.52, 2730.762],
                        [1740398400, 44508415.01, 1121115228.73, 476631964.17, 2688.2075],
                        [1740420000, 39065925.18, 1115505666.23, 470759567.62, 2663.492],
                        [1740441600, 34386724.73, 1078379139.87, 449076708.11, 2514.864],
                        [1740463200, 34566329.05, 1076972025.88, 447088592.44, 2501.29],
                        [1740484800, 36402965.85, 1060661308.82, 436576726.06, 2433.876],
                        [1740506400, 36453909.66, 1063340259.6, 433068364.65, 2426.3574],
                        [1740528000, 36632009.86, 1075298748.21, 442473921.67, 2491.0957],
                        [1740549600, 36611247.63, 1071638718.79, 437480496.84, 2474.935],
                        [1740571200, 35630333.82, 1068761421.07, 437054679.11, 2463.9045],
                        [1740592800, 35005751.59, 1040911252.12, 422297353.11, 2363.211],
                        [1740614400, 35086396.86, 1037192582.48, 421054778.48, 2333.4392],
                        [1740636000, 35890230.93, 1039579860.84, 395671742.99, 2339.9895],
                        [1740657600, 36348931.59, 1023639634.91, 405775650.34, 2352.1033],
                        [1740679200, 35383550.24, 1018960796.61, 400790241.64, 2319.485],
                        [1740700800, 35974388.75, 1016145385.1, 398777684.94, 2305.0334],
                        [1740722400, 34685745.83, 972691103.91, 380305049.09, 2123.0913],
                        [1740744000, 37076850.73, 970180572.75, 353457931.79, 2126.6357],
                        [1740765600, 37427566.24, 990587994.15, 363306283.43, 2210.4333],
                        [1740787200, 36874344.72, 991006380.28, 364957501.87, 2234.7104],
                        [1740808800, 36921016.06, 1000415622.25, 368997365.81, 2253.2021],
                        [1740830400, 35898873.64, 992964742.11, 361115750.78, 2182.7004],
                        [1740852000, 36174332.03, 995286783.76, 363641367.29, 2196.198],
                        [1740873600, 36414978.47, 997641124.67, 365380453.94, 2214.4846],
                        [1740895200, 36317698.87, 997906137.91, 365493684.71, 2229.6592],
                        [1740916800, 37449366.79, 998096427.45, 367122501.46, 2235.9514],
                        [1740938400, 39488301.57, 1052274820.19, 393633522.51, 2481.2893],
                        [1740960000, 39953625.23, 1058548374.98, 399648116.92, 2517.3381],
                        [1740981600, 38986057.79, 1046228825.96, 391034878, 2450.0854],
                        [1741003200, 37480458.31, 1033478422.68, 381670614.09, 2355.636],
                        [1741024800, 37091313.3, 1013930218.73, 370340324.02, 2280.2205],
                        [1741046400, 34485201.94, 988250906.43, 357986022.19, 2144.9468],
                        [1741068000, 34929328.34, 978368094.62, 352111956.43, 2105.8694],
                        [1741089600, 36792358.37, 976140447.51, 352049245.68, 2099.9663],
                        [1741111200, 36565433.53, 981432130.57, 354256128.49, 2120.4314],
                        [1741118400, 36729199.35, 991322882.37, 360940152.62, 2166.9497],
                    ],
                },
            },
        },
        L2BeatProject(id="base", slug="base"): {
            "success": True,
            "data": {
                "usdValue": 11324265055.22,
                "ethValue": 5225901.208145256,
                "chart": {
                    "types": ["timestamp", "native", "canonical", "external", "ethPrice"],
                    "data": [
                        [1738454400, 7315512599.69, 5256742791.81, 753759850.91, 3118.4321],
                        [1738476000, 7321384043.94, 5260412397.18, 754312305.04, 3119.7048],
                        [1738497600, 7214530510.47, 5175339466.35, 746196238.69, 3065.666],
                        [1738519200, 6899038700.75, 4972807958.33, 729125945.39, 2970.0256],
                        [
                            1738540800,
                            6910658027.75,
                            4831771970.39,
                            705678159.41,
                            2866.2536999999998,
                        ],
                        [1738562400, 6545247770.43, 4236704672.69, 642972241.95, 2492.9434],
                        [1738584000, 6760627656.08, 4427484821.44, 664147877.31, 2585.8862],
                        [1738605600, 7223074508.68, 4681341496.11, 685560930.23, 2713.4197],
                        [1738627200, 7455815851.34, 4961248110.35, 718075757.72, 2880.2817],
                        [1738648800, 7099152674.49, 4640866912.06, 685948037.52, 2709.165],
                        [1738670400, 7195276728.76, 4748415044.14, 700495846.53, 2764.453],
                        [1738692000, 7299725025.34, 4872702239.04, 708245079.05, 2817.343],
                        [1738713600, 7156669052.4, 4698578232.36, 695796838.75, 2734.7632],
                        [1738735200, 7160140920.67, 4731998061.7, 700807883.19, 2766.9778],
                        [1738756800, 7225551031.47, 4815731512.57, 703411232.82, 2803.2717],
                        [1738778400, 7096571932.26, 4681639282.65, 691305544.49, 2748.9966],
                        [1738800000, 7029367453.17, 4702870257.42, 689899451.54, 2789.6216],
                        [1738821600, 7084128185.09, 4770088772.16, 697339993.61, 2828.8013],
                        [1738843200, 7049292798.16, 4727047092.86, 692230176.14, 2807.2258],
                        [1738864800, 6812497029.07, 4522989016.16, 672263539.53, 2699.1633],
                        [1738886400, 6767113960.94, 4503262830.46, 669621690.86, 2687.8135],
                        [1738908000, 6819324560.18, 4560226224.29, 671907445.86, 2713.2769],
                        [1738929600, 6861770575.37, 4646400591.93, 680278932.43, 2762.386],
                        [1738951200, 6849158851.8, 4531189305.28, 663298065.84, 2679.5737],
                        [1738972800, 6745400549.36, 4432665898.45, 653009787.15, 2623.4507],
                        [1738994400, 6712755823.92, 4443295059.93, 653453283.99, 2620.003],
                        [1739016000, 6734911385.08, 4442184335.36, 652091307.01, 2609.2285],
                        [1739037600, 6795177387.84, 4520745305.4, 657451478.36, 2629.5073],
                        [1739059200, 6841610509.45, 4517145676.63, 657599249.81, 2632.8062],
                        [1739080800, 6896891432.19, 4553437221.33, 661219151.44, 2661.5818],
                        [1739102400, 6837749756.27, 4519478238, 659360442.86, 2656.8438],
                        [1739124000, 6730400256.54, 4471613577, 657051913.05, 2640.5596],
                        [1739145600, 6825531882.2, 4475424375.98, 655520263.36, 2630.4372999999996],
                        [1739167200, 6866614971.19, 4499888075.12, 656877460.2, 2638.8823],
                        [1739188800, 6950778602.73, 4551880408.79, 652642573.6, 2655.4084],
                        [1739210400, 7033874189.6, 4603708589.97, 658070818.95, 2679.592],
                        [1739232000, 6929042402.28, 4563484033.8, 654104081.99, 2661.987],
                        [1739253600, 7091854246.26, 4720109419.59, 665363660.08, 2714.1672],
                        [1739275200, 7039425684.15, 4710378366.2, 665848828.52, 2707.8936],
                        [1739296800, 6911563048.59, 4627283256.43, 652795182.83, 2637.9993],
                        [1739318400, 6971324341.13, 4554608757.31, 647839026.14, 2602.923],
                        [1739340000, 6972742533.59, 4557269707.89, 651654682.42, 2608.2039],
                        [1739361600, 6981328924.75, 4605051691.39, 654892787.46, 2626.992],
                        [1739383200, 7003499226.96, 4682910700.33, 664261048.6, 2672.5457],
                        [1739404800, 7114411104.9, 4811916338.04, 674231583.21, 2737.199],
                        [1739426400, 7064262468.82, 4775772615.55, 670064438.9, 2721.6362],
                        [1739448000, 7006253004.22, 4656239466.34, 658286131.54, 2657.1575],
                        [1739469600, 7043359002.44, 4617511033.09, 654027033.13, 2633.2253],
                        [1739491200, 7033091137.75, 4682681279.78, 661376919.47, 2676.7212],
                        [
                            1739512800,
                            7051042356.16,
                            4715926464.61,
                            664053652.87,
                            2695.3032000000003,
                        ],
                        [1739534400, 7089802210.83, 4769265475.32, 661777237.54, 2685.2341],
                        [1739556000, 7233531494.54, 4940863177.68, 674763185.66, 2776.0864],
                        [1739577600, 7143195909.76, 4832692805.18, 662349017.17, 2725.8914],
                        [1739599200, 7125069954.42, 4805033258.83, 658864108.06, 2721.512],
                        [1739620800, 7060772780.83, 4762218752.11, 656806798.56, 2707.8481],
                        [1739642400, 6970758893.29, 4717587848.98, 652563504.31, 2684.9438],
                        [1739664000, 6997913223.15, 4736467469.33, 654935714.01, 2693.5044],
                        [1739685600, 7008918136.77, 4771260347.38, 656005305.2, 2710.086],
                        [1739707200, 7011891742.21, 4772853921.22, 656347324.85, 2712.0425],
                        [1739728800, 6965509867.7, 4711296304.24, 650180831.5, 2690.2163],
                        [1739750400, 6985518257.32, 4679928116.11, 645860135.81, 2661.1506],
                        [1739772000, 6949704729.86, 4673467627.07, 645360449.3, 2668.0051000000003],
                        [1739793600, 7018813574.46, 4806080698.56, 659578750.12, 2754.67],
                        [1739815200, 6937427850.11, 4750263374.82, 654809585.4, 2735.929],
                        [1739836800, 6940188033.55, 4770582479.06, 656573423.51, 2743.3503],
                        [1739858400, 6855929045.53, 4656980858.39, 645945498.02, 2677.798],
                        [1739880000, 6815505848.55, 4661319824.29, 646277054.09, 2681.1284],
                        [1739901600, 6634893897.2, 4510530856.59, 633906216.66, 2614.5854],
                        [1739923200, 6712814576.44, 4607614904.12, 644438797.21, 2671.6887],
                        [1739944800, 6665209113.48, 4621810953.53, 647100050.59, 2685.5208],
                        [1739966400, 6730292305.61, 4715284932.68, 654643072.26, 2727.3718],
                        [1739988000, 6719625377.88, 4679901046.12, 649999677.92, 2711.4072],
                        [1740009600, 6731347811.71, 4692076046, 650916182.67, 2716.0693],
                        [1740031200, 6863857258.36, 4731679361.58, 655139288.6, 2730.3580000000006],
                        [1740052800, 7015327571.2, 4777406898.29, 659831732.39, 2741.6080000000006],
                        [
                            1740074400,
                            7221135584.72,
                            4781089611.41,
                            655861445.18,
                            2735.8459999999995,
                        ],
                        [
                            1740096000,
                            7415757730.21,
                            4853542768.81,
                            657694455.75,
                            2739.7255999999998,
                        ],
                        [1740117600, 7338009667.26, 4870938747.53, 660203653.19, 2755.1274],
                        [1740139200, 7522568660, 5021555464.86, 667280854.39, 2791.834],
                        [1740160800, 7465610132.78, 4820971103.3, 643918185.66, 2677.5234],
                        [1740182400, 7380324803.31, 4753064234.31, 639702308.12, 2658.3472],
                        [1740204000, 7494940941.37, 4830249570.05, 645777289.95, 2690.5872],
                        [1740225600, 7549597878.15, 4936061775.15, 653936917.45, 2734.749],
                        [1740247200, 7617826836.73, 5027675666.01, 662994199.73, 2789.4692],
                        [1740268800, 7550407860.65, 4982756310.95, 661980431.62, 2762.9668],
                        [
                            1740290400,
                            7515157062.56,
                            4996023348.47,
                            664169147.83,
                            2781.5559999999996,
                        ],
                        [
                            1740312000,
                            7505870867.75,
                            5013083622.18,
                            667215294.93,
                            2797.2339999999995,
                        ],
                        [1740333600, 7433952780.73, 5028887370.77, 669336067.64, 2818.87],
                        [1740355200, 7475812807.77, 5052792608.8, 672009507.55, 2825.034],
                        [1740376800, 7424245845.23, 4922987415.22, 655728139.52, 2730.762],
                        [1740398400, 7369842053.87, 4835816009.19, 647645368.99, 2688.2075],
                        [1740420000, 7293105962.42, 4777741365.6, 743011936.5, 2663.492],
                        [1740441600, 7058988694.75, 4505360189.4, 718289552.27, 2514.864],
                        [1740463200, 7023633891.87, 4505101120.06, 716981946.33, 2501.29],
                        [1740484800, 6948925530.98, 4408391027.96, 704334839.24, 2433.876],
                        [1740506400, 6938286656.02, 4420714475.94, 705676671.96, 2426.3574],
                        [1740528000, 7035854256.9, 4535636504.41, 717562669.01, 2491.0957],
                        [1740549600, 7040311486.88, 4518035528.47, 714153881.13, 2474.935],
                        [1740571200, 7026886531.52, 4507469342.81, 711942915.51, 2463.9045],
                        [1740592800, 7019355754.22, 4392111750.44, 696211087.52, 2363.211],
                        [1740614400, 7034092694.95, 4357281972.79, 691383637.69, 2333.4392],
                        [1740636000, 7080456662.7, 4395936742.81, 691836848.4, 2339.9895],
                        [1740657600, 7190796038.78, 4399558061.51, 693448688.32, 2352.1033],
                        [1740679200, 6961918224.62, 4337422417.02, 687212403.44, 2319.485],
                        [1740700800, 6908531071.06, 4309124089.94, 682922496.63, 2305.0334],
                        [1740722400, 6663220713.34, 3985738691.6, 653281478.33, 2123.0913],
                        [1740744000, 6723140699.19, 4014755381.9, 660112924.94, 2126.6357],
                        [1740765600, 6840423458.02, 4180629272.4, 676459467.21, 2210.4333],
                        [1740787200, 6869818610.61, 4249156692.87, 676712981.02, 2234.7104],
                        [1740808800, 6931443185.77, 4277345198.65, 681409810.13, 2253.2021],
                        [1740830400, 6867552765.9, 4145157273.67, 668549056.57, 2182.7004],
                        [1740852000, 6851004791.07, 4167225285.56, 672163210.4, 2196.198],
                        [1740873600, 6900646503.84, 4205883200.8, 674626743.83, 2214.4846],
                        [1740895200, 6952710878.88, 4235415902.38, 676301191.17, 2229.6592],
                        [1740916800, 6957569903.88, 4256595704.36, 678341071.59, 2235.9514],
                        [1740938400, 7211626149.04, 4701543727.65, 718644947.67, 2481.2893],
                        [1740960000, 7246080400.86, 4789822933.77, 726554103.21, 2517.3381],
                        [1740981600, 7170472625.83, 4659983212.94, 713259517.76, 2450.0854],
                        [1741003200, 7069145852.02, 4486007836.76, 696146016.81, 2355.636],
                        [1741024800, 6926477825.65, 4334761332.01, 683974354.47, 2280.2205],
                        [1741046400, 6657530503.69, 4072400275.14, 663469854.74, 2144.9468],
                        [1741068000, 6513024690.79, 3977251436.67, 655601064.7, 2105.8694],
                        [1741089600, 6459350715.03, 3956994772.52, 652199475.44, 2099.9663],
                        [1741111200, 6506423590.87, 3991459954.51, 654418641.94, 2120.4314],
                        [1741118400, 6583188220.88, 4079218952.18, 661857882.16, 2166.9497],
                    ],
                },
            },
        },
    }

    df = apply_schema(raw_data, TVL_SCHEMA)

    assert len(df) == 155
    actual = (
        df.filter(pl.col("dt") > "2025-02-20")
        .filter(pl.col("slug").is_in(["base", "hyperliquid"]))
        .sort(by=["slug", "dt"])
        .to_dicts()
    )

    assert actual == [
        {
            "dt": "2025-02-21",
            "timestamp": 1740160800,
            "native": 7465610132.78,
            "canonical": 4820971103.3,
            "external": 643918185.66,
            "ethPrice": 2677.5234,
            "id": "base",
            "slug": "base",
        },
        {
            "dt": "2025-02-22",
            "timestamp": 1740247200,
            "native": 7617826836.73,
            "canonical": 5027675666.01,
            "external": 662994199.73,
            "ethPrice": 2789.4692,
            "id": "base",
            "slug": "base",
        },
        {
            "dt": "2025-02-23",
            "timestamp": 1740333600,
            "native": 7433952780.73,
            "canonical": 5028887370.77,
            "external": 669336067.64,
            "ethPrice": 2818.87,
            "id": "base",
            "slug": "base",
        },
        {
            "dt": "2025-02-24",
            "timestamp": 1740420000,
            "native": 7293105962.42,
            "canonical": 4777741365.6,
            "external": 743011936.5,
            "ethPrice": 2663.492,
            "id": "base",
            "slug": "base",
        },
        {
            "dt": "2025-02-25",
            "timestamp": 1740506400,
            "native": 6938286656.02,
            "canonical": 4420714475.94,
            "external": 705676671.96,
            "ethPrice": 2426.3574,
            "id": "base",
            "slug": "base",
        },
        {
            "dt": "2025-02-26",
            "timestamp": 1740592800,
            "native": 7019355754.22,
            "canonical": 4392111750.44,
            "external": 696211087.52,
            "ethPrice": 2363.211,
            "id": "base",
            "slug": "base",
        },
        {
            "dt": "2025-02-27",
            "timestamp": 1740679200,
            "native": 6961918224.62,
            "canonical": 4337422417.02,
            "external": 687212403.44,
            "ethPrice": 2319.485,
            "id": "base",
            "slug": "base",
        },
        {
            "dt": "2025-02-28",
            "timestamp": 1740765600,
            "native": 6840423458.02,
            "canonical": 4180629272.4,
            "external": 676459467.21,
            "ethPrice": 2210.4333,
            "id": "base",
            "slug": "base",
        },
        {
            "dt": "2025-03-01",
            "timestamp": 1740852000,
            "native": 6851004791.07,
            "canonical": 4167225285.56,
            "external": 672163210.4,
            "ethPrice": 2196.198,
            "id": "base",
            "slug": "base",
        },
        {
            "dt": "2025-03-02",
            "timestamp": 1740938400,
            "native": 7211626149.04,
            "canonical": 4701543727.65,
            "external": 718644947.67,
            "ethPrice": 2481.2893,
            "id": "base",
            "slug": "base",
        },
        {
            "dt": "2025-03-03",
            "timestamp": 1741024800,
            "native": 6926477825.65,
            "canonical": 4334761332.01,
            "external": 683974354.47,
            "ethPrice": 2280.2205,
            "id": "base",
            "slug": "base",
        },
        {
            "dt": "2025-03-04",
            "timestamp": 1741118400,
            "native": 6583188220.88,
            "canonical": 4079218952.18,
            "external": 661857882.16,
            "ethPrice": 2166.9497,
            "id": "base",
            "slug": "base",
        },
        {
            "dt": "2025-02-21",
            "timestamp": 1740160800,
            "native": 0.0,
            "canonical": 2552148744.17,
            "external": 0.0,
            "ethPrice": 2677.5234,
            "id": "hyperliquid",
            "slug": "hyperliquid",
        },
        {
            "dt": "2025-02-22",
            "timestamp": 1740247200,
            "native": 0.0,
            "canonical": 2539391433.4,
            "external": 0.0,
            "ethPrice": 2789.4692,
            "id": "hyperliquid",
            "slug": "hyperliquid",
        },
        {
            "dt": "2025-02-23",
            "timestamp": 1740333600,
            "native": 0.0,
            "canonical": 2523312768.04,
            "external": 0.0,
            "ethPrice": 2818.87,
            "id": "hyperliquid",
            "slug": "hyperliquid",
        },
        {
            "dt": "2025-02-24",
            "timestamp": 1740420000,
            "native": 0.0,
            "canonical": 2518622598.39,
            "external": 0.0,
            "ethPrice": 2663.492,
            "id": "hyperliquid",
            "slug": "hyperliquid",
        },
        {
            "dt": "2025-02-25",
            "timestamp": 1740506400,
            "native": 0.0,
            "canonical": 2515221967.75,
            "external": 0.0,
            "ethPrice": 2426.3574,
            "id": "hyperliquid",
            "slug": "hyperliquid",
        },
        {
            "dt": "2025-02-26",
            "timestamp": 1740592800,
            "native": 0.0,
            "canonical": 2509920633.09,
            "external": 0.0,
            "ethPrice": 2363.211,
            "id": "hyperliquid",
            "slug": "hyperliquid",
        },
        {
            "dt": "2025-02-27",
            "timestamp": 1740679200,
            "native": 0.0,
            "canonical": 2505567817.05,
            "external": 0.0,
            "ethPrice": 2319.485,
            "id": "hyperliquid",
            "slug": "hyperliquid",
        },
        {
            "dt": "2025-02-28",
            "timestamp": 1740765600,
            "native": 0.0,
            "canonical": 2505526083.99,
            "external": 0.0,
            "ethPrice": 2210.4333,
            "id": "hyperliquid",
            "slug": "hyperliquid",
        },
        {
            "dt": "2025-03-01",
            "timestamp": 1740852000,
            "native": 0.0,
            "canonical": 2506799471.57,
            "external": 0.0,
            "ethPrice": 2196.198,
            "id": "hyperliquid",
            "slug": "hyperliquid",
        },
        {
            "dt": "2025-03-02",
            "timestamp": 1740938400,
            "native": 0.0,
            "canonical": 2570524093.76,
            "external": 0.0,
            "ethPrice": 2481.2893,
            "id": "hyperliquid",
            "slug": "hyperliquid",
        },
        {
            "dt": "2025-03-03",
            "timestamp": 1741024800,
            "native": 0.0,
            "canonical": 2550750115.78,
            "external": 0.0,
            "ethPrice": 2280.2205,
            "id": "hyperliquid",
            "slug": "hyperliquid",
        },
        {
            "dt": "2025-03-04",
            "timestamp": 1741118400,
            "native": 0.0,
            "canonical": 2517051639.44,
            "external": 0.0,
            "ethPrice": 2166.9497,
            "id": "hyperliquid",
            "slug": "hyperliquid",
        },
    ]
