
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Design Principles &#8212; OP Analytics  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=613916f0" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'dataplatform/2-blockbatch/1-design';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Marker Metadata Layer" href="2-markers.html" />
    <link rel="prev" title="Onchain Data Processing" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="https://github.com/ethereum-optimism/brand-kit/blob/71ea3bb1ea24e87968804b388e99bed0b52e2a4b/assets/images/optimism-wordmark-large/OPTIMISM.png?raw=true" class="logo__image only-light" alt="OP Analytics  documentation - Home"/>
    <img src="https://github.com/ethereum-optimism/brand-kit/blob/71ea3bb1ea24e87968804b388e99bed0b52e2a4b/assets/images/optimism-wordmark-large/OPTIMISM.png?raw=true" class="logo__image only-dark pst-js-only" alt="OP Analytics  documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    OP Labs Data Platform
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../devsetup/index.html">
    Development Guide
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    OP Labs Data Platform
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../devsetup/index.html">
    Development Guide
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../1-architecture.html">Architecture</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Onchain Data Processing</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Design Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="2-markers.html">Marker Metadata Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="3-ingestion.html">Ingestion</a></li>
<li class="toctree-l2"><a class="reference internal" href="4-models.html">Blockbatch Models</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../5-datasources/index.html">Third-Party Data Ingestion</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../5-datasources/1-overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5-datasources/2-dailydata-gcs.html">DailyDataset (GCS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../5-datasources/3-clickhouse-data.html">ClickHouseDataset</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3-clickhouse/index.html">Data Warehouse</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../3-clickhouse/1-blockbatch-loading.html">Onchain Data Pipelines: Blockbatch Load</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3-clickhouse/2-transforms.html">General Purpose Data Pipelines: Transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3-clickhouse/3-comparison.html">Comparison to dbt and SQLMesh</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../4-public-datasets/index.html">OP Labs Public BigQuery Data</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">OP Labs Data Platform</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Onchain Data Processing</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Design Principles</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="design-principles">
<h1>Design Principles<a class="headerlink" href="#design-principles" title="Link to this heading">#</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">blockbatch</span></code> data processing pattern is designed around the idea of deterministic parallelism.
For a given blockchain we should be able to unambiguously determine in advance how it will be broken
up  into batches for processing.</p>
<p>This has two benefits.  First, it allows us to construct processing tasks that can be run in parallel
without having to look at the data. Second, the storage location of any processed results is also
deterministic. So if we need to reprocess a batch, we will be sure that there won’t be no duplicates
at the storage layer.</p>
<p>Blockchains can vary widely in transaction activity, and also a given blockchain can
explode in popularity increasing the amount of data that needs to be processed per block.
So for <code class="docutils literal notranslate"><span class="pre">blockbatch</span></code> processing we need a way to
configure the batch size based on the chain’s characteristics. This method should allow adjusting
the batch size so that as a chain grows we can keep the amount of data per batch roughly constant.
In <code class="docutils literal notranslate"><span class="pre">blockbatch</span></code> processing a single batch is processed by a single worker. So we should aim for
batch sizes that fit well into a single worker’s memory.</p>
<p>The main trade-off of this approach is that it requires the pipeline owner to be aware of batch
sizes so they can be configured in advance, budgeting for any increase in data volume. Usually this
is not much work, but there can be scenarios where a chain explodes in popularity and the pipeline
might stall. If that happens one can always pause the pipeline and back-date an adjustment to
the batch size.</p>
<section id="batch-size-configuration">
<h2>Batch Size Configuration<a class="headerlink" href="#batch-size-configuration" title="Link to this heading">#</a></h2>
<p>In the snippet below we show how we have configured the batch sizes for <code class="docutils literal notranslate"><span class="pre">base</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">BATCH_SIZE_CONFIGURATION</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;base&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">Delimiter</span><span class="p">(</span><span class="n">block_number</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">),</span>
        <span class="n">Delimiter</span><span class="p">(</span><span class="n">block_number</span><span class="o">=</span><span class="mi">10000000</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">5000</span><span class="p">),</span>
        <span class="n">Delimiter</span><span class="p">(</span><span class="n">block_number</span><span class="o">=</span><span class="mi">15000000</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">2000</span><span class="p">),</span>

        <span class="c1"># Starting here base is ~2.5M traces / 1k blocks.</span>
        <span class="c1"># Traces file can be ~70MB.</span>
        <span class="n">Delimiter</span><span class="p">(</span><span class="n">block_number</span><span class="o">=</span><span class="mi">20900000</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">),</span>

        <span class="c1"># (2024/10/29) Decided to go to 400 blocks per batch to give us more room.</span>
        <span class="c1"># Traces file size is ~25MB.</span>
        <span class="n">Delimiter</span><span class="p">(</span><span class="n">block_number</span><span class="o">=</span><span class="mi">21200000</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">400</span><span class="p">),</span>

        <span class="c1"># (2025/03/17) Go to 200 blocks per batch to plan for the future.</span>
        <span class="c1"># Trace file size is at ~55MB.</span>
        <span class="n">Delimiter</span><span class="p">(</span><span class="n">block_number</span><span class="o">=</span><span class="mi">27730000</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">200</span><span class="p">),</span>
    <span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We see how the batch size is configured with a list of <code class="docutils literal notranslate"><span class="pre">Delimiter</span></code> objects. Each delimiter
tells us what the batch size should be starting at the boundary block number and going forward.
To adjust the batch size we add new delimiters to the list.</p>
<p>Delimiters are like feature flags that kick in at a point in time. When we add them we don’t want
to change any processing that is currently in flight, so we make sure that a new delimiter has a
block number that is sometime in the future, say a couple of days after the change is deployed.
That way nothing changes in the present and when the chain gets to the new delimiter block number
then the batch size will transition to its new value.</p>
</section>
<section id="data-artifacts-and-storage-location">
<h2>Data Artifacts and Storage Location<a class="headerlink" href="#data-artifacts-and-storage-location" title="Link to this heading">#</a></h2>
<p>Going back to our principle of determinism, in <code class="docutils literal notranslate"><span class="pre">blockbatch</span></code> processing the storage location of
produced data should be unambiguously determined from the block batch. The storage layer we use
is Google Cloud Storage (GCS) and we introduce the concept of a <code class="docutils literal notranslate"><span class="pre">root_path</span></code> to identify the
different data artifacts associated with a batch.</p>
<p>The most important data artifact is the raw data itself. EVM blockchains produce four key datasets,
and for each of these we have a different root path in our storage bucket:</p>
<ul class="simple">
<li><p>Blocks -&gt; <code class="docutils literal notranslate"><span class="pre">ingestion/blocks_v1</span></code></p></li>
<li><p>Transactions -&gt; <code class="docutils literal notranslate"><span class="pre">ingestion/transactions_v1</span></code></p></li>
<li><p>Logs -&gt; <code class="docutils literal notranslate"><span class="pre">ingestion/logs_v1</span></code></p></li>
<li><p>Traces -&gt; <code class="docutils literal notranslate"><span class="pre">ingestion/traces_v1</span></code></p></li>
</ul>
<p>For a given batch we can compute many other data artifacts. For example transaction fee details,
filtered contract creation traces, decoded 4337 activity, etc. The possibilities are endless. Each
data artifact gets its own <code class="docutils literal notranslate"><span class="pre">root_path</span></code> but shares a location for the batch based on the batch block
range.</p>
<p>For example, the raw traces for the OP Mainnet batch with blocks 600000 to 610000 are located at:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gs</span><span class="p">:</span><span class="o">//</span><span class="n">oplabs</span><span class="o">-</span><span class="n">tools</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">sink</span><span class="o">/</span><span class="n">ingestion</span><span class="o">/</span><span class="n">traces_v1</span><span class="o">/</span><span class="n">chain</span><span class="o">=</span><span class="n">op</span><span class="o">/</span><span class="n">dt</span><span class="o">=</span><span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span><span class="o">/</span><span class="mf">000000600000.</span><span class="n">parquet</span>
</pre></div>
</div>
<p>And the filtered contract creation traces for the same batch are located at:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gs</span><span class="p">:</span><span class="o">//</span><span class="n">oplabs</span><span class="o">-</span><span class="n">tools</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">sink</span><span class="o">/</span><span class="n">blockbatch</span><span class="o">/</span><span class="n">contract_creation</span><span class="o">/</span><span class="n">create_traces_v1</span><span class="o">/</span><span class="n">chain</span><span class="o">=</span><span class="n">op</span><span class="o">/</span><span class="n">dt</span><span class="o">=</span><span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span><span class="o">/</span><span class="mf">000000600000.</span><span class="n">parquet</span>
</pre></div>
</div>
</section>
<section id="date-partitioning">
<h2>Date Partitioning<a class="headerlink" href="#date-partitioning" title="Link to this heading">#</a></h2>
<p>The paths shown in the above example have a <code class="docutils literal notranslate"><span class="pre">dt</span></code> component that is the date in YYYY-MM-DD format.
This is an subtle but important detail, it in fact makes the path of the data not be completely
deterministic. For a given block we need to know then date on which it will be produced, which is
not known until the block is actually produced.</p>
<p>Date partitioning is introduced with the goal of making it easier to reason about the data as a time
series. This is very important for the kinds of analytics we do at OP Labs. Pretty much all of our
dashboards and reports have a date component on them.</p>
<p>The price we pay for having the date as a partition is we cannot do O(1) data access given the block
number. To access the data for a block we need to first find the block timestamp from which we
can find the date partition. Then with the batch size configuration we can find the full URI for
the block batch that contains the block.</p>
<p>This limitation turns out not to be a huge deal, because we can bootstrap knowledge of the date
partition at ingestion time and then carry it forward in all our metadata from that point on.</p>
</section>
<section id="partitioning-at-ingestion">
<h2>Partitioning at Ingestion<a class="headerlink" href="#partitioning-at-ingestion" title="Link to this heading">#</a></h2>
<p>When ingesting data we can read from the data source (in our case this is Goldsky but can also be
and RPC provider) targeting the blocks we need using the min/max block number. We proceed
to audit the batch and then right before writing we split the batch into date partitions using
the block timestamp for each block to determine which date does it go into.</p>
<p>Most of the time there is a single date per batch, but when a batch straddles a date boundary we
end up with two dates and therefore two parquet files written to the data lake, for example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gs</span><span class="p">:</span><span class="o">//</span><span class="n">oplabs</span><span class="o">-</span><span class="n">tools</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">sink</span><span class="o">/</span><span class="n">ingestion</span><span class="o">/</span><span class="n">traces_v1</span><span class="o">/</span><span class="n">chain</span><span class="o">=</span><span class="n">op</span><span class="o">/</span><span class="n">dt</span><span class="o">=</span><span class="mi">2021</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span><span class="o">/</span><span class="mf">000000630000.</span><span class="n">parquet</span>
<span class="n">gs</span><span class="p">:</span><span class="o">//</span><span class="n">oplabs</span><span class="o">-</span><span class="n">tools</span><span class="o">-</span><span class="n">data</span><span class="o">-</span><span class="n">sink</span><span class="o">/</span><span class="n">ingestion</span><span class="o">/</span><span class="n">traces_v1</span><span class="o">/</span><span class="n">chain</span><span class="o">=</span><span class="n">op</span><span class="o">/</span><span class="n">dt</span><span class="o">=</span><span class="mi">2021</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">01</span><span class="o">/</span><span class="mf">000000630000.</span><span class="n">parquet</span>
</pre></div>
</div>
<p>When processing data after ingestion we don’t usually address the single batch, but rather we
address all batches for a given date range. So we can use the list of files created at ingestion
to find out what data needs to be processed.</p>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Onchain Data Processing</p>
      </div>
    </a>
    <a class="right-next"
       href="2-markers.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Marker Metadata Layer</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#batch-size-configuration">Batch Size Configuration</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-artifacts-and-storage-location">Data Artifacts and Storage Location</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#date-partitioning">Date Partitioning</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#partitioning-at-ingestion">Partitioning at Ingestion</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/dataplatform/2-blockbatch/1-design.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, OP Labs.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>